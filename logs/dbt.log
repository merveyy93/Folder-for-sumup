[0m16:02:02.925003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6f1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c993510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c993910>]}


============================== 16:02:02.942132 | 4348f5c0-d354-4597-9754-e4e9814d73c1 ==============================
[0m16:02:02.942132 [info ] [MainThread]: Running with dbt=1.6.0
[0m16:02:02.944121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'debug': 'False', 'profiles_dir': '/Users/merveyasa/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s store_transaction_view', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:02:02.945687 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /Users/merveyasa/Desktop/Folder for sumup/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m16:02:02.947114 [debug] [MainThread]: Command `dbt run` failed at 16:02:02.946837 after 0.13 seconds
[0m16:02:02.947787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc38d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c70d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6e9b10>]}
[0m16:02:02.948486 [debug] [MainThread]: Flushing usage events
[0m16:32:42.628427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7a5290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7a4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7d8650>]}


============================== 16:32:42.642379 | 309ddf43-ed79-452a-8bcc-9b7cf1e6c120 ==============================
[0m16:32:42.642379 [info ] [MainThread]: Running with dbt=1.6.0
[0m16:32:42.643450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'fail_fast': 'False', 'profiles_dir': '/Users/merveyasa/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s store_transaction_view', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:32:42.644289 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /Users/merveyasa/Desktop/Folder for sumup/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m16:32:42.645292 [debug] [MainThread]: Command `dbt run` failed at 16:32:42.645066 after 0.10 seconds
[0m16:32:42.645844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6dd790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8781d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb29650>]}
[0m16:32:42.646441 [debug] [MainThread]: Flushing usage events
[0m16:39:10.049332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113d7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111476810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11171a6d0>]}


============================== 16:39:10.056788 | bf7c806d-877e-4709-abaf-e29b1864d17a ==============================
[0m16:39:10.056788 [info ] [MainThread]: Running with dbt=1.6.0
[0m16:39:10.057604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'version_check': 'True', 'profiles_dir': '/Users/merveyasa/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s store_transaction_view', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:39:10.061571 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'merve'
[0m16:39:10.062602 [debug] [MainThread]: Command `dbt run` failed at 16:39:10.062397 after 0.05 seconds
[0m16:39:10.063064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111643bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111997bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111487390>]}
[0m16:39:10.063609 [debug] [MainThread]: Flushing usage events
[0m16:39:15.368579 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m16:47:02.798362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b90fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b385c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b356b90>]}


============================== 16:47:02.808162 | 54a5bce5-28ea-4c23-866f-a0159d8fc39f ==============================
[0m16:47:02.808162 [info ] [MainThread]: Running with dbt=1.6.0
[0m16:47:02.809411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s store_transaction_view', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:47:03.071070 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['config-version']: '1.6.0' is not valid under any of the given schemas

Error encountered in /Users/merveyasa/Desktop/Folder for sumup/dbt_project.yml
[0m16:47:03.072897 [debug] [MainThread]: Command `dbt run` failed at 16:47:03.072149 after 0.35 seconds
[0m16:47:03.073993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b625590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adcb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c4bb50>]}
[0m16:47:03.074907 [debug] [MainThread]: Flushing usage events
[0m16:48:11.280228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6e4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9a4810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fca7810>]}


============================== 16:48:11.288889 | 7ed91c8a-7d89-43ce-a436-34c6f2023c43 ==============================
[0m16:48:11.288889 [info ] [MainThread]: Running with dbt=1.6.0
[0m16:48:11.289906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s store_transaction_view', 'send_anonymous_usage_stats': 'True'}
[0m16:48:11.457063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ed91c8a-7d89-43ce-a436-34c6f2023c43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc9c950>]}
[0m16:48:11.468493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ed91c8a-7d89-43ce-a436-34c6f2023c43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6e4b90>]}
[0m16:48:11.469855 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m16:48:11.575481 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m16:48:11.576867 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:48:11.577477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7ed91c8a-7d89-43ce-a436-34c6f2023c43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa22390>]}
[0m16:48:12.269273 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.my_project
- models.my_project.subfolder_name
[0m16:48:12.275265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ed91c8a-7d89-43ce-a436-34c6f2023c43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110080bd0>]}
[0m16:48:12.294491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ed91c8a-7d89-43ce-a436-34c6f2023c43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11002c450>]}
[0m16:48:12.295611 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m16:48:12.296473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ed91c8a-7d89-43ce-a436-34c6f2023c43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fca6590>]}
[0m16:48:12.299300 [warn ] [MainThread]: The selection criterion 'store_transaction_view' does not match any nodes
[0m16:48:12.301939 [info ] [MainThread]: 
[0m16:48:12.302872 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:48:12.305639 [debug] [MainThread]: Command end result
[0m16:48:12.318022 [debug] [MainThread]: Command `dbt run` succeeded at 16:48:12.317699 after 1.09 seconds
[0m16:48:12.319008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae2d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aec3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f785a10>]}
[0m16:48:12.320012 [debug] [MainThread]: Flushing usage events
[0m16:54:42.905004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ceff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bbbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cee050>]}


============================== 16:54:42.913703 | 693f097c-ed49-4913-821d-ea08c30d40ad ==============================
[0m16:54:42.913703 [info ] [MainThread]: Running with dbt=1.6.0
[0m16:54:42.914951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s store_transaction_view', 'send_anonymous_usage_stats': 'True'}
[0m16:54:43.146985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '693f097c-ed49-4913-821d-ea08c30d40ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd0f90>]}
[0m16:54:43.156129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '693f097c-ed49-4913-821d-ea08c30d40ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ff6490>]}
[0m16:54:43.157288 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m16:54:43.189936 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m16:54:43.263807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:54:43.264541 [debug] [MainThread]: Partial parsing: added file: sumup://models/store_transaction_view.sql
[0m16:54:43.307882 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.my_project
- models.my_project.subfolder_name
[0m16:54:43.313394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '693f097c-ed49-4913-821d-ea08c30d40ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e8290>]}
[0m16:54:43.334807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '693f097c-ed49-4913-821d-ea08c30d40ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10743f3d0>]}
[0m16:54:43.335539 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m16:54:43.336113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '693f097c-ed49-4913-821d-ea08c30d40ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc7350>]}
[0m16:54:43.338157 [info ] [MainThread]: 
[0m16:54:43.339152 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:54:43.340375 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m16:54:43.353464 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m16:54:43.354318 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m16:54:43.355148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:43.467091 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m16:54:43.469092 [debug] [ThreadPool]: On list_merveyasa: Close
[0m16:54:43.470452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now create_merveyasa_dbt_merve)
[0m16:54:43.471585 [debug] [ThreadPool]: Creating schema "database: "merveyasa"
schema: "dbt_merve"
"
[0m16:54:43.477140 [debug] [ThreadPool]: Using postgres connection "create_merveyasa_dbt_merve"
[0m16:54:43.477567 [debug] [ThreadPool]: On create_merveyasa_dbt_merve: BEGIN
[0m16:54:43.477897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:43.495342 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:54:43.495822 [debug] [ThreadPool]: Using postgres connection "create_merveyasa_dbt_merve"
[0m16:54:43.496172 [debug] [ThreadPool]: On create_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "create_merveyasa_dbt_merve"} */
create schema if not exists "dbt_merve"
[0m16:54:43.529703 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m16:54:43.530834 [debug] [ThreadPool]: On create_merveyasa_dbt_merve: COMMIT
[0m16:54:43.531200 [debug] [ThreadPool]: Using postgres connection "create_merveyasa_dbt_merve"
[0m16:54:43.531524 [debug] [ThreadPool]: On create_merveyasa_dbt_merve: COMMIT
[0m16:54:43.548009 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m16:54:43.548772 [debug] [ThreadPool]: On create_merveyasa_dbt_merve: Close
[0m16:54:43.551835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_merveyasa_dbt_merve, now list_merveyasa_dbt_merve)
[0m16:54:43.558302 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m16:54:43.558724 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m16:54:43.559042 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:43.565562 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:54:43.565993 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m16:54:43.566350 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m16:54:43.588007 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:54:43.589439 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m16:54:43.589972 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m16:54:43.595340 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:43.595793 [debug] [MainThread]: On master: BEGIN
[0m16:54:43.596114 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:54:43.602005 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:54:43.602437 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:43.602868 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:54:43.659121 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:54:43.660476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '693f097c-ed49-4913-821d-ea08c30d40ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106250850>]}
[0m16:54:43.660981 [debug] [MainThread]: On master: ROLLBACK
[0m16:54:43.661502 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:43.661853 [debug] [MainThread]: On master: BEGIN
[0m16:54:43.662367 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:54:43.662703 [debug] [MainThread]: On master: COMMIT
[0m16:54:43.663020 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:43.663327 [debug] [MainThread]: On master: COMMIT
[0m16:54:43.663822 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:54:43.664206 [debug] [MainThread]: On master: Close
[0m16:54:43.665157 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:54:43.665795 [info ] [MainThread]: 
[0m16:54:43.675761 [debug] [Thread-1 (]: Began running node model.sumup.store_transaction_view
[0m16:54:43.676654 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.store_transaction_view ................... [RUN]
[0m16:54:43.677884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.store_transaction_view)
[0m16:54:43.678576 [debug] [Thread-1 (]: Began compiling node model.sumup.store_transaction_view
[0m16:54:43.689633 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.store_transaction_view"
[0m16:54:43.690944 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_view (compile): 16:54:43.679490 => 16:54:43.690617
[0m16:54:43.691448 [debug] [Thread-1 (]: Began executing node model.sumup.store_transaction_view
[0m16:54:43.746616 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.store_transaction_view"
[0m16:54:43.748195 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m16:54:43.748815 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: BEGIN
[0m16:54:43.749243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:43.756851 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:54:43.757397 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m16:54:43.758205 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */

  create view "merveyasa"."dbt_merve"."store_transaction_view__dbt_tmp"
    
    
  as (
    CREATE VIEW store_transactions AS
SELECT
    s.store_id,
    s.typology,
    s.country,
    t.product_name,
    t.product_sku,
    t.category_name,
    t.amount,
    t.status,
    d.type AS device_type
FROM
    transactions t
JOIN devices d ON t.device_id = d.id
JOIN stores s ON d.store_id = s.id;
  );
[0m16:54:43.760398 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "CREATE"
LINE 7:     CREATE VIEW store_transactions AS
            ^

[0m16:54:43.761224 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: ROLLBACK
[0m16:54:43.762419 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_view (execute): 16:54:43.691753 => 16:54:43.762098
[0m16:54:43.763097 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: Close
[0m16:54:43.781391 [debug] [Thread-1 (]: Database Error in model store_transaction_view (models/store_transaction_view.sql)
  syntax error at or near "CREATE"
  LINE 7:     CREATE VIEW store_transactions AS
              ^
  compiled Code at target/run/sumup/models/store_transaction_view.sql
[0m16:54:43.782046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '693f097c-ed49-4913-821d-ea08c30d40ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10743fa90>]}
[0m16:54:43.783192 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_merve.store_transaction_view .......... [[31mERROR[0m in 0.10s]
[0m16:54:43.784325 [debug] [Thread-1 (]: Finished running node model.sumup.store_transaction_view
[0m16:54:43.794347 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:43.795164 [debug] [MainThread]: On master: BEGIN
[0m16:54:43.795846 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:54:43.808775 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:54:43.809280 [debug] [MainThread]: On master: COMMIT
[0m16:54:43.809597 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:43.809895 [debug] [MainThread]: On master: COMMIT
[0m16:54:43.810427 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:54:43.810771 [debug] [MainThread]: On master: Close
[0m16:54:43.811561 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:43.811920 [debug] [MainThread]: Connection 'model.sumup.store_transaction_view' was properly closed.
[0m16:54:43.812385 [info ] [MainThread]: 
[0m16:54:43.812834 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m16:54:43.813582 [debug] [MainThread]: Command end result
[0m16:54:43.824040 [info ] [MainThread]: 
[0m16:54:43.824671 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:54:43.825186 [info ] [MainThread]: 
[0m16:54:43.825646 [error] [MainThread]: [33mDatabase Error in model store_transaction_view (models/store_transaction_view.sql)[0m
[0m16:54:43.826089 [error] [MainThread]:   syntax error at or near "CREATE"
[0m16:54:43.826450 [error] [MainThread]:   LINE 7:     CREATE VIEW store_transactions AS
[0m16:54:43.826982 [error] [MainThread]:               ^
[0m16:54:43.827445 [error] [MainThread]:   compiled Code at target/run/sumup/models/store_transaction_view.sql
[0m16:54:43.827866 [info ] [MainThread]: 
[0m16:54:43.828304 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:54:43.829261 [debug] [MainThread]: Command `dbt run` failed at 16:54:43.829056 after 0.98 seconds
[0m16:54:43.829822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a68c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022ad6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072aa6d0>]}
[0m16:54:43.830353 [debug] [MainThread]: Flushing usage events
[0m17:03:15.135205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9e6710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc51b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc5b650>]}


============================== 17:03:15.145991 | 362cde7a-539a-4859-87b6-07f85ea989b8 ==============================
[0m17:03:15.145991 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:03:15.146949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m store_transaction_view', 'send_anonymous_usage_stats': 'True'}
[0m17:03:15.378676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '362cde7a-539a-4859-87b6-07f85ea989b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f956810>]}
[0m17:03:15.387479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '362cde7a-539a-4859-87b6-07f85ea989b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f96d390>]}
[0m17:03:15.388582 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:03:15.419997 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:03:15.444435 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:03:15.445052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '362cde7a-539a-4859-87b6-07f85ea989b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6b9950>]}
[0m17:03:16.183192 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.my_project
- models.my_project.store_transaction_view
[0m17:03:16.189641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '362cde7a-539a-4859-87b6-07f85ea989b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff58310>]}
[0m17:03:16.206669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '362cde7a-539a-4859-87b6-07f85ea989b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff6f910>]}
[0m17:03:16.207296 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:03:16.207776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '362cde7a-539a-4859-87b6-07f85ea989b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff22250>]}
[0m17:03:16.209691 [info ] [MainThread]: 
[0m17:03:16.211391 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:03:16.213394 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m17:03:16.231807 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m17:03:16.232472 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m17:03:16.233142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:16.287924 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:03:16.290379 [debug] [ThreadPool]: On list_merveyasa: Close
[0m17:03:16.292330 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m17:03:16.299613 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:03:16.300093 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m17:03:16.300519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:03:16.307539 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:03:16.307986 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:03:16.308355 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m17:03:16.312372 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m17:03:16.314548 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m17:03:16.315278 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m17:03:16.320054 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:16.320492 [debug] [MainThread]: On master: BEGIN
[0m17:03:16.320809 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:03:16.326617 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:03:16.327051 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:16.327478 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:03:16.339703 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m17:03:16.341127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '362cde7a-539a-4859-87b6-07f85ea989b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff9ec10>]}
[0m17:03:16.341632 [debug] [MainThread]: On master: ROLLBACK
[0m17:03:16.342133 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:16.342470 [debug] [MainThread]: On master: BEGIN
[0m17:03:16.343092 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:03:16.343455 [debug] [MainThread]: On master: COMMIT
[0m17:03:16.343789 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:16.344109 [debug] [MainThread]: On master: COMMIT
[0m17:03:16.344532 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:03:16.344874 [debug] [MainThread]: On master: Close
[0m17:03:16.345680 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:03:16.346115 [info ] [MainThread]: 
[0m17:03:16.349528 [debug] [Thread-1 (]: Began running node model.sumup.store_transaction_view
[0m17:03:16.350174 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.store_transaction_view ................... [RUN]
[0m17:03:16.350994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.store_transaction_view)
[0m17:03:16.351449 [debug] [Thread-1 (]: Began compiling node model.sumup.store_transaction_view
[0m17:03:16.359439 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.store_transaction_view"
[0m17:03:16.360522 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_view (compile): 17:03:16.351748 => 17:03:16.360221
[0m17:03:16.361022 [debug] [Thread-1 (]: Began executing node model.sumup.store_transaction_view
[0m17:03:16.415250 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.store_transaction_view"
[0m17:03:16.416438 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:03:16.416934 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: BEGIN
[0m17:03:16.417361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:16.425270 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:03:16.425862 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:03:16.426357 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */

  create view "merveyasa"."dbt_merve"."store_transaction_view__dbt_tmp"
    
    
  as (
    with store_transactions AS
(
SELECT
    s.store_id,
    s.typology,
    s.country,
    t.product_name,
    t.product_sku,
    t.category_name,
    t.amount,
    t.status,
    d.type AS device_type
FROM
    transactions t
JOIN devices d ON t.device_id = d.id
JOIN stores s ON d.store_id = s.id
)

select * from store_transactions
  );
[0m17:03:16.430239 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column d.id does not exist
LINE 21: JOIN devices d ON t.device_id = d.id
                                         ^

[0m17:03:16.430862 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: ROLLBACK
[0m17:03:16.431783 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_view (execute): 17:03:16.361332 => 17:03:16.431488
[0m17:03:16.432273 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: Close
[0m17:03:16.476975 [debug] [Thread-1 (]: Database Error in model store_transaction_view (models/store_transaction_view.sql)
  column d.id does not exist
  LINE 21: JOIN devices d ON t.device_id = d.id
                                           ^
  compiled Code at target/run/sumup/models/store_transaction_view.sql
[0m17:03:16.478079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '362cde7a-539a-4859-87b6-07f85ea989b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11002e990>]}
[0m17:03:16.479067 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_merve.store_transaction_view .......... [[31mERROR[0m in 0.13s]
[0m17:03:16.480229 [debug] [Thread-1 (]: Finished running node model.sumup.store_transaction_view
[0m17:03:16.482841 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:16.483393 [debug] [MainThread]: On master: BEGIN
[0m17:03:16.483973 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:03:16.493407 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:03:16.494298 [debug] [MainThread]: On master: COMMIT
[0m17:03:16.495502 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:16.496405 [debug] [MainThread]: On master: COMMIT
[0m17:03:16.497308 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:03:16.497798 [debug] [MainThread]: On master: Close
[0m17:03:16.498711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:16.499645 [debug] [MainThread]: Connection 'model.sumup.store_transaction_view' was properly closed.
[0m17:03:16.500491 [info ] [MainThread]: 
[0m17:03:16.501053 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m17:03:16.502763 [debug] [MainThread]: Command end result
[0m17:03:16.513430 [info ] [MainThread]: 
[0m17:03:16.514270 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:03:16.514953 [info ] [MainThread]: 
[0m17:03:16.515574 [error] [MainThread]: [33mDatabase Error in model store_transaction_view (models/store_transaction_view.sql)[0m
[0m17:03:16.516094 [error] [MainThread]:   column d.id does not exist
[0m17:03:16.517695 [error] [MainThread]:   LINE 21: JOIN devices d ON t.device_id = d.id
[0m17:03:16.521003 [error] [MainThread]:                                            ^
[0m17:03:16.522007 [error] [MainThread]:   compiled Code at target/run/sumup/models/store_transaction_view.sql
[0m17:03:16.522670 [info ] [MainThread]: 
[0m17:03:16.523322 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:03:16.524152 [debug] [MainThread]: Command `dbt run` failed at 17:03:16.524016 after 1.43 seconds
[0m17:03:16.524600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed2bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f756390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9848d0>]}
[0m17:03:16.525047 [debug] [MainThread]: Flushing usage events
[0m17:04:33.841051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e218b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e51b5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df6ab50>]}


============================== 17:04:33.847065 | 58aceb30-1c2b-4cbd-83c6-79009b005889 ==============================
[0m17:04:33.847065 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:04:33.847908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m store_transaction_view', 'send_anonymous_usage_stats': 'True'}
[0m17:04:33.945737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58aceb30-1c2b-4cbd-83c6-79009b005889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df98210>]}
[0m17:04:33.954942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58aceb30-1c2b-4cbd-83c6-79009b005889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e220750>]}
[0m17:04:33.955739 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:04:33.990872 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:04:34.027325 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:04:34.028245 [debug] [MainThread]: Partial parsing: updated file: sumup://models/store_transaction_view.sql
[0m17:04:34.065130 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.my_project
- models.my_project.store_transaction_view
[0m17:04:34.070657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58aceb30-1c2b-4cbd-83c6-79009b005889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e542010>]}
[0m17:04:34.087710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58aceb30-1c2b-4cbd-83c6-79009b005889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8f61d0>]}
[0m17:04:34.088605 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:04:34.089577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58aceb30-1c2b-4cbd-83c6-79009b005889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df87a50>]}
[0m17:04:34.092407 [info ] [MainThread]: 
[0m17:04:34.093925 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:04:34.095941 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m17:04:34.124196 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m17:04:34.125109 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m17:04:34.125855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:34.179511 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:04:34.181792 [debug] [ThreadPool]: On list_merveyasa: Close
[0m17:04:34.185355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m17:04:34.196301 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:04:34.196991 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m17:04:34.197597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:34.215207 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:04:34.215859 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:04:34.216483 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m17:04:34.221065 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m17:04:34.222673 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m17:04:34.223259 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m17:04:34.229570 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:34.230042 [debug] [MainThread]: On master: BEGIN
[0m17:04:34.230409 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:04:34.251287 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:04:34.251728 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:34.252192 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:04:34.265945 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m17:04:34.267271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58aceb30-1c2b-4cbd-83c6-79009b005889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9df9d0>]}
[0m17:04:34.267781 [debug] [MainThread]: On master: ROLLBACK
[0m17:04:34.268285 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:34.268636 [debug] [MainThread]: On master: BEGIN
[0m17:04:34.269173 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:04:34.269529 [debug] [MainThread]: On master: COMMIT
[0m17:04:34.269870 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:34.270197 [debug] [MainThread]: On master: COMMIT
[0m17:04:34.270633 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:04:34.271031 [debug] [MainThread]: On master: Close
[0m17:04:34.274083 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:04:34.276163 [info ] [MainThread]: 
[0m17:04:34.278831 [debug] [Thread-1 (]: Began running node model.sumup.store_transaction_view
[0m17:04:34.279681 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.store_transaction_view ................... [RUN]
[0m17:04:34.280903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.store_transaction_view)
[0m17:04:34.281596 [debug] [Thread-1 (]: Began compiling node model.sumup.store_transaction_view
[0m17:04:34.293907 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.store_transaction_view"
[0m17:04:34.294949 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_view (compile): 17:04:34.282086 => 17:04:34.294657
[0m17:04:34.295468 [debug] [Thread-1 (]: Began executing node model.sumup.store_transaction_view
[0m17:04:34.361513 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.store_transaction_view"
[0m17:04:34.363004 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:04:34.363924 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: BEGIN
[0m17:04:34.364930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:34.373765 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:04:34.374342 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:04:34.374779 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */

  create view "merveyasa"."dbt_merve"."store_transaction_view__dbt_tmp"
    
    
  as (
    with store_transactions AS
(
SELECT
    s.store_id,
    s.typology,
    s.country,
    t.product_name,
    t.product_sku,
    t.category_name,
    t.transaction_amount,
    t.transaction_status,
    d.device_type
FROM
    transactions t
JOIN devices d ON t.device_id = d.device_id
JOIN stores s ON d.store_id = s.store_id
)

select * from store_transactions
  );
[0m17:04:34.376720 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column s.typology does not exist
LINE 11:     s.typology,
             ^

[0m17:04:34.377718 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: ROLLBACK
[0m17:04:34.379014 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_view (execute): 17:04:34.295888 => 17:04:34.378593
[0m17:04:34.380160 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: Close
[0m17:04:34.387065 [debug] [Thread-1 (]: Database Error in model store_transaction_view (models/store_transaction_view.sql)
  column s.typology does not exist
  LINE 11:     s.typology,
               ^
  compiled Code at target/run/sumup/models/store_transaction_view.sql
[0m17:04:34.387667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58aceb30-1c2b-4cbd-83c6-79009b005889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e543f90>]}
[0m17:04:34.388372 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_merve.store_transaction_view .......... [[31mERROR[0m in 0.11s]
[0m17:04:34.391608 [debug] [Thread-1 (]: Finished running node model.sumup.store_transaction_view
[0m17:04:34.394241 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:34.394660 [debug] [MainThread]: On master: BEGIN
[0m17:04:34.394996 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:04:34.408341 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:04:34.411233 [debug] [MainThread]: On master: COMMIT
[0m17:04:34.411688 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:34.412076 [debug] [MainThread]: On master: COMMIT
[0m17:04:34.412694 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:04:34.413357 [debug] [MainThread]: On master: Close
[0m17:04:34.416704 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:04:34.417484 [debug] [MainThread]: Connection 'model.sumup.store_transaction_view' was properly closed.
[0m17:04:34.418475 [info ] [MainThread]: 
[0m17:04:34.419823 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m17:04:34.425415 [debug] [MainThread]: Command end result
[0m17:04:34.445062 [info ] [MainThread]: 
[0m17:04:34.446887 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:04:34.447898 [info ] [MainThread]: 
[0m17:04:34.449610 [error] [MainThread]: [33mDatabase Error in model store_transaction_view (models/store_transaction_view.sql)[0m
[0m17:04:34.451422 [error] [MainThread]:   column s.typology does not exist
[0m17:04:34.452635 [error] [MainThread]:   LINE 11:     s.typology,
[0m17:04:34.453389 [error] [MainThread]:                ^
[0m17:04:34.459158 [error] [MainThread]:   compiled Code at target/run/sumup/models/store_transaction_view.sql
[0m17:04:34.459990 [info ] [MainThread]: 
[0m17:04:34.460823 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:04:34.464741 [debug] [MainThread]: Command `dbt run` failed at 17:04:34.464504 after 0.65 seconds
[0m17:04:34.465481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e218b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e000510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e305610>]}
[0m17:04:34.466017 [debug] [MainThread]: Flushing usage events
[0m17:05:04.204834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b4a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b2b290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111df87d0>]}


============================== 17:05:04.211367 | 85887cb4-0e83-42a3-9a49-d83a8cab350f ==============================
[0m17:05:04.211367 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:05:04.212223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m store_transaction_view', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:05:04.312866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85887cb4-0e83-42a3-9a49-d83a8cab350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b4a350>]}
[0m17:05:04.321785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85887cb4-0e83-42a3-9a49-d83a8cab350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b48f90>]}
[0m17:05:04.322504 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:05:04.343292 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:05:04.386083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:05:04.386948 [debug] [MainThread]: Partial parsing: updated file: sumup://models/store_transaction_view.sql
[0m17:05:04.429797 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.my_project.store_transaction_view
- models.my_project
[0m17:05:04.435954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85887cb4-0e83-42a3-9a49-d83a8cab350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124af5d0>]}
[0m17:05:04.452972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85887cb4-0e83-42a3-9a49-d83a8cab350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dc1a50>]}
[0m17:05:04.453618 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:05:04.454105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85887cb4-0e83-42a3-9a49-d83a8cab350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11205c450>]}
[0m17:05:04.455827 [info ] [MainThread]: 
[0m17:05:04.457030 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:05:04.458467 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m17:05:04.477467 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m17:05:04.478029 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m17:05:04.478449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:04.519842 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:05:04.521967 [debug] [ThreadPool]: On list_merveyasa: Close
[0m17:05:04.524027 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m17:05:04.531844 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:05:04.532317 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m17:05:04.532702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:05:04.539643 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:05:04.540320 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:05:04.541042 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m17:05:04.546998 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m17:05:04.548959 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m17:05:04.549738 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m17:05:04.556003 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:04.556459 [debug] [MainThread]: On master: BEGIN
[0m17:05:04.556813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:05:04.567148 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:05:04.567833 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:04.569069 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:05:04.585993 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m17:05:04.587880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85887cb4-0e83-42a3-9a49-d83a8cab350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120e9b50>]}
[0m17:05:04.588804 [debug] [MainThread]: On master: ROLLBACK
[0m17:05:04.589705 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:04.590226 [debug] [MainThread]: On master: BEGIN
[0m17:05:04.590894 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:05:04.591331 [debug] [MainThread]: On master: COMMIT
[0m17:05:04.591759 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:04.592212 [debug] [MainThread]: On master: COMMIT
[0m17:05:04.592896 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:05:04.593577 [debug] [MainThread]: On master: Close
[0m17:05:04.594949 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:05:04.595705 [info ] [MainThread]: 
[0m17:05:04.598782 [debug] [Thread-1 (]: Began running node model.sumup.store_transaction_view
[0m17:05:04.599720 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.store_transaction_view ................... [RUN]
[0m17:05:04.600817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.store_transaction_view)
[0m17:05:04.601403 [debug] [Thread-1 (]: Began compiling node model.sumup.store_transaction_view
[0m17:05:04.611371 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.store_transaction_view"
[0m17:05:04.612764 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_view (compile): 17:05:04.601874 => 17:05:04.612387
[0m17:05:04.613561 [debug] [Thread-1 (]: Began executing node model.sumup.store_transaction_view
[0m17:05:04.661596 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.store_transaction_view"
[0m17:05:04.662496 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:05:04.663019 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: BEGIN
[0m17:05:04.663407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:04.669503 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:05:04.669980 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:05:04.670414 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */

  create view "merveyasa"."dbt_merve"."store_transaction_view__dbt_tmp"
    
    
  as (
    with store_transactions AS
(
SELECT
    s.store_id,
    s.store_typology,
    s.store_country,
    t.product_name,
    t.product_sku,
    t.category_name,
    t.transaction_amount,
    t.transaction_status,
    d.device_type
FROM
    transactions t
JOIN devices d ON t.device_id = d.device_id
JOIN stores s ON d.store_id = s.store_id
)

select * from store_transactions
  );
[0m17:05:04.715151 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:05:04.725007 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:05:04.725481 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */
alter table "merveyasa"."dbt_merve"."store_transaction_view__dbt_tmp" rename to "store_transaction_view"
[0m17:05:04.728025 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:05:04.745672 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: COMMIT
[0m17:05:04.746180 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:05:04.746591 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: COMMIT
[0m17:05:04.748123 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:05:04.757533 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:05:04.758033 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */
drop view if exists "merveyasa"."dbt_merve"."store_transaction_view__dbt_backup" cascade
[0m17:05:04.759649 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:05:04.761593 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_view (execute): 17:05:04.613912 => 17:05:04.761333
[0m17:05:04.762066 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: Close
[0m17:05:04.763023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85887cb4-0e83-42a3-9a49-d83a8cab350f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e4dd90>]}
[0m17:05:04.763832 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_merve.store_transaction_view .............. [[32mCREATE VIEW[0m in 0.16s]
[0m17:05:04.764737 [debug] [Thread-1 (]: Finished running node model.sumup.store_transaction_view
[0m17:05:04.767203 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:04.767612 [debug] [MainThread]: On master: BEGIN
[0m17:05:04.767943 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:05:04.777217 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:05:04.777870 [debug] [MainThread]: On master: COMMIT
[0m17:05:04.778287 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:04.778747 [debug] [MainThread]: On master: COMMIT
[0m17:05:04.779611 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:05:04.780706 [debug] [MainThread]: On master: Close
[0m17:05:04.782652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:05:04.783121 [debug] [MainThread]: Connection 'model.sumup.store_transaction_view' was properly closed.
[0m17:05:04.783831 [info ] [MainThread]: 
[0m17:05:04.784593 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m17:05:04.785819 [debug] [MainThread]: Command end result
[0m17:05:04.794406 [info ] [MainThread]: 
[0m17:05:04.794952 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:05:04.795372 [info ] [MainThread]: 
[0m17:05:04.796059 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:05:04.796824 [debug] [MainThread]: Command `dbt run` succeeded at 17:05:04.796690 after 0.62 seconds
[0m17:05:04.797464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120d3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bb9ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d417a90>]}
[0m17:05:04.797927 [debug] [MainThread]: Flushing usage events
[0m17:13:45.675676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aefda10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1996d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b17e750>]}


============================== 17:13:45.692460 | e8afa91b-4887-45e5-a50c-140b1a37fe7b ==============================
[0m17:13:45.692460 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:13:45.693359 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m product_agg', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:13:45.888595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8afa91b-4887-45e5-a50c-140b1a37fe7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce42d0>]}
[0m17:13:45.897694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8afa91b-4887-45e5-a50c-140b1a37fe7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aefed10>]}
[0m17:13:45.899094 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:13:45.930027 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:13:45.948916 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:13:45.949859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e8afa91b-4887-45e5-a50c-140b1a37fe7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8616d0>]}
[0m17:13:46.674609 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.my_project.product_agg
- models.my_project
- models.my_project.store_transaction_first
- models.my_project.store_transaction_view
[0m17:13:46.679968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8afa91b-4887-45e5-a50c-140b1a37fe7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1adf10>]}
[0m17:13:46.697717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8afa91b-4887-45e5-a50c-140b1a37fe7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b82f510>]}
[0m17:13:46.698760 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:13:46.699639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8afa91b-4887-45e5-a50c-140b1a37fe7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a967a90>]}
[0m17:13:46.702362 [info ] [MainThread]: 
[0m17:13:46.704441 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:13:46.708227 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m17:13:46.742054 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m17:13:46.743008 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m17:13:46.743850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:46.793077 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:13:46.794890 [debug] [ThreadPool]: On list_merveyasa: Close
[0m17:13:46.797017 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m17:13:46.803557 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:13:46.803978 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m17:13:46.804310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:13:46.810338 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:13:46.810759 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:13:46.811134 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m17:13:46.814975 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:13:46.816294 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m17:13:46.816834 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m17:13:46.821757 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:46.822135 [debug] [MainThread]: On master: BEGIN
[0m17:13:46.822437 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:13:46.828491 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:13:46.828872 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:46.829280 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:13:46.841683 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m17:13:46.843504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8afa91b-4887-45e5-a50c-140b1a37fe7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7c2d90>]}
[0m17:13:46.844028 [debug] [MainThread]: On master: ROLLBACK
[0m17:13:46.844672 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:46.845008 [debug] [MainThread]: On master: BEGIN
[0m17:13:46.845654 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:13:46.846088 [debug] [MainThread]: On master: COMMIT
[0m17:13:46.846491 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:46.846837 [debug] [MainThread]: On master: COMMIT
[0m17:13:46.847267 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:13:46.847613 [debug] [MainThread]: On master: Close
[0m17:13:46.848408 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:13:46.848822 [info ] [MainThread]: 
[0m17:13:46.851913 [debug] [Thread-1 (]: Began running node model.sumup.product_agg
[0m17:13:46.852537 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.product_agg .............................. [RUN]
[0m17:13:46.853360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.product_agg)
[0m17:13:46.853900 [debug] [Thread-1 (]: Began compiling node model.sumup.product_agg
[0m17:13:46.864738 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.product_agg"
[0m17:13:46.866075 [debug] [Thread-1 (]: Timing info for model.sumup.product_agg (compile): 17:13:46.854287 => 17:13:46.865606
[0m17:13:46.866838 [debug] [Thread-1 (]: Began executing node model.sumup.product_agg
[0m17:13:46.917147 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.product_agg"
[0m17:13:46.918218 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m17:13:46.918701 [debug] [Thread-1 (]: On model.sumup.product_agg: BEGIN
[0m17:13:46.919088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:13:46.925803 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:13:46.926509 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m17:13:46.926962 [debug] [Thread-1 (]: On model.sumup.product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.product_agg"} */

  create view "merveyasa"."dbt_merve"."product_agg__dbt_tmp"
    
    
  as (
    WITH product_agg AS 
(
SELECT
    product_name,
    product_sku,
    COUNT(*) AS transactions_count,
    SUM(transaction_amount) AS total_amount
FROM
    transactions
WHERE
    status = 'accepted' -- Consider only accepted transactions
GROUP BY
    product_name, product_sku
)

select * from product_agg
  );
[0m17:13:46.937522 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "status" does not exist
LINE 17:     status = 'accepted' -- Consider only accepted transactio...
             ^

[0m17:13:46.938092 [debug] [Thread-1 (]: On model.sumup.product_agg: ROLLBACK
[0m17:13:46.938888 [debug] [Thread-1 (]: Timing info for model.sumup.product_agg (execute): 17:13:46.867281 => 17:13:46.938653
[0m17:13:46.939288 [debug] [Thread-1 (]: On model.sumup.product_agg: Close
[0m17:13:46.981260 [debug] [Thread-1 (]: Database Error in model product_agg (models/product_agg.sql)
  column "status" does not exist
  LINE 17:     status = 'accepted' -- Consider only accepted transactio...
               ^
  compiled Code at target/run/sumup/models/product_agg.sql
[0m17:13:46.982349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8afa91b-4887-45e5-a50c-140b1a37fe7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be204d0>]}
[0m17:13:46.983325 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_merve.product_agg ..................... [[31mERROR[0m in 0.13s]
[0m17:13:46.984780 [debug] [Thread-1 (]: Finished running node model.sumup.product_agg
[0m17:13:46.987183 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:46.987578 [debug] [MainThread]: On master: BEGIN
[0m17:13:46.987904 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:13:46.995200 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:13:46.996120 [debug] [MainThread]: On master: COMMIT
[0m17:13:46.996623 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:46.997332 [debug] [MainThread]: On master: COMMIT
[0m17:13:46.999511 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:13:47.000227 [debug] [MainThread]: On master: Close
[0m17:13:47.001771 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:13:47.002459 [debug] [MainThread]: Connection 'model.sumup.product_agg' was properly closed.
[0m17:13:47.002927 [info ] [MainThread]: 
[0m17:13:47.003637 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m17:13:47.004615 [debug] [MainThread]: Command end result
[0m17:13:47.013080 [info ] [MainThread]: 
[0m17:13:47.013622 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:13:47.013987 [info ] [MainThread]: 
[0m17:13:47.014372 [error] [MainThread]: [33mDatabase Error in model product_agg (models/product_agg.sql)[0m
[0m17:13:47.014834 [error] [MainThread]:   column "status" does not exist
[0m17:13:47.015185 [error] [MainThread]:   LINE 17:     status = 'accepted' -- Consider only accepted transactio...
[0m17:13:47.015546 [error] [MainThread]:                ^
[0m17:13:47.016240 [error] [MainThread]:   compiled Code at target/run/sumup/models/product_agg.sql
[0m17:13:47.017058 [info ] [MainThread]: 
[0m17:13:47.017507 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:13:47.018297 [debug] [MainThread]: Command `dbt run` failed at 17:13:47.018100 after 1.37 seconds
[0m17:13:47.018794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b20e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106728390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b74c490>]}
[0m17:13:47.019693 [debug] [MainThread]: Flushing usage events
[0m17:14:16.652477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147cf110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114230d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147d9490>]}


============================== 17:14:16.658440 | 4aafab52-12f5-442d-b87d-fd6a3be93808 ==============================
[0m17:14:16.658440 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:14:16.659366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m product_agg', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:14:16.759063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4aafab52-12f5-442d-b87d-fd6a3be93808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11414da90>]}
[0m17:14:16.768123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4aafab52-12f5-442d-b87d-fd6a3be93808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114231890>]}
[0m17:14:16.768894 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:14:16.795963 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:14:16.836485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:14:16.837321 [debug] [MainThread]: Partial parsing: updated file: sumup://models/product_agg.sql
[0m17:14:16.878622 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.my_project.store_transaction_view
- models.my_project
- models.my_project.store_transaction_first
- models.my_project.product_agg
[0m17:14:16.885129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4aafab52-12f5-442d-b87d-fd6a3be93808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142415d0>]}
[0m17:14:16.933697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4aafab52-12f5-442d-b87d-fd6a3be93808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114bae450>]}
[0m17:14:16.934393 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:14:16.935075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4aafab52-12f5-442d-b87d-fd6a3be93808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147eab90>]}
[0m17:14:16.936865 [info ] [MainThread]: 
[0m17:14:16.937979 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:14:16.939362 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m17:14:16.956694 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m17:14:16.957260 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m17:14:16.957679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:16.997459 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:14:16.999862 [debug] [ThreadPool]: On list_merveyasa: Close
[0m17:14:17.002394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m17:14:17.009793 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:14:17.010281 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m17:14:17.010666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:14:17.017023 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:14:17.017469 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:14:17.017870 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m17:14:17.022140 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:14:17.023662 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m17:14:17.024192 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m17:14:17.029503 [debug] [MainThread]: Using postgres connection "master"
[0m17:14:17.029947 [debug] [MainThread]: On master: BEGIN
[0m17:14:17.030288 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:14:17.036083 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:14:17.036508 [debug] [MainThread]: Using postgres connection "master"
[0m17:14:17.036969 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:14:17.050725 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m17:14:17.052053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4aafab52-12f5-442d-b87d-fd6a3be93808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144e2890>]}
[0m17:14:17.053192 [debug] [MainThread]: On master: ROLLBACK
[0m17:14:17.053996 [debug] [MainThread]: Using postgres connection "master"
[0m17:14:17.054578 [debug] [MainThread]: On master: BEGIN
[0m17:14:17.055406 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:14:17.055848 [debug] [MainThread]: On master: COMMIT
[0m17:14:17.056513 [debug] [MainThread]: Using postgres connection "master"
[0m17:14:17.057078 [debug] [MainThread]: On master: COMMIT
[0m17:14:17.057813 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:14:17.058421 [debug] [MainThread]: On master: Close
[0m17:14:17.059560 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:14:17.060457 [info ] [MainThread]: 
[0m17:14:17.063384 [debug] [Thread-1 (]: Began running node model.sumup.product_agg
[0m17:14:17.064113 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.product_agg .............................. [RUN]
[0m17:14:17.065184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.product_agg)
[0m17:14:17.065797 [debug] [Thread-1 (]: Began compiling node model.sumup.product_agg
[0m17:14:17.078790 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.product_agg"
[0m17:14:17.080421 [debug] [Thread-1 (]: Timing info for model.sumup.product_agg (compile): 17:14:17.066137 => 17:14:17.079677
[0m17:14:17.081349 [debug] [Thread-1 (]: Began executing node model.sumup.product_agg
[0m17:14:17.141876 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.product_agg"
[0m17:14:17.142826 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m17:14:17.143440 [debug] [Thread-1 (]: On model.sumup.product_agg: BEGIN
[0m17:14:17.143840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:17.150052 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:14:17.150533 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m17:14:17.150977 [debug] [Thread-1 (]: On model.sumup.product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.product_agg"} */

  create view "merveyasa"."dbt_merve"."product_agg__dbt_tmp"
    
    
  as (
    WITH product_agg AS 
(
SELECT
    product_name,
    product_sku,
    COUNT(*) AS transactions_count,
    SUM(transaction_amount) AS total_amount
FROM
    transactions
WHERE
    transaction_status = 'accepted' -- Consider only accepted transactions
GROUP BY
    product_name, product_sku
)

select * from product_agg
  );
[0m17:14:17.157298 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:14:17.164135 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m17:14:17.164625 [debug] [Thread-1 (]: On model.sumup.product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.product_agg"} */
alter table "merveyasa"."dbt_merve"."product_agg__dbt_tmp" rename to "product_agg"
[0m17:14:17.165584 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:14:17.181872 [debug] [Thread-1 (]: On model.sumup.product_agg: COMMIT
[0m17:14:17.182329 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m17:14:17.182696 [debug] [Thread-1 (]: On model.sumup.product_agg: COMMIT
[0m17:14:17.184244 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:14:17.193209 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m17:14:17.193735 [debug] [Thread-1 (]: On model.sumup.product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.product_agg"} */
drop view if exists "merveyasa"."dbt_merve"."product_agg__dbt_backup" cascade
[0m17:14:17.194454 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:14:17.196042 [debug] [Thread-1 (]: Timing info for model.sumup.product_agg (execute): 17:14:17.082193 => 17:14:17.195828
[0m17:14:17.196449 [debug] [Thread-1 (]: On model.sumup.product_agg: Close
[0m17:14:17.197351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4aafab52-12f5-442d-b87d-fd6a3be93808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b5e910>]}
[0m17:14:17.198111 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_merve.product_agg ......................... [[32mCREATE VIEW[0m in 0.13s]
[0m17:14:17.198889 [debug] [Thread-1 (]: Finished running node model.sumup.product_agg
[0m17:14:17.201110 [debug] [MainThread]: Using postgres connection "master"
[0m17:14:17.201528 [debug] [MainThread]: On master: BEGIN
[0m17:14:17.201885 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:14:17.208778 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:14:17.209361 [debug] [MainThread]: On master: COMMIT
[0m17:14:17.209843 [debug] [MainThread]: Using postgres connection "master"
[0m17:14:17.210520 [debug] [MainThread]: On master: COMMIT
[0m17:14:17.211441 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:14:17.212058 [debug] [MainThread]: On master: Close
[0m17:14:17.213318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:17.214013 [debug] [MainThread]: Connection 'model.sumup.product_agg' was properly closed.
[0m17:14:17.214659 [info ] [MainThread]: 
[0m17:14:17.215181 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m17:14:17.216076 [debug] [MainThread]: Command end result
[0m17:14:17.226448 [info ] [MainThread]: 
[0m17:14:17.227013 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:14:17.227514 [info ] [MainThread]: 
[0m17:14:17.228133 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:14:17.228966 [debug] [MainThread]: Command `dbt run` succeeded at 17:14:17.228815 after 0.60 seconds
[0m17:14:17.229549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11414dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f971590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126181d0>]}
[0m17:14:17.230037 [debug] [MainThread]: Flushing usage events
[0m17:16:25.745967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c476bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7146d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c46f090>]}


============================== 17:16:25.751958 | c22426a7-a40f-489b-893a-14ed3952d9ac ==============================
[0m17:16:25.751958 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:16:25.752888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m store_transaction_view', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:16:25.853632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c22426a7-a40f-489b-893a-14ed3952d9ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c539d50>]}
[0m17:16:25.862544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c22426a7-a40f-489b-893a-14ed3952d9ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7f6d10>]}
[0m17:16:25.863465 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:16:25.890581 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:16:25.935231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:16:25.936020 [debug] [MainThread]: Partial parsing: updated file: sumup://models/store_transaction_first.sql
[0m17:16:25.936502 [debug] [MainThread]: Partial parsing: updated file: sumup://models/store_transaction_view.sql
[0m17:16:25.978450 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.my_project
- models.my_project.product_agg
- models.my_project.store_transaction_view
- models.my_project.store_transaction_first
[0m17:16:25.983653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c22426a7-a40f-489b-893a-14ed3952d9ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd8a110>]}
[0m17:16:25.998135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c22426a7-a40f-489b-893a-14ed3952d9ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3e1310>]}
[0m17:16:25.999212 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:16:26.000007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c22426a7-a40f-489b-893a-14ed3952d9ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096e1e10>]}
[0m17:16:26.001825 [info ] [MainThread]: 
[0m17:16:26.002879 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:16:26.006126 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m17:16:26.019839 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m17:16:26.020731 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m17:16:26.021530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:26.058880 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:16:26.061607 [debug] [ThreadPool]: On list_merveyasa: Close
[0m17:16:26.064795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m17:16:26.072087 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:16:26.072544 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m17:16:26.072926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:26.079523 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:16:26.079975 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:16:26.080440 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m17:16:26.084556 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m17:16:26.086047 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m17:16:26.086682 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m17:16:26.092491 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:26.092912 [debug] [MainThread]: On master: BEGIN
[0m17:16:26.093252 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:16:26.099677 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:16:26.100360 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:26.101134 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:16:26.118185 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m17:16:26.119601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c22426a7-a40f-489b-893a-14ed3952d9ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd75850>]}
[0m17:16:26.120110 [debug] [MainThread]: On master: ROLLBACK
[0m17:16:26.120601 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:26.120952 [debug] [MainThread]: On master: BEGIN
[0m17:16:26.121508 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:16:26.121859 [debug] [MainThread]: On master: COMMIT
[0m17:16:26.122193 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:26.122512 [debug] [MainThread]: On master: COMMIT
[0m17:16:26.122938 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:16:26.123281 [debug] [MainThread]: On master: Close
[0m17:16:26.124085 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:16:26.124500 [info ] [MainThread]: 
[0m17:16:26.126822 [debug] [Thread-1 (]: Began running node model.sumup.store_transaction_view
[0m17:16:26.127400 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.store_transaction_view ................... [RUN]
[0m17:16:26.128180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.store_transaction_view)
[0m17:16:26.128615 [debug] [Thread-1 (]: Began compiling node model.sumup.store_transaction_view
[0m17:16:26.137034 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.store_transaction_view"
[0m17:16:26.138759 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_view (compile): 17:16:26.128917 => 17:16:26.138224
[0m17:16:26.139563 [debug] [Thread-1 (]: Began executing node model.sumup.store_transaction_view
[0m17:16:26.184164 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.store_transaction_view"
[0m17:16:26.185071 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:16:26.185577 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: BEGIN
[0m17:16:26.185956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:26.192184 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:16:26.192646 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:16:26.193069 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */

  create view "merveyasa"."dbt_merve"."store_transaction_view__dbt_tmp"
    
    
  as (
    WITH store_transactions AS
(
SELECT
    s.store_id,
    s.store_typology,
    s.store_country,
    t.product_name,
    t.product_sku,
    t.category_name,
    t.transaction_amount,
    t.transaction_status,
    t.transaction_happened_at
    d.device_type
FROM
    transactions t
JOIN devices d ON t.device_id = d.device_id
JOIN stores s ON d.store_id = s.store_id
)

select * from store_transactions
  );
[0m17:16:26.193836 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "."
LINE 19:     d.device_type
              ^

[0m17:16:26.194263 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: ROLLBACK
[0m17:16:26.194977 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_view (execute): 17:16:26.140070 => 17:16:26.194739
[0m17:16:26.195592 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: Close
[0m17:16:26.200276 [debug] [Thread-1 (]: Database Error in model store_transaction_view (models/store_transaction_view.sql)
  syntax error at or near "."
  LINE 19:     d.device_type
                ^
  compiled Code at target/run/sumup/models/store_transaction_view.sql
[0m17:16:26.200873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22426a7-a40f-489b-893a-14ed3952d9ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c73a850>]}
[0m17:16:26.201539 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_merve.store_transaction_view .......... [[31mERROR[0m in 0.07s]
[0m17:16:26.202248 [debug] [Thread-1 (]: Finished running node model.sumup.store_transaction_view
[0m17:16:26.204387 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:26.204773 [debug] [MainThread]: On master: BEGIN
[0m17:16:26.205098 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:16:26.211110 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:16:26.211545 [debug] [MainThread]: On master: COMMIT
[0m17:16:26.211914 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:26.212270 [debug] [MainThread]: On master: COMMIT
[0m17:16:26.212850 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:16:26.213239 [debug] [MainThread]: On master: Close
[0m17:16:26.214127 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:26.214524 [debug] [MainThread]: Connection 'model.sumup.store_transaction_view' was properly closed.
[0m17:16:26.214974 [info ] [MainThread]: 
[0m17:16:26.215613 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m17:16:26.216858 [debug] [MainThread]: Command end result
[0m17:16:26.226426 [info ] [MainThread]: 
[0m17:16:26.226980 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:16:26.227398 [info ] [MainThread]: 
[0m17:16:26.227815 [error] [MainThread]: [33mDatabase Error in model store_transaction_view (models/store_transaction_view.sql)[0m
[0m17:16:26.228231 [error] [MainThread]:   syntax error at or near "."
[0m17:16:26.228691 [error] [MainThread]:   LINE 19:     d.device_type
[0m17:16:26.231819 [error] [MainThread]:                 ^
[0m17:16:26.232341 [error] [MainThread]:   compiled Code at target/run/sumup/models/store_transaction_view.sql
[0m17:16:26.232758 [info ] [MainThread]: 
[0m17:16:26.233226 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:16:26.234486 [debug] [MainThread]: Command `dbt run` failed at 17:16:26.234209 after 0.51 seconds
[0m17:16:26.235412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7144d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3dbc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7f78d0>]}
[0m17:16:26.236385 [debug] [MainThread]: Flushing usage events
[0m17:16:47.598774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108daddd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109370690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109370cd0>]}


============================== 17:16:47.605156 | 49e1bc9f-a156-4d5a-a290-2ba745ea5c53 ==============================
[0m17:16:47.605156 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:16:47.606171 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'version_check': 'True', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m store_transaction_view', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:16:47.707607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49e1bc9f-a156-4d5a-a290-2ba745ea5c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109366f90>]}
[0m17:16:47.716519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49e1bc9f-a156-4d5a-a290-2ba745ea5c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109630490>]}
[0m17:16:47.717237 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:16:47.738623 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:16:47.780680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:16:47.781726 [debug] [MainThread]: Partial parsing: updated file: sumup://models/store_transaction_view.sql
[0m17:16:47.821283 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.my_project.product_agg
- models.my_project
- models.my_project.store_transaction_first
- models.my_project.store_transaction_view
[0m17:16:47.826897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49e1bc9f-a156-4d5a-a290-2ba745ea5c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10970da90>]}
[0m17:16:47.852038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49e1bc9f-a156-4d5a-a290-2ba745ea5c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc1bd0>]}
[0m17:16:47.853194 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:16:47.854142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49e1bc9f-a156-4d5a-a290-2ba745ea5c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d8df10>]}
[0m17:16:47.858116 [info ] [MainThread]: 
[0m17:16:47.861285 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:16:47.868015 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m17:16:47.886057 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m17:16:47.887070 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m17:16:47.888150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:47.927525 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:16:47.929611 [debug] [ThreadPool]: On list_merveyasa: Close
[0m17:16:47.932129 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m17:16:47.939830 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:16:47.940311 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m17:16:47.940696 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:47.947580 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:16:47.948050 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:16:47.948492 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m17:16:47.952778 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m17:16:47.954320 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m17:16:47.954848 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m17:16:47.960330 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:47.960754 [debug] [MainThread]: On master: BEGIN
[0m17:16:47.961094 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:16:47.966920 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:16:47.967351 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:47.967824 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:16:47.981845 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m17:16:47.983164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49e1bc9f-a156-4d5a-a290-2ba745ea5c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090de310>]}
[0m17:16:47.983636 [debug] [MainThread]: On master: ROLLBACK
[0m17:16:47.984226 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:47.984569 [debug] [MainThread]: On master: BEGIN
[0m17:16:47.985177 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:16:47.985531 [debug] [MainThread]: On master: COMMIT
[0m17:16:47.985858 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:47.986169 [debug] [MainThread]: On master: COMMIT
[0m17:16:47.986661 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:16:47.987012 [debug] [MainThread]: On master: Close
[0m17:16:47.987781 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:16:47.988190 [info ] [MainThread]: 
[0m17:16:47.990589 [debug] [Thread-1 (]: Began running node model.sumup.store_transaction_view
[0m17:16:47.991224 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.store_transaction_view ................... [RUN]
[0m17:16:47.992018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.store_transaction_view)
[0m17:16:47.992434 [debug] [Thread-1 (]: Began compiling node model.sumup.store_transaction_view
[0m17:16:48.000752 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.store_transaction_view"
[0m17:16:48.001998 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_view (compile): 17:16:47.992714 => 17:16:48.001661
[0m17:16:48.003187 [debug] [Thread-1 (]: Began executing node model.sumup.store_transaction_view
[0m17:16:48.056617 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.store_transaction_view"
[0m17:16:48.057654 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:16:48.058163 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: BEGIN
[0m17:16:48.058603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:48.065537 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:16:48.066057 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:16:48.066522 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */

  create view "merveyasa"."dbt_merve"."store_transaction_view__dbt_tmp"
    
    
  as (
    WITH store_transactions AS
(
SELECT
    s.store_id,
    s.store_typology,
    s.store_country,
    t.product_name,
    t.product_sku,
    t.category_name,
    t.transaction_amount,
    t.transaction_status,
    t.transaction_happened_at,
    d.device_type
FROM
    transactions t
JOIN devices d ON t.device_id = d.device_id
JOIN stores s ON d.store_id = s.store_id
)

select * from store_transactions
  );
[0m17:16:48.070722 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:16:48.077350 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:16:48.077831 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */
alter table "merveyasa"."dbt_merve"."store_transaction_view" rename to "store_transaction_view__dbt_backup"
[0m17:16:48.078749 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:16:48.082210 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:16:48.082675 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */
alter table "merveyasa"."dbt_merve"."store_transaction_view__dbt_tmp" rename to "store_transaction_view"
[0m17:16:48.083519 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:16:48.101636 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: COMMIT
[0m17:16:48.102128 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:16:48.102496 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: COMMIT
[0m17:16:48.103982 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:16:48.113196 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:16:48.113650 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */
drop view if exists "merveyasa"."dbt_merve"."store_transaction_view__dbt_backup" cascade
[0m17:16:48.136244 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:16:48.139980 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_view (execute): 17:16:48.003819 => 17:16:48.139464
[0m17:16:48.140800 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: Close
[0m17:16:48.142316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49e1bc9f-a156-4d5a-a290-2ba745ea5c53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10938cf50>]}
[0m17:16:48.143435 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_merve.store_transaction_view .............. [[32mCREATE VIEW[0m in 0.15s]
[0m17:16:48.144329 [debug] [Thread-1 (]: Finished running node model.sumup.store_transaction_view
[0m17:16:48.146491 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:48.146873 [debug] [MainThread]: On master: BEGIN
[0m17:16:48.147190 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:16:48.153197 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:16:48.153626 [debug] [MainThread]: On master: COMMIT
[0m17:16:48.154313 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:48.154724 [debug] [MainThread]: On master: COMMIT
[0m17:16:48.155435 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:16:48.155863 [debug] [MainThread]: On master: Close
[0m17:16:48.156793 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:48.157629 [debug] [MainThread]: Connection 'model.sumup.store_transaction_view' was properly closed.
[0m17:16:48.158544 [info ] [MainThread]: 
[0m17:16:48.159278 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m17:16:48.160395 [debug] [MainThread]: Command end result
[0m17:16:48.172345 [info ] [MainThread]: 
[0m17:16:48.173035 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:48.173473 [info ] [MainThread]: 
[0m17:16:48.173920 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:16:48.174656 [debug] [MainThread]: Command `dbt run` succeeded at 17:16:48.174535 after 0.60 seconds
[0m17:16:48.175059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090883d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046a3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e579d0>]}
[0m17:16:48.175442 [debug] [MainThread]: Flushing usage events
[0m17:16:57.385091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7f6750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dac1dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddb8b90>]}


============================== 17:16:57.390551 | ec9b1141-86ab-4455-a60e-30cf0b871f50 ==============================
[0m17:16:57.390551 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:16:57.391241 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'debug': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m store_transaction_first', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:16:57.481326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec9b1141-86ab-4455-a60e-30cf0b871f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10daa6f90>]}
[0m17:16:57.490241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec9b1141-86ab-4455-a60e-30cf0b871f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db9a450>]}
[0m17:16:57.490941 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:16:57.519808 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:16:57.552690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:16:57.553165 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:16:57.553958 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.my_project
- models.my_project.product_agg
- models.my_project.store_transaction_view
- models.my_project.store_transaction_first
[0m17:16:57.561138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec9b1141-86ab-4455-a60e-30cf0b871f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dda7750>]}
[0m17:16:57.572815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec9b1141-86ab-4455-a60e-30cf0b871f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0d35d0>]}
[0m17:16:57.573355 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:16:57.573830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec9b1141-86ab-4455-a60e-30cf0b871f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7ae390>]}
[0m17:16:57.575384 [info ] [MainThread]: 
[0m17:16:57.576275 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:16:57.577445 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m17:16:57.592384 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m17:16:57.592897 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m17:16:57.593279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:57.622060 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:16:57.624097 [debug] [ThreadPool]: On list_merveyasa: Close
[0m17:16:57.626197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m17:16:57.636509 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:16:57.637020 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m17:16:57.637404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:57.646748 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:16:57.647635 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:16:57.648294 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m17:16:57.654121 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m17:16:57.655920 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m17:16:57.656598 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m17:16:57.664702 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:57.665356 [debug] [MainThread]: On master: BEGIN
[0m17:16:57.665780 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:16:57.675252 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:16:57.675762 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:57.676293 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:16:57.696105 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m17:16:57.697694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec9b1141-86ab-4455-a60e-30cf0b871f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0f3ed0>]}
[0m17:16:57.698584 [debug] [MainThread]: On master: ROLLBACK
[0m17:16:57.699435 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:57.699866 [debug] [MainThread]: On master: BEGIN
[0m17:16:57.700504 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:16:57.700911 [debug] [MainThread]: On master: COMMIT
[0m17:16:57.701294 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:57.701666 [debug] [MainThread]: On master: COMMIT
[0m17:16:57.702430 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:16:57.703094 [debug] [MainThread]: On master: Close
[0m17:16:57.704411 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:16:57.705144 [info ] [MainThread]: 
[0m17:16:57.708114 [debug] [Thread-1 (]: Began running node model.sumup.store_transaction_first
[0m17:16:57.708751 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.store_transaction_first .................. [RUN]
[0m17:16:57.709954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.store_transaction_first)
[0m17:16:57.710459 [debug] [Thread-1 (]: Began compiling node model.sumup.store_transaction_first
[0m17:16:57.718762 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.store_transaction_first"
[0m17:16:57.721052 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_first (compile): 17:16:57.710842 => 17:16:57.720325
[0m17:16:57.721626 [debug] [Thread-1 (]: Began executing node model.sumup.store_transaction_first
[0m17:16:57.770442 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.store_transaction_first"
[0m17:16:57.771379 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m17:16:57.771804 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: BEGIN
[0m17:16:57.772187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:57.778620 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:16:57.779107 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m17:16:57.779544 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_first"} */

  create view "merveyasa"."dbt_merve"."store_transaction_first__dbt_tmp"
    
    
  as (
    WITH store_first_five_transactions AS
(
SELECT
    store_id,
    AVG(time_diff) AS avg_time_diff
FROM (
    SELECT
        store_id,
        transaction_happened_at - LAG(transaction_happened_at, 1) OVER (PARTITION BY store_id ORDER BY transaction_happened_at) AS time_diff,
        ROW_NUMBER() OVER (PARTITION BY store_id ORDER BY transaction_happened_at) AS rn
    FROM
        store_transactions
) subquery
WHERE
    rn <= 5
GROUP BY
    store_id
)

SELECT * FROM store_first_five_transactions
  );
[0m17:16:57.789371 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "store_transactions" does not exist
LINE 18:         store_transactions
                 ^

[0m17:16:57.790133 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: ROLLBACK
[0m17:16:57.791288 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_first (execute): 17:16:57.721955 => 17:16:57.790915
[0m17:16:57.791924 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: Close
[0m17:16:57.797027 [debug] [Thread-1 (]: Database Error in model store_transaction_first (models/store_transaction_first.sql)
  relation "store_transactions" does not exist
  LINE 18:         store_transactions
                   ^
  compiled Code at target/run/sumup/models/store_transaction_first.sql
[0m17:16:57.797642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec9b1141-86ab-4455-a60e-30cf0b871f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0a3190>]}
[0m17:16:57.798359 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_merve.store_transaction_first ......... [[31mERROR[0m in 0.09s]
[0m17:16:57.799234 [debug] [Thread-1 (]: Finished running node model.sumup.store_transaction_first
[0m17:16:57.801527 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:57.801950 [debug] [MainThread]: On master: BEGIN
[0m17:16:57.802308 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:16:57.808721 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:16:57.809207 [debug] [MainThread]: On master: COMMIT
[0m17:16:57.809656 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:57.812581 [debug] [MainThread]: On master: COMMIT
[0m17:16:57.815813 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:16:57.816477 [debug] [MainThread]: On master: Close
[0m17:16:57.819726 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:57.820194 [debug] [MainThread]: Connection 'model.sumup.store_transaction_first' was properly closed.
[0m17:16:57.820640 [info ] [MainThread]: 
[0m17:16:57.821221 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m17:16:57.822701 [debug] [MainThread]: Command end result
[0m17:16:57.836589 [info ] [MainThread]: 
[0m17:16:57.837415 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:16:57.837980 [info ] [MainThread]: 
[0m17:16:57.838534 [error] [MainThread]: [33mDatabase Error in model store_transaction_first (models/store_transaction_first.sql)[0m
[0m17:16:57.839133 [error] [MainThread]:   relation "store_transactions" does not exist
[0m17:16:57.839768 [error] [MainThread]:   LINE 18:         store_transactions
[0m17:16:57.840308 [error] [MainThread]:                    ^
[0m17:16:57.840804 [error] [MainThread]:   compiled Code at target/run/sumup/models/store_transaction_first.sql
[0m17:16:57.841342 [info ] [MainThread]: 
[0m17:16:57.842260 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:16:57.843407 [debug] [MainThread]: Command `dbt run` failed at 17:16:57.843238 after 0.48 seconds
[0m17:16:57.844192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dac2a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dac06d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dac0a10>]}
[0m17:16:57.844774 [debug] [MainThread]: Flushing usage events
[0m17:17:16.796211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121c0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127a0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127a0b50>]}


============================== 17:17:16.801891 | 679bc3b9-1bb0-4b42-af29-26038044c52e ==============================
[0m17:17:16.801891 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:17:16.803291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'debug': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m store_transaction_view', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:17:16.898610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '679bc3b9-1bb0-4b42-af29-26038044c52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11244bf10>]}
[0m17:17:16.908153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '679bc3b9-1bb0-4b42-af29-26038044c52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11278f510>]}
[0m17:17:16.908926 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:17:16.935628 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:17:16.971093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:17:16.971889 [debug] [MainThread]: Partial parsing: updated file: sumup://models/store_transaction_first.sql
[0m17:17:17.010134 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.my_project
- models.my_project.product_agg
- models.my_project.store_transaction_first
- models.my_project.store_transaction_view
[0m17:17:17.016412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '679bc3b9-1bb0-4b42-af29-26038044c52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b71d90>]}
[0m17:17:17.034651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '679bc3b9-1bb0-4b42-af29-26038044c52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bf4c50>]}
[0m17:17:17.035514 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:17:17.036370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '679bc3b9-1bb0-4b42-af29-26038044c52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f449e10>]}
[0m17:17:17.038960 [info ] [MainThread]: 
[0m17:17:17.040610 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:17:17.042829 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m17:17:17.066727 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m17:17:17.067492 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m17:17:17.068544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:17.119384 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:17:17.121590 [debug] [ThreadPool]: On list_merveyasa: Close
[0m17:17:17.123847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m17:17:17.131923 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:17:17.132409 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m17:17:17.132801 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:17.139701 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:17:17.140289 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:17:17.140898 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m17:17:17.145517 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m17:17:17.147089 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m17:17:17.147636 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m17:17:17.154624 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:17.155220 [debug] [MainThread]: On master: BEGIN
[0m17:17:17.155621 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:17:17.162268 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:17:17.162908 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:17.163457 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:17:17.179753 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m17:17:17.181382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '679bc3b9-1bb0-4b42-af29-26038044c52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c1a050>]}
[0m17:17:17.181922 [debug] [MainThread]: On master: ROLLBACK
[0m17:17:17.182434 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:17.182789 [debug] [MainThread]: On master: BEGIN
[0m17:17:17.183369 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:17:17.183746 [debug] [MainThread]: On master: COMMIT
[0m17:17:17.184094 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:17.184427 [debug] [MainThread]: On master: COMMIT
[0m17:17:17.184868 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:17:17.185227 [debug] [MainThread]: On master: Close
[0m17:17:17.186040 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:17:17.186616 [info ] [MainThread]: 
[0m17:17:17.188953 [debug] [Thread-1 (]: Began running node model.sumup.store_transaction_view
[0m17:17:17.189546 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.store_transaction_view ................... [RUN]
[0m17:17:17.190323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.store_transaction_view)
[0m17:17:17.190765 [debug] [Thread-1 (]: Began compiling node model.sumup.store_transaction_view
[0m17:17:17.199539 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.store_transaction_view"
[0m17:17:17.200654 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_view (compile): 17:17:17.191060 => 17:17:17.200275
[0m17:17:17.201213 [debug] [Thread-1 (]: Began executing node model.sumup.store_transaction_view
[0m17:17:17.253504 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.store_transaction_view"
[0m17:17:17.254458 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:17:17.254893 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: BEGIN
[0m17:17:17.255287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:17.261667 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:17:17.262163 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:17:17.262610 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */

  create view "merveyasa"."dbt_merve"."store_transaction_view__dbt_tmp"
    
    
  as (
    WITH store_transactions AS
(
SELECT
    s.store_id,
    s.store_typology,
    s.store_country,
    t.product_name,
    t.product_sku,
    t.category_name,
    t.transaction_amount,
    t.transaction_status,
    t.transaction_happened_at,
    d.device_type
FROM
    transactions t
JOIN devices d ON t.device_id = d.device_id
JOIN stores s ON d.store_id = s.store_id
)

select * from store_transactions
  );
[0m17:17:17.268572 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:17:17.275718 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:17:17.276282 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */
alter table "merveyasa"."dbt_merve"."store_transaction_view" rename to "store_transaction_view__dbt_backup"
[0m17:17:17.277378 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:17:17.281476 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:17:17.281985 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */
alter table "merveyasa"."dbt_merve"."store_transaction_view__dbt_tmp" rename to "store_transaction_view"
[0m17:17:17.282928 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:17:17.302824 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: COMMIT
[0m17:17:17.303326 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:17:17.303772 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: COMMIT
[0m17:17:17.305255 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:17:17.314799 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:17:17.315310 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */
drop view if exists "merveyasa"."dbt_merve"."store_transaction_view__dbt_backup" cascade
[0m17:17:17.317144 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:17:17.319070 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_view (execute): 17:17:17.201644 => 17:17:17.318799
[0m17:17:17.319616 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: Close
[0m17:17:17.320829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '679bc3b9-1bb0-4b42-af29-26038044c52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127a0b10>]}
[0m17:17:17.321862 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_merve.store_transaction_view .............. [[32mCREATE VIEW[0m in 0.13s]
[0m17:17:17.322736 [debug] [Thread-1 (]: Finished running node model.sumup.store_transaction_view
[0m17:17:17.325182 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:17.325647 [debug] [MainThread]: On master: BEGIN
[0m17:17:17.326039 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:17:17.340479 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:17:17.341283 [debug] [MainThread]: On master: COMMIT
[0m17:17:17.341992 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:17.342662 [debug] [MainThread]: On master: COMMIT
[0m17:17:17.349420 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:17:17.350525 [debug] [MainThread]: On master: Close
[0m17:17:17.352743 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:17.353347 [debug] [MainThread]: Connection 'model.sumup.store_transaction_view' was properly closed.
[0m17:17:17.353891 [info ] [MainThread]: 
[0m17:17:17.354634 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m17:17:17.355925 [debug] [MainThread]: Command end result
[0m17:17:17.371762 [info ] [MainThread]: 
[0m17:17:17.372919 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:17:17.373926 [info ] [MainThread]: 
[0m17:17:17.374943 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:17:17.376316 [debug] [MainThread]: Command `dbt run` succeeded at 17:17:17.376076 after 0.60 seconds
[0m17:17:17.378610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da55590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112275710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10daebad0>]}
[0m17:17:17.383981 [debug] [MainThread]: Flushing usage events
[0m17:17:24.857003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11497eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114966990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11497fc90>]}


============================== 17:17:24.862876 | 19567225-5991-4e0c-b76d-d31757bab8b8 ==============================
[0m17:17:24.862876 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:17:24.863725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m store_transaction_first', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:17:24.954770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19567225-5991-4e0c-b76d-d31757bab8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a25690>]}
[0m17:17:24.963773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19567225-5991-4e0c-b76d-d31757bab8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1151d0910>]}
[0m17:17:24.964471 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:17:24.984791 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:17:25.028627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:17:25.029597 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:17:25.030689 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.my_project.store_transaction_view
- models.my_project.store_transaction_first
- models.my_project.product_agg
- models.my_project
[0m17:17:25.038095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19567225-5991-4e0c-b76d-d31757bab8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143eba90>]}
[0m17:17:25.052213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19567225-5991-4e0c-b76d-d31757bab8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11523b850>]}
[0m17:17:25.053279 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:17:25.054038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19567225-5991-4e0c-b76d-d31757bab8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bce590>]}
[0m17:17:25.056101 [info ] [MainThread]: 
[0m17:17:25.057512 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:17:25.059649 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m17:17:25.082003 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m17:17:25.082574 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m17:17:25.083000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:25.111639 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:17:25.114400 [debug] [ThreadPool]: On list_merveyasa: Close
[0m17:17:25.116724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m17:17:25.124403 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:17:25.124860 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m17:17:25.125256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:25.131965 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:17:25.132479 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:17:25.132968 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m17:17:25.137407 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m17:17:25.139180 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m17:17:25.139790 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m17:17:25.145591 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:25.146029 [debug] [MainThread]: On master: BEGIN
[0m17:17:25.146381 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:17:25.152576 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:17:25.153001 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:25.153459 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:17:25.167900 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m17:17:25.169259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19567225-5991-4e0c-b76d-d31757bab8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152c5810>]}
[0m17:17:25.169736 [debug] [MainThread]: On master: ROLLBACK
[0m17:17:25.170322 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:25.170665 [debug] [MainThread]: On master: BEGIN
[0m17:17:25.171224 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:17:25.171591 [debug] [MainThread]: On master: COMMIT
[0m17:17:25.171928 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:25.172249 [debug] [MainThread]: On master: COMMIT
[0m17:17:25.172673 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:17:25.173027 [debug] [MainThread]: On master: Close
[0m17:17:25.173819 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:17:25.174360 [info ] [MainThread]: 
[0m17:17:25.176620 [debug] [Thread-1 (]: Began running node model.sumup.store_transaction_first
[0m17:17:25.177177 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.store_transaction_first .................. [RUN]
[0m17:17:25.178220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.store_transaction_first)
[0m17:17:25.178662 [debug] [Thread-1 (]: Began compiling node model.sumup.store_transaction_first
[0m17:17:25.186225 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.store_transaction_first"
[0m17:17:25.187884 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_first (compile): 17:17:25.178951 => 17:17:25.187403
[0m17:17:25.188505 [debug] [Thread-1 (]: Began executing node model.sumup.store_transaction_first
[0m17:17:25.231937 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.store_transaction_first"
[0m17:17:25.232889 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m17:17:25.233314 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: BEGIN
[0m17:17:25.233696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:25.239926 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:17:25.240401 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m17:17:25.240834 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_first"} */

  create view "merveyasa"."dbt_merve"."store_transaction_first__dbt_tmp"
    
    
  as (
    WITH store_first_five_transactions AS
(
SELECT
    store_id,
    AVG(time_diff) AS avg_time_diff
FROM (
    SELECT
        store_id,
        transaction_happened_at - LAG(transaction_happened_at, 1) OVER (PARTITION BY store_id ORDER BY transaction_happened_at) AS time_diff,
        ROW_NUMBER() OVER (PARTITION BY store_id ORDER BY transaction_happened_at) AS rn
    FROM
        store_transaction_first
) subquery
WHERE
    rn <= 5
GROUP BY
    store_id
)

SELECT * FROM store_first_five_transactions
  );
[0m17:17:25.241790 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "store_transaction_first" does not exist
LINE 18:         store_transaction_first
                 ^

[0m17:17:25.242223 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: ROLLBACK
[0m17:17:25.242949 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_first (execute): 17:17:25.189097 => 17:17:25.242706
[0m17:17:25.243371 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: Close
[0m17:17:25.248116 [debug] [Thread-1 (]: Database Error in model store_transaction_first (models/store_transaction_first.sql)
  relation "store_transaction_first" does not exist
  LINE 18:         store_transaction_first
                   ^
  compiled Code at target/run/sumup/models/store_transaction_first.sql
[0m17:17:25.248885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19567225-5991-4e0c-b76d-d31757bab8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11497d850>]}
[0m17:17:25.249589 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_merve.store_transaction_first ......... [[31mERROR[0m in 0.07s]
[0m17:17:25.250489 [debug] [Thread-1 (]: Finished running node model.sumup.store_transaction_first
[0m17:17:25.252658 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:25.253050 [debug] [MainThread]: On master: BEGIN
[0m17:17:25.253383 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:17:25.259424 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:17:25.259850 [debug] [MainThread]: On master: COMMIT
[0m17:17:25.260192 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:25.260520 [debug] [MainThread]: On master: COMMIT
[0m17:17:25.261104 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:17:25.261527 [debug] [MainThread]: On master: Close
[0m17:17:25.262630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:25.263352 [debug] [MainThread]: Connection 'model.sumup.store_transaction_first' was properly closed.
[0m17:17:25.264106 [info ] [MainThread]: 
[0m17:17:25.264567 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m17:17:25.265321 [debug] [MainThread]: Command end result
[0m17:17:25.275761 [info ] [MainThread]: 
[0m17:17:25.276316 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:17:25.276743 [info ] [MainThread]: 
[0m17:17:25.277177 [error] [MainThread]: [33mDatabase Error in model store_transaction_first (models/store_transaction_first.sql)[0m
[0m17:17:25.277619 [error] [MainThread]:   relation "store_transaction_first" does not exist
[0m17:17:25.278019 [error] [MainThread]:   LINE 18:         store_transaction_first
[0m17:17:25.278635 [error] [MainThread]:                    ^
[0m17:17:25.279040 [error] [MainThread]:   compiled Code at target/run/sumup/models/store_transaction_first.sql
[0m17:17:25.279432 [info ] [MainThread]: 
[0m17:17:25.279882 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:17:25.280664 [debug] [MainThread]: Command `dbt run` failed at 17:17:25.280520 after 0.45 seconds
[0m17:17:25.281175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114efec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110324cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110324c90>]}
[0m17:17:25.281653 [debug] [MainThread]: Flushing usage events
[0m17:17:41.030515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110327890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd8e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110041150>]}


============================== 17:17:41.036855 | 0c338562-7715-4f6c-ac90-cfc1abdc72da ==============================
[0m17:17:41.036855 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:17:41.037819 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m store_transaction_first', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:17:41.140829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c338562-7715-4f6c-ac90-cfc1abdc72da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd77d10>]}
[0m17:17:41.150136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c338562-7715-4f6c-ac90-cfc1abdc72da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110041290>]}
[0m17:17:41.150863 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:17:41.178200 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:17:41.217382 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:17:41.218220 [debug] [MainThread]: Partial parsing: updated file: sumup://models/store_transaction_first.sql
[0m17:17:41.256855 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.my_project.store_transaction_first
- models.my_project.store_transaction_view
- models.my_project.product_agg
- models.my_project
[0m17:17:41.263181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c338562-7715-4f6c-ac90-cfc1abdc72da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110119e50>]}
[0m17:17:41.280198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c338562-7715-4f6c-ac90-cfc1abdc72da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110798d10>]}
[0m17:17:41.281525 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:17:41.282237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c338562-7715-4f6c-ac90-cfc1abdc72da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110768f10>]}
[0m17:17:41.285232 [info ] [MainThread]: 
[0m17:17:41.286404 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:17:41.287826 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m17:17:41.305722 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m17:17:41.306579 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m17:17:41.307069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:41.347024 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:17:41.350382 [debug] [ThreadPool]: On list_merveyasa: Close
[0m17:17:41.353076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m17:17:41.360769 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:17:41.361295 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m17:17:41.361683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:41.368647 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:17:41.369225 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:17:41.369658 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m17:17:41.374083 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m17:17:41.375685 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m17:17:41.376227 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m17:17:41.382076 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:41.382523 [debug] [MainThread]: On master: BEGIN
[0m17:17:41.382872 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:17:41.389105 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:17:41.389542 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:41.390017 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:17:41.405240 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m17:17:41.406606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c338562-7715-4f6c-ac90-cfc1abdc72da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110638350>]}
[0m17:17:41.407096 [debug] [MainThread]: On master: ROLLBACK
[0m17:17:41.407570 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:41.407908 [debug] [MainThread]: On master: BEGIN
[0m17:17:41.408455 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:17:41.408808 [debug] [MainThread]: On master: COMMIT
[0m17:17:41.409143 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:41.409462 [debug] [MainThread]: On master: COMMIT
[0m17:17:41.409883 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:17:41.410226 [debug] [MainThread]: On master: Close
[0m17:17:41.411084 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:17:41.411503 [info ] [MainThread]: 
[0m17:17:41.413674 [debug] [Thread-1 (]: Began running node model.sumup.store_transaction_first
[0m17:17:41.414266 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.store_transaction_first .................. [RUN]
[0m17:17:41.415046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.store_transaction_first)
[0m17:17:41.415488 [debug] [Thread-1 (]: Began compiling node model.sumup.store_transaction_first
[0m17:17:41.423355 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.store_transaction_first"
[0m17:17:41.424320 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_first (compile): 17:17:41.415785 => 17:17:41.424054
[0m17:17:41.424752 [debug] [Thread-1 (]: Began executing node model.sumup.store_transaction_first
[0m17:17:41.470713 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.store_transaction_first"
[0m17:17:41.471677 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m17:17:41.472140 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: BEGIN
[0m17:17:41.472546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:41.478731 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:17:41.479214 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m17:17:41.479658 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_first"} */

  create view "merveyasa"."dbt_merve"."store_transaction_first__dbt_tmp"
    
    
  as (
    WITH store_first_five_transactions AS
(
SELECT
    store_id,
    AVG(time_diff) AS avg_time_diff
FROM (
    SELECT
        store_id,
        transaction_happened_at - LAG(transaction_happened_at, 1) OVER (PARTITION BY store_id ORDER BY transaction_happened_at) AS time_diff,
        ROW_NUMBER() OVER (PARTITION BY store_id ORDER BY transaction_happened_at) AS rn
    FROM
        store_transaction_view
) subquery
WHERE
    rn <= 5
GROUP BY
    store_id
)

SELECT * FROM store_first_five_transactions
  );
[0m17:17:41.480996 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "store_transaction_view" does not exist
LINE 18:         store_transaction_view
                 ^

[0m17:17:41.481682 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: ROLLBACK
[0m17:17:41.482594 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_first (execute): 17:17:41.425036 => 17:17:41.482328
[0m17:17:41.483068 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: Close
[0m17:17:41.488038 [debug] [Thread-1 (]: Database Error in model store_transaction_first (models/store_transaction_first.sql)
  relation "store_transaction_view" does not exist
  LINE 18:         store_transaction_view
                   ^
  compiled Code at target/run/sumup/models/store_transaction_first.sql
[0m17:17:41.488654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c338562-7715-4f6c-ac90-cfc1abdc72da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106d7f50>]}
[0m17:17:41.489332 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_merve.store_transaction_first ......... [[31mERROR[0m in 0.07s]
[0m17:17:41.490066 [debug] [Thread-1 (]: Finished running node model.sumup.store_transaction_first
[0m17:17:41.492219 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:41.492731 [debug] [MainThread]: On master: BEGIN
[0m17:17:41.493318 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:17:41.500897 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:17:41.501586 [debug] [MainThread]: On master: COMMIT
[0m17:17:41.502490 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:41.503186 [debug] [MainThread]: On master: COMMIT
[0m17:17:41.504158 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:17:41.505043 [debug] [MainThread]: On master: Close
[0m17:17:41.505987 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:41.506515 [debug] [MainThread]: Connection 'model.sumup.store_transaction_first' was properly closed.
[0m17:17:41.506955 [info ] [MainThread]: 
[0m17:17:41.507400 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m17:17:41.508227 [debug] [MainThread]: Command end result
[0m17:17:41.518355 [info ] [MainThread]: 
[0m17:17:41.519008 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:17:41.519597 [info ] [MainThread]: 
[0m17:17:41.520391 [error] [MainThread]: [33mDatabase Error in model store_transaction_first (models/store_transaction_first.sql)[0m
[0m17:17:41.520875 [error] [MainThread]:   relation "store_transaction_view" does not exist
[0m17:17:41.521320 [error] [MainThread]:   LINE 18:         store_transaction_view
[0m17:17:41.521736 [error] [MainThread]:                    ^
[0m17:17:41.522156 [error] [MainThread]:   compiled Code at target/run/sumup/models/store_transaction_first.sql
[0m17:17:41.522572 [info ] [MainThread]: 
[0m17:17:41.523164 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:17:41.523997 [debug] [MainThread]: Command `dbt run` failed at 17:17:41.523849 after 0.52 seconds
[0m17:17:41.524502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe0c390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd51310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd50d90>]}
[0m17:17:41.524979 [debug] [MainThread]: Flushing usage events
[0m17:18:29.944805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee6a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10918f690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109461450>]}


============================== 17:18:29.950382 | 104eee47-c1ab-405d-8326-00291c11f513 ==============================
[0m17:18:29.950382 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:18:29.951249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m store_transaction_first', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:18:30.148327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '104eee47-c1ab-405d-8326-00291c11f513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109460f90>]}
[0m17:18:30.160604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '104eee47-c1ab-405d-8326-00291c11f513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094c1010>]}
[0m17:18:30.161312 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:18:30.190989 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:18:30.222420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:18:30.223243 [debug] [MainThread]: Partial parsing: updated file: sumup://models/store_transaction_first.sql
[0m17:18:30.255903 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.my_project.product_agg
- models.my_project
- models.my_project.store_transaction_view
- models.my_project.store_transaction_first
[0m17:18:30.261257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '104eee47-c1ab-405d-8326-00291c11f513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ada190>]}
[0m17:18:30.274900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '104eee47-c1ab-405d-8326-00291c11f513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b9ad10>]}
[0m17:18:30.275541 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:18:30.276178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '104eee47-c1ab-405d-8326-00291c11f513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a8b4d0>]}
[0m17:18:30.277832 [info ] [MainThread]: 
[0m17:18:30.278786 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:18:30.282799 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m17:18:30.299193 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m17:18:30.299964 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m17:18:30.300966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:30.342182 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:18:30.345423 [debug] [ThreadPool]: On list_merveyasa: Close
[0m17:18:30.349825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m17:18:30.361175 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:18:30.361720 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m17:18:30.362124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:30.370184 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:18:30.370971 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:18:30.371884 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m17:18:30.376438 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m17:18:30.378053 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m17:18:30.378647 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m17:18:30.385183 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:30.385646 [debug] [MainThread]: On master: BEGIN
[0m17:18:30.385995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:18:30.392333 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:18:30.392775 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:30.393248 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:18:30.407792 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m17:18:30.409158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '104eee47-c1ab-405d-8326-00291c11f513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bdf050>]}
[0m17:18:30.409645 [debug] [MainThread]: On master: ROLLBACK
[0m17:18:30.410125 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:30.410464 [debug] [MainThread]: On master: BEGIN
[0m17:18:30.410988 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:18:30.411332 [debug] [MainThread]: On master: COMMIT
[0m17:18:30.411663 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:30.411981 [debug] [MainThread]: On master: COMMIT
[0m17:18:30.412397 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:18:30.412740 [debug] [MainThread]: On master: Close
[0m17:18:30.413547 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:18:30.413985 [info ] [MainThread]: 
[0m17:18:30.416211 [debug] [Thread-1 (]: Began running node model.sumup.store_transaction_first
[0m17:18:30.416797 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.store_transaction_first .................. [RUN]
[0m17:18:30.417574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.store_transaction_first)
[0m17:18:30.418099 [debug] [Thread-1 (]: Began compiling node model.sumup.store_transaction_first
[0m17:18:30.427637 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.store_transaction_first"
[0m17:18:30.429133 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_first (compile): 17:18:30.418436 => 17:18:30.428545
[0m17:18:30.430013 [debug] [Thread-1 (]: Began executing node model.sumup.store_transaction_first
[0m17:18:30.481788 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.store_transaction_first"
[0m17:18:30.483034 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m17:18:30.483520 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: BEGIN
[0m17:18:30.484072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:30.491449 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:18:30.491985 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m17:18:30.492485 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_first"} */

  create view "merveyasa"."dbt_merve"."store_transaction_first__dbt_tmp"
    
    
  as (
    WITH store_first_five_transactions AS
(
SELECT
    store_id,
    AVG(time_diff) AS avg_time_diff
FROM (
    SELECT
        store_id,
        transaction_happened_at - LAG(transaction_happened_at, 1) OVER (PARTITION BY store_id ORDER BY transaction_happened_at) AS time_diff,
        ROW_NUMBER() OVER (PARTITION BY store_id ORDER BY transaction_happened_at) AS rn
    FROM
        merveyasa.dbt_merve.store_transaction_view
) subquery
WHERE
    rn <= 5
GROUP BY
    store_id
)

SELECT * FROM store_first_five_transactions
  );
[0m17:18:30.498928 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:18:30.506560 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m17:18:30.507148 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_first"} */
alter table "merveyasa"."dbt_merve"."store_transaction_first__dbt_tmp" rename to "store_transaction_first"
[0m17:18:30.508097 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:18:30.524318 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: COMMIT
[0m17:18:30.524767 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m17:18:30.525128 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: COMMIT
[0m17:18:30.526290 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:18:30.534531 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m17:18:30.534955 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_first"} */
drop view if exists "merveyasa"."dbt_merve"."store_transaction_first__dbt_backup" cascade
[0m17:18:30.535661 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:18:30.537183 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_first (execute): 17:18:30.430521 => 17:18:30.536972
[0m17:18:30.537582 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: Close
[0m17:18:30.538494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '104eee47-c1ab-405d-8326-00291c11f513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109adac10>]}
[0m17:18:30.539231 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_merve.store_transaction_first ............. [[32mCREATE VIEW[0m in 0.12s]
[0m17:18:30.540019 [debug] [Thread-1 (]: Finished running node model.sumup.store_transaction_first
[0m17:18:30.542291 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:30.542764 [debug] [MainThread]: On master: BEGIN
[0m17:18:30.543113 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:18:30.553389 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:18:30.554894 [debug] [MainThread]: On master: COMMIT
[0m17:18:30.555678 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:30.556473 [debug] [MainThread]: On master: COMMIT
[0m17:18:30.557332 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:18:30.557954 [debug] [MainThread]: On master: Close
[0m17:18:30.559123 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:30.559708 [debug] [MainThread]: Connection 'model.sumup.store_transaction_first' was properly closed.
[0m17:18:30.560152 [info ] [MainThread]: 
[0m17:18:30.560695 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m17:18:30.561921 [debug] [MainThread]: Command end result
[0m17:18:30.574561 [info ] [MainThread]: 
[0m17:18:30.575144 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:18:30.575629 [info ] [MainThread]: 
[0m17:18:30.576058 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:18:30.577104 [debug] [MainThread]: Command `dbt run` succeeded at 17:18:30.576886 after 0.68 seconds
[0m17:18:30.577826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10972bc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aa3bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b54cd0>]}
[0m17:18:30.578322 [debug] [MainThread]: Flushing usage events
[0m12:13:43.588909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eaddd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109199c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10948f750>]}


============================== 12:13:43.599235 | 0ac1e654-db3c-43e0-a68b-7027be9b9768 ==============================
[0m12:13:43.599235 [info ] [MainThread]: Running with dbt=1.6.0
[0m12:13:43.600445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m top_ten_stores', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:13:43.840763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ac1e654-db3c-43e0-a68b-7027be9b9768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f9e8d0>]}
[0m12:13:43.850093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ac1e654-db3c-43e0-a68b-7027be9b9768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f69750>]}
[0m12:13:43.851196 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m12:13:43.884946 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m12:13:43.980483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:13:43.981204 [debug] [MainThread]: Partial parsing: added file: sumup://models/top_ten_stores.sql
[0m12:13:44.022617 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.my_project
- models.my_project.store_transaction_first
- models.my_project.store_transaction_view
- models.my_project.product_agg
[0m12:13:44.029062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ac1e654-db3c-43e0-a68b-7027be9b9768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108947ed0>]}
[0m12:13:44.047731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ac1e654-db3c-43e0-a68b-7027be9b9768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e44b90>]}
[0m12:13:44.048923 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m12:13:44.049620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ac1e654-db3c-43e0-a68b-7027be9b9768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109736150>]}
[0m12:13:44.051671 [info ] [MainThread]: 
[0m12:13:44.052833 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:13:44.054498 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m12:13:44.069709 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m12:13:44.070297 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m12:13:44.070793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:44.182009 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:13:44.184093 [debug] [ThreadPool]: On list_merveyasa: Close
[0m12:13:44.186039 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m12:13:44.192519 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m12:13:44.192950 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m12:13:44.193273 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:44.203337 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:13:44.203911 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m12:13:44.204391 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m12:13:44.217613 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m12:13:44.219099 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m12:13:44.219585 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m12:13:44.225528 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:44.225960 [debug] [MainThread]: On master: BEGIN
[0m12:13:44.226290 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:13:44.232223 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:13:44.232652 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:44.233085 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:13:44.258841 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m12:13:44.260637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ac1e654-db3c-43e0-a68b-7027be9b9768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109142bd0>]}
[0m12:13:44.261139 [debug] [MainThread]: On master: ROLLBACK
[0m12:13:44.261634 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:44.261976 [debug] [MainThread]: On master: BEGIN
[0m12:13:44.262506 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:13:44.262851 [debug] [MainThread]: On master: COMMIT
[0m12:13:44.263180 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:44.263496 [debug] [MainThread]: On master: COMMIT
[0m12:13:44.264512 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:13:44.265045 [debug] [MainThread]: On master: Close
[0m12:13:44.265924 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:13:44.266350 [info ] [MainThread]: 
[0m12:13:44.269365 [debug] [Thread-1 (]: Began running node model.sumup.top_ten_stores
[0m12:13:44.269983 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.top_ten_stores ........................... [RUN]
[0m12:13:44.270771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.top_ten_stores)
[0m12:13:44.271207 [debug] [Thread-1 (]: Began compiling node model.sumup.top_ten_stores
[0m12:13:44.281765 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.top_ten_stores"
[0m12:13:44.282772 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_stores (compile): 12:13:44.271500 => 12:13:44.282493
[0m12:13:44.283209 [debug] [Thread-1 (]: Began executing node model.sumup.top_ten_stores
[0m12:13:44.326752 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.top_ten_stores"
[0m12:13:44.327679 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m12:13:44.328097 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: BEGIN
[0m12:13:44.328482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:13:44.334533 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:13:44.335025 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m12:13:44.335443 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */

  create view "merveyasa"."dbt_merve"."top_ten_stores__dbt_tmp"
    
    
  as (
    WITH top_ten_stores AS (
    SELECT store_id, SUM(transacted_amount) AS total_transaction_amount
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
    GROUP BY store_id
    ORDER BY total_transaction_amount DESC
    LIMIT 10
)
SELECT * FROM top_ten_stores;
  );
[0m12:13:44.338207 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 14: SELECT * FROM top_ten_stores;
                                     ^

[0m12:13:44.338723 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: ROLLBACK
[0m12:13:44.339627 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_stores (execute): 12:13:44.283487 => 12:13:44.339356
[0m12:13:44.340105 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: Close
[0m12:13:44.385122 [debug] [Thread-1 (]: Database Error in model top_ten_stores (models/top_ten_stores.sql)
  syntax error at or near ";"
  LINE 14: SELECT * FROM top_ten_stores;
                                       ^
  compiled Code at target/run/sumup/models/top_ten_stores.sql
[0m12:13:44.386268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ac1e654-db3c-43e0-a68b-7027be9b9768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109142f50>]}
[0m12:13:44.387338 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_merve.top_ten_stores .................. [[31mERROR[0m in 0.12s]
[0m12:13:44.388521 [debug] [Thread-1 (]: Finished running node model.sumup.top_ten_stores
[0m12:13:44.391164 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:44.391620 [debug] [MainThread]: On master: BEGIN
[0m12:13:44.391986 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:13:44.398963 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:13:44.399534 [debug] [MainThread]: On master: COMMIT
[0m12:13:44.400174 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:44.400707 [debug] [MainThread]: On master: COMMIT
[0m12:13:44.401839 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:13:44.403297 [debug] [MainThread]: On master: Close
[0m12:13:44.405414 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:13:44.406278 [debug] [MainThread]: Connection 'model.sumup.top_ten_stores' was properly closed.
[0m12:13:44.407357 [info ] [MainThread]: 
[0m12:13:44.408433 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m12:13:44.409746 [debug] [MainThread]: Command end result
[0m12:13:44.418279 [info ] [MainThread]: 
[0m12:13:44.419343 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:13:44.419828 [info ] [MainThread]: 
[0m12:13:44.420236 [error] [MainThread]: [33mDatabase Error in model top_ten_stores (models/top_ten_stores.sql)[0m
[0m12:13:44.420610 [error] [MainThread]:   syntax error at or near ";"
[0m12:13:44.420963 [error] [MainThread]:   LINE 14: SELECT * FROM top_ten_stores;
[0m12:13:44.421298 [error] [MainThread]:                                        ^
[0m12:13:44.421805 [error] [MainThread]:   compiled Code at target/run/sumup/models/top_ten_stores.sql
[0m12:13:44.422377 [info ] [MainThread]: 
[0m12:13:44.423290 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:13:44.425622 [debug] [MainThread]: Command `dbt run` failed at 12:13:44.425319 after 0.89 seconds
[0m12:13:44.426478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10947bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109274810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046d8290>]}
[0m12:13:44.427279 [debug] [MainThread]: Flushing usage events
[0m12:13:59.503034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c3a6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf1d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc7d490>]}


============================== 12:13:59.508027 | 60279017-8d66-4f7b-a739-6a5affd3c843 ==============================
[0m12:13:59.508027 [info ] [MainThread]: Running with dbt=1.6.0
[0m12:13:59.508871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m top_ten_stores', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:13:59.591491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60279017-8d66-4f7b-a739-6a5affd3c843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf1cf90>]}
[0m12:13:59.600051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60279017-8d66-4f7b-a739-6a5affd3c843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4bca90>]}
[0m12:13:59.600714 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m12:13:59.621947 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m12:13:59.655864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:13:59.656588 [debug] [MainThread]: Partial parsing: updated file: sumup://models/top_ten_stores.sql
[0m12:13:59.691197 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.my_project
- models.my_project.store_transaction_first
- models.my_project.store_transaction_view
- models.my_project.product_agg
[0m12:13:59.696702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60279017-8d66-4f7b-a739-6a5affd3c843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf1e650>]}
[0m12:13:59.708445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60279017-8d66-4f7b-a739-6a5affd3c843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5c0490>]}
[0m12:13:59.709363 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m12:13:59.710237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60279017-8d66-4f7b-a739-6a5affd3c843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4da550>]}
[0m12:13:59.713168 [info ] [MainThread]: 
[0m12:13:59.714657 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:13:59.717019 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m12:13:59.735971 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m12:13:59.736476 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m12:13:59.736856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:59.780611 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:13:59.783395 [debug] [ThreadPool]: On list_merveyasa: Close
[0m12:13:59.786264 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m12:13:59.794908 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m12:13:59.795572 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m12:13:59.796169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:59.803840 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:13:59.804499 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m12:13:59.805037 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m12:13:59.809532 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m12:13:59.811431 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m12:13:59.812175 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m12:13:59.819169 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:59.819595 [debug] [MainThread]: On master: BEGIN
[0m12:13:59.819935 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:13:59.826025 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:13:59.826444 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:59.826899 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:13:59.842174 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m12:13:59.843823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60279017-8d66-4f7b-a739-6a5affd3c843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc35c90>]}
[0m12:13:59.844278 [debug] [MainThread]: On master: ROLLBACK
[0m12:13:59.844855 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:59.845191 [debug] [MainThread]: On master: BEGIN
[0m12:13:59.845839 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:13:59.846186 [debug] [MainThread]: On master: COMMIT
[0m12:13:59.846505 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:59.846807 [debug] [MainThread]: On master: COMMIT
[0m12:13:59.847289 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:13:59.847617 [debug] [MainThread]: On master: Close
[0m12:13:59.848413 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:13:59.848836 [info ] [MainThread]: 
[0m12:13:59.851267 [debug] [Thread-1 (]: Began running node model.sumup.top_ten_stores
[0m12:13:59.851809 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.top_ten_stores ........................... [RUN]
[0m12:13:59.852602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.top_ten_stores)
[0m12:13:59.853008 [debug] [Thread-1 (]: Began compiling node model.sumup.top_ten_stores
[0m12:13:59.863329 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.top_ten_stores"
[0m12:13:59.864356 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_stores (compile): 12:13:59.853282 => 12:13:59.864080
[0m12:13:59.864838 [debug] [Thread-1 (]: Began executing node model.sumup.top_ten_stores
[0m12:13:59.913561 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.top_ten_stores"
[0m12:13:59.914704 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m12:13:59.915175 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: BEGIN
[0m12:13:59.915539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:13:59.921922 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:13:59.922364 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m12:13:59.922753 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */

  create view "merveyasa"."dbt_merve"."top_ten_stores__dbt_tmp"
    
    
  as (
    WITH top_ten_stores AS (
    SELECT store_id, SUM(transacted_amount) AS total_transaction_amount
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
    GROUP BY store_id
    ORDER BY total_transaction_amount DESC
    LIMIT 10
)
SELECT * FROM top_ten_stores
  );
[0m12:13:59.926829 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "transacted_amount" does not exist
LINE 8:     SELECT store_id, SUM(transacted_amount) AS total_transac...
                                 ^
HINT:  Perhaps you meant to reference the column "store_transaction_view.transaction_amount".

[0m12:13:59.927364 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: ROLLBACK
[0m12:13:59.928117 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_stores (execute): 12:13:59.865130 => 12:13:59.927877
[0m12:13:59.928544 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: Close
[0m12:13:59.933039 [debug] [Thread-1 (]: Database Error in model top_ten_stores (models/top_ten_stores.sql)
  column "transacted_amount" does not exist
  LINE 8:     SELECT store_id, SUM(transacted_amount) AS total_transac...
                                   ^
  HINT:  Perhaps you meant to reference the column "store_transaction_view.transaction_amount".
  compiled Code at target/run/sumup/models/top_ten_stores.sql
[0m12:13:59.933627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60279017-8d66-4f7b-a739-6a5affd3c843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c65e450>]}
[0m12:13:59.934292 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_merve.top_ten_stores .................. [[31mERROR[0m in 0.08s]
[0m12:13:59.935011 [debug] [Thread-1 (]: Finished running node model.sumup.top_ten_stores
[0m12:13:59.937233 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:59.937632 [debug] [MainThread]: On master: BEGIN
[0m12:13:59.937961 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:13:59.944102 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:13:59.944536 [debug] [MainThread]: On master: COMMIT
[0m12:13:59.944887 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:59.945225 [debug] [MainThread]: On master: COMMIT
[0m12:13:59.945672 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:13:59.946047 [debug] [MainThread]: On master: Close
[0m12:13:59.946822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:13:59.947208 [debug] [MainThread]: Connection 'model.sumup.top_ten_stores' was properly closed.
[0m12:13:59.947597 [info ] [MainThread]: 
[0m12:13:59.948123 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m12:13:59.948884 [debug] [MainThread]: Command end result
[0m12:13:59.958131 [info ] [MainThread]: 
[0m12:13:59.958865 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:13:59.959687 [info ] [MainThread]: 
[0m12:13:59.960615 [error] [MainThread]: [33mDatabase Error in model top_ten_stores (models/top_ten_stores.sql)[0m
[0m12:13:59.961422 [error] [MainThread]:   column "transacted_amount" does not exist
[0m12:13:59.962004 [error] [MainThread]:   LINE 8:     SELECT store_id, SUM(transacted_amount) AS total_transac...
[0m12:13:59.962429 [error] [MainThread]:                                    ^
[0m12:13:59.962837 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "store_transaction_view.transaction_amount".
[0m12:13:59.963241 [error] [MainThread]:   compiled Code at target/run/sumup/models/top_ten_stores.sql
[0m12:13:59.963642 [info ] [MainThread]: 
[0m12:13:59.964082 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:13:59.965170 [debug] [MainThread]: Command `dbt run` failed at 12:13:59.964916 after 0.48 seconds
[0m12:13:59.965830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6d7810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1ead90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfe16d0>]}
[0m12:13:59.966361 [debug] [MainThread]: Flushing usage events
[0m12:14:36.519814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ebf890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10579e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc3650>]}


============================== 12:14:36.525423 | df1f8345-bf7c-44c3-9f43-4b3e6971fbf3 ==============================
[0m12:14:36.525423 [info ] [MainThread]: Running with dbt=1.6.0
[0m12:14:36.526231 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'version_check': 'True', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m top_ten_stores', 'send_anonymous_usage_stats': 'True'}
[0m12:14:36.623896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df1f8345-bf7c-44c3-9f43-4b3e6971fbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069aecd0>]}
[0m12:14:36.632843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df1f8345-bf7c-44c3-9f43-4b3e6971fbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107190750>]}
[0m12:14:36.633596 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m12:14:36.654037 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m12:14:36.705297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:14:36.706154 [debug] [MainThread]: Partial parsing: updated file: sumup://models/top_ten_stores.sql
[0m12:14:36.743570 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.my_project
- models.my_project.product_agg
- models.my_project.store_transaction_first
- models.my_project.store_transaction_view
[0m12:14:36.749018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df1f8345-bf7c-44c3-9f43-4b3e6971fbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc5410>]}
[0m12:14:36.767410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df1f8345-bf7c-44c3-9f43-4b3e6971fbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10787d290>]}
[0m12:14:36.767998 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m12:14:36.768540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df1f8345-bf7c-44c3-9f43-4b3e6971fbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c51f10>]}
[0m12:14:36.770917 [info ] [MainThread]: 
[0m12:14:36.773454 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:14:36.774949 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m12:14:36.788188 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m12:14:36.788689 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m12:14:36.789075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:36.829705 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:14:36.832579 [debug] [ThreadPool]: On list_merveyasa: Close
[0m12:14:36.836321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m12:14:36.844694 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m12:14:36.845169 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m12:14:36.845552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:14:36.852874 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:14:36.853325 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m12:14:36.853729 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m12:14:36.857825 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m12:14:36.859355 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m12:14:36.859864 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m12:14:36.866337 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:36.866775 [debug] [MainThread]: On master: BEGIN
[0m12:14:36.867130 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:14:36.873436 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:14:36.873874 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:36.874340 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:14:36.889295 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m12:14:36.890894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df1f8345-bf7c-44c3-9f43-4b3e6971fbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067617d0>]}
[0m12:14:36.891358 [debug] [MainThread]: On master: ROLLBACK
[0m12:14:36.891939 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:36.892281 [debug] [MainThread]: On master: BEGIN
[0m12:14:36.893013 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:14:36.893358 [debug] [MainThread]: On master: COMMIT
[0m12:14:36.893682 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:36.893993 [debug] [MainThread]: On master: COMMIT
[0m12:14:36.894435 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:14:36.894780 [debug] [MainThread]: On master: Close
[0m12:14:36.895572 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:14:36.895981 [info ] [MainThread]: 
[0m12:14:36.898372 [debug] [Thread-1 (]: Began running node model.sumup.top_ten_stores
[0m12:14:36.898919 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.top_ten_stores ........................... [RUN]
[0m12:14:36.899705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.top_ten_stores)
[0m12:14:36.900114 [debug] [Thread-1 (]: Began compiling node model.sumup.top_ten_stores
[0m12:14:36.909569 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.top_ten_stores"
[0m12:14:36.910947 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_stores (compile): 12:14:36.900393 => 12:14:36.910423
[0m12:14:36.911497 [debug] [Thread-1 (]: Began executing node model.sumup.top_ten_stores
[0m12:14:36.954865 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.top_ten_stores"
[0m12:14:36.955748 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m12:14:36.956324 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: BEGIN
[0m12:14:36.956698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:14:36.963128 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:14:36.963729 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m12:14:36.964191 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */

  create view "merveyasa"."dbt_merve"."top_ten_stores__dbt_tmp"
    
    
  as (
    WITH top_ten_stores AS (
    SELECT store_id, SUM(transaction_amount) AS total_transaction_amount
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
    GROUP BY store_id
    ORDER BY total_transaction_amount DESC
    LIMIT 10
)
SELECT * FROM top_ten_stores
  );
[0m12:14:36.978644 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:14:36.985195 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m12:14:36.985644 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */
alter table "merveyasa"."dbt_merve"."top_ten_stores__dbt_tmp" rename to "top_ten_stores"
[0m12:14:36.988558 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:14:37.004306 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: COMMIT
[0m12:14:37.004766 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m12:14:37.005150 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: COMMIT
[0m12:14:37.008299 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:14:37.020366 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m12:14:37.020816 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */
drop view if exists "merveyasa"."dbt_merve"."top_ten_stores__dbt_backup" cascade
[0m12:14:37.021902 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:14:37.023545 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_stores (execute): 12:14:36.911791 => 12:14:37.023315
[0m12:14:37.023970 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: Close
[0m12:14:37.024882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df1f8345-bf7c-44c3-9f43-4b3e6971fbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107863410>]}
[0m12:14:37.025701 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_merve.top_ten_stores ...................... [[32mCREATE VIEW[0m in 0.13s]
[0m12:14:37.026505 [debug] [Thread-1 (]: Finished running node model.sumup.top_ten_stores
[0m12:14:37.028523 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:37.028908 [debug] [MainThread]: On master: BEGIN
[0m12:14:37.029233 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:14:37.036204 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:14:37.036892 [debug] [MainThread]: On master: COMMIT
[0m12:14:37.037345 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:37.037755 [debug] [MainThread]: On master: COMMIT
[0m12:14:37.038712 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:14:37.039481 [debug] [MainThread]: On master: Close
[0m12:14:37.041124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:14:37.041876 [debug] [MainThread]: Connection 'model.sumup.top_ten_stores' was properly closed.
[0m12:14:37.042423 [info ] [MainThread]: 
[0m12:14:37.043113 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m12:14:37.044079 [debug] [MainThread]: Command end result
[0m12:14:37.052564 [info ] [MainThread]: 
[0m12:14:37.053161 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:14:37.053534 [info ] [MainThread]: 
[0m12:14:37.053934 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:14:37.054653 [debug] [MainThread]: Command `dbt run` succeeded at 12:14:37.054513 after 0.56 seconds
[0m12:14:37.055116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106822950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102079590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106958350>]}
[0m12:14:37.055536 [debug] [MainThread]: Flushing usage events
[0m12:16:51.939217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b54e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b57d510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b887110>]}


============================== 12:16:51.948339 | a4a17705-48ca-4283-b2bc-699b01374c4d ==============================
[0m12:16:51.948339 [info ] [MainThread]: Running with dbt=1.6.0
[0m12:16:51.949803 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m top_ten_products', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:16:52.082272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4a17705-48ca-4283-b2bc-699b01374c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096d6f10>]}
[0m12:16:52.093797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4a17705-48ca-4283-b2bc-699b01374c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2e0e90>]}
[0m12:16:52.094723 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m12:16:52.133223 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m12:16:52.186034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:16:52.186848 [debug] [MainThread]: Partial parsing: added file: sumup://models/top_ten_products.sql
[0m12:16:52.235356 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.my_project.store_transaction_view
- models.my_project
- models.my_project.product_agg
- models.my_project.store_transaction_first
[0m12:16:52.242524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4a17705-48ca-4283-b2bc-699b01374c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb89e90>]}
[0m12:16:52.265073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4a17705-48ca-4283-b2bc-699b01374c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bce0ed0>]}
[0m12:16:52.266294 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m12:16:52.267125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4a17705-48ca-4283-b2bc-699b01374c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b569690>]}
[0m12:16:52.270513 [info ] [MainThread]: 
[0m12:16:52.272153 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:16:52.274788 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m12:16:52.299960 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m12:16:52.300624 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m12:16:52.301594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:52.361315 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:16:52.364230 [debug] [ThreadPool]: On list_merveyasa: Close
[0m12:16:52.366962 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m12:16:52.377776 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m12:16:52.378455 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m12:16:52.378987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:52.386354 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:16:52.386891 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m12:16:52.387602 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m12:16:52.392629 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:16:52.394523 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m12:16:52.395333 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m12:16:52.403028 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:52.403587 [debug] [MainThread]: On master: BEGIN
[0m12:16:52.404099 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:16:52.411415 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:16:52.411978 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:52.412475 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:16:52.433076 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m12:16:52.435374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4a17705-48ca-4283-b2bc-699b01374c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc26050>]}
[0m12:16:52.436110 [debug] [MainThread]: On master: ROLLBACK
[0m12:16:52.436821 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:52.437345 [debug] [MainThread]: On master: BEGIN
[0m12:16:52.438150 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:16:52.438630 [debug] [MainThread]: On master: COMMIT
[0m12:16:52.439022 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:52.439496 [debug] [MainThread]: On master: COMMIT
[0m12:16:52.440170 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:16:52.440707 [debug] [MainThread]: On master: Close
[0m12:16:52.441772 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:16:52.442617 [info ] [MainThread]: 
[0m12:16:52.445022 [debug] [Thread-1 (]: Began running node model.sumup.top_ten_products
[0m12:16:52.445802 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.top_ten_products ......................... [RUN]
[0m12:16:52.447281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.top_ten_products)
[0m12:16:52.447886 [debug] [Thread-1 (]: Began compiling node model.sumup.top_ten_products
[0m12:16:52.465520 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.top_ten_products"
[0m12:16:52.467065 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_products (compile): 12:16:52.448772 => 12:16:52.466647
[0m12:16:52.467866 [debug] [Thread-1 (]: Began executing node model.sumup.top_ten_products
[0m12:16:52.531198 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.top_ten_products"
[0m12:16:52.532378 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m12:16:52.533044 [debug] [Thread-1 (]: On model.sumup.top_ten_products: BEGIN
[0m12:16:52.533651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:52.541429 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:16:52.542242 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m12:16:52.543100 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */

  create view "merveyasa"."dbt_merve"."top_ten_products__dbt_tmp"
    
    
  as (
    WITH top_ten_products AS (
    SELECT product_name, COUNT(*) AS total_count_sold
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
    GROUP BY product_name
    ORDER BY total_count_sold DESC
    LIMIT 10
)
SELECT * FROM top_ten_products
  );
[0m12:16:52.549667 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:16:52.556657 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m12:16:52.557129 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */
alter table "merveyasa"."dbt_merve"."top_ten_products__dbt_tmp" rename to "top_ten_products"
[0m12:16:52.557884 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:16:52.578279 [debug] [Thread-1 (]: On model.sumup.top_ten_products: COMMIT
[0m12:16:52.578841 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m12:16:52.579226 [debug] [Thread-1 (]: On model.sumup.top_ten_products: COMMIT
[0m12:16:52.581274 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:16:52.593623 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m12:16:52.594315 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */
drop view if exists "merveyasa"."dbt_merve"."top_ten_products__dbt_backup" cascade
[0m12:16:52.596368 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:16:52.598525 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_products (execute): 12:16:52.468254 => 12:16:52.598262
[0m12:16:52.599001 [debug] [Thread-1 (]: On model.sumup.top_ten_products: Close
[0m12:16:52.600528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4a17705-48ca-4283-b2bc-699b01374c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2f8e90>]}
[0m12:16:52.601588 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_merve.top_ten_products .................... [[32mCREATE VIEW[0m in 0.15s]
[0m12:16:52.602650 [debug] [Thread-1 (]: Finished running node model.sumup.top_ten_products
[0m12:16:52.605239 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:52.605667 [debug] [MainThread]: On master: BEGIN
[0m12:16:52.606012 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:16:52.615113 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:16:52.616346 [debug] [MainThread]: On master: COMMIT
[0m12:16:52.617789 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:52.618722 [debug] [MainThread]: On master: COMMIT
[0m12:16:52.619457 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:16:52.620331 [debug] [MainThread]: On master: Close
[0m12:16:52.621635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:52.622888 [debug] [MainThread]: Connection 'model.sumup.top_ten_products' was properly closed.
[0m12:16:52.623583 [info ] [MainThread]: 
[0m12:16:52.627007 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m12:16:52.628778 [debug] [MainThread]: Command end result
[0m12:16:52.646897 [info ] [MainThread]: 
[0m12:16:52.648545 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:16:52.649652 [info ] [MainThread]: 
[0m12:16:52.651220 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:16:52.652712 [debug] [MainThread]: Command `dbt run` succeeded at 12:16:52.652471 after 0.75 seconds
[0m12:16:52.653847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2f9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b43a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b60d1d0>]}
[0m12:16:52.654909 [debug] [MainThread]: Flushing usage events
[0m12:20:33.652786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d0b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ed510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ef210>]}


============================== 12:20:33.662644 | 1a4a9520-6599-4acc-9176-1e7844062c31 ==============================
[0m12:20:33.662644 [info ] [MainThread]: Running with dbt=1.6.0
[0m12:20:33.664191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m avg_transaction_amount', 'send_anonymous_usage_stats': 'True'}
[0m12:20:33.880105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a4a9520-6599-4acc-9176-1e7844062c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ecda50>]}
[0m12:20:33.894598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a4a9520-6599-4acc-9176-1e7844062c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d0b10>]}
[0m12:20:33.895779 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m12:20:33.931866 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m12:20:33.989797 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:20:33.990837 [debug] [MainThread]: Partial parsing: added file: sumup://models/avg_transaction_amount.sql
[0m12:20:34.050982 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.my_project.store_transaction_first
- models.my_project
- models.my_project.product_agg
- models.my_project.store_transaction_view
[0m12:20:34.057259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a4a9520-6599-4acc-9176-1e7844062c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b8610>]}
[0m12:20:34.074456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a4a9520-6599-4acc-9176-1e7844062c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f97e50>]}
[0m12:20:34.075058 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m12:20:34.075517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a4a9520-6599-4acc-9176-1e7844062c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e4250>]}
[0m12:20:34.077569 [info ] [MainThread]: 
[0m12:20:34.078980 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:20:34.081190 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m12:20:34.100712 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m12:20:34.101757 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m12:20:34.102431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:34.165381 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:20:34.167569 [debug] [ThreadPool]: On list_merveyasa: Close
[0m12:20:34.170336 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m12:20:34.181270 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m12:20:34.182044 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m12:20:34.182734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:20:34.196957 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:20:34.197788 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m12:20:34.198437 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m12:20:34.212403 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:20:34.214906 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m12:20:34.215640 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m12:20:34.224228 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:34.224842 [debug] [MainThread]: On master: BEGIN
[0m12:20:34.225384 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:20:34.232484 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:20:34.233110 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:34.233871 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:20:34.259091 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m12:20:34.262539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a4a9520-6599-4acc-9176-1e7844062c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc8310>]}
[0m12:20:34.263277 [debug] [MainThread]: On master: ROLLBACK
[0m12:20:34.264064 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:34.264637 [debug] [MainThread]: On master: BEGIN
[0m12:20:34.265449 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:20:34.266018 [debug] [MainThread]: On master: COMMIT
[0m12:20:34.266889 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:34.267409 [debug] [MainThread]: On master: COMMIT
[0m12:20:34.268438 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:20:34.269000 [debug] [MainThread]: On master: Close
[0m12:20:34.270088 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:20:34.270657 [info ] [MainThread]: 
[0m12:20:34.273864 [debug] [Thread-1 (]: Began running node model.sumup.avg_transaction_amount
[0m12:20:34.274692 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.avg_transaction_amount ................... [RUN]
[0m12:20:34.275900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.avg_transaction_amount)
[0m12:20:34.277149 [debug] [Thread-1 (]: Began compiling node model.sumup.avg_transaction_amount
[0m12:20:34.287815 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.avg_transaction_amount"
[0m12:20:34.289144 [debug] [Thread-1 (]: Timing info for model.sumup.avg_transaction_amount (compile): 12:20:34.277623 => 12:20:34.288759
[0m12:20:34.289799 [debug] [Thread-1 (]: Began executing node model.sumup.avg_transaction_amount
[0m12:20:34.354869 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.avg_transaction_amount"
[0m12:20:34.355805 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m12:20:34.356207 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: BEGIN
[0m12:20:34.356565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:20:34.363226 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:20:34.363683 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m12:20:34.364070 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.avg_transaction_amount"} */

  create view "merveyasa"."dbt_merve"."avg_transaction_amount__dbt_tmp"
    
    
  as (
    WITH avg_transaction_amount AS (
    SELECT store_typology, shop_country, AVG(transaction_amount) AS average_transaction_amount
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
    GROUP BY store_typology, shop_country
)
SELECT * FROM avg_transaction_amount
  );
[0m12:20:34.365349 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "shop_country" does not exist
LINE 8:     SELECT store_typology, shop_country, AVG(transaction_amo...
                                   ^
HINT:  Perhaps you meant to reference the column "store_transaction_view.store_country".

[0m12:20:34.365765 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: ROLLBACK
[0m12:20:34.366606 [debug] [Thread-1 (]: Timing info for model.sumup.avg_transaction_amount (execute): 12:20:34.290231 => 12:20:34.366372
[0m12:20:34.367002 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: Close
[0m12:20:34.402836 [debug] [Thread-1 (]: Database Error in model avg_transaction_amount (models/avg_transaction_amount.sql)
  column "shop_country" does not exist
  LINE 8:     SELECT store_typology, shop_country, AVG(transaction_amo...
                                     ^
  HINT:  Perhaps you meant to reference the column "store_transaction_view.store_country".
  compiled Code at target/run/sumup/models/avg_transaction_amount.sql
[0m12:20:34.403803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a4a9520-6599-4acc-9176-1e7844062c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f47010>]}
[0m12:20:34.404856 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_merve.avg_transaction_amount .......... [[31mERROR[0m in 0.13s]
[0m12:20:34.406459 [debug] [Thread-1 (]: Finished running node model.sumup.avg_transaction_amount
[0m12:20:34.409681 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:34.410289 [debug] [MainThread]: On master: BEGIN
[0m12:20:34.410803 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:20:34.422113 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:20:34.422783 [debug] [MainThread]: On master: COMMIT
[0m12:20:34.423423 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:34.423985 [debug] [MainThread]: On master: COMMIT
[0m12:20:34.424703 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:20:34.425587 [debug] [MainThread]: On master: Close
[0m12:20:34.429339 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:20:34.429935 [debug] [MainThread]: Connection 'model.sumup.avg_transaction_amount' was properly closed.
[0m12:20:34.430523 [info ] [MainThread]: 
[0m12:20:34.431184 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m12:20:34.432638 [debug] [MainThread]: Command end result
[0m12:20:34.449726 [info ] [MainThread]: 
[0m12:20:34.450887 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:20:34.452147 [info ] [MainThread]: 
[0m12:20:34.452878 [error] [MainThread]: [33mDatabase Error in model avg_transaction_amount (models/avg_transaction_amount.sql)[0m
[0m12:20:34.453547 [error] [MainThread]:   column "shop_country" does not exist
[0m12:20:34.454303 [error] [MainThread]:   LINE 8:     SELECT store_typology, shop_country, AVG(transaction_amo...
[0m12:20:34.455038 [error] [MainThread]:                                      ^
[0m12:20:34.457867 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "store_transaction_view.store_country".
[0m12:20:34.458611 [error] [MainThread]:   compiled Code at target/run/sumup/models/avg_transaction_amount.sql
[0m12:20:34.459854 [info ] [MainThread]: 
[0m12:20:34.462362 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:20:34.463828 [debug] [MainThread]: Command `dbt run` failed at 12:20:34.463601 after 0.85 seconds
[0m12:20:34.467129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c1de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105be9390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bebe10>]}
[0m12:20:34.468049 [debug] [MainThread]: Flushing usage events
[0m12:21:08.305201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124f0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124f2f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127b47d0>]}


============================== 12:21:08.313821 | e4c3148b-d701-47f7-a5a2-9399b6b48159 ==============================
[0m12:21:08.313821 [info ] [MainThread]: Running with dbt=1.6.0
[0m12:21:08.315107 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m avg_transaction_amount', 'send_anonymous_usage_stats': 'True'}
[0m12:21:08.448881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4c3148b-d701-47f7-a5a2-9399b6b48159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11251d7d0>]}
[0m12:21:08.463896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4c3148b-d701-47f7-a5a2-9399b6b48159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112790690>]}
[0m12:21:08.464926 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m12:21:08.494998 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m12:21:08.543616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:21:08.544385 [debug] [MainThread]: Partial parsing: updated file: sumup://models/avg_transaction_amount.sql
[0m12:21:08.601718 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.my_project.store_transaction_view
- models.my_project
- models.my_project.store_transaction_first
- models.my_project.product_agg
[0m12:21:08.620183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4c3148b-d701-47f7-a5a2-9399b6b48159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dc8a90>]}
[0m12:21:08.643666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4c3148b-d701-47f7-a5a2-9399b6b48159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112790690>]}
[0m12:21:08.645869 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m12:21:08.647537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4c3148b-d701-47f7-a5a2-9399b6b48159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11250d210>]}
[0m12:21:08.650292 [info ] [MainThread]: 
[0m12:21:08.652009 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:21:08.655754 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m12:21:08.683626 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m12:21:08.684482 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m12:21:08.685200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:08.739685 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:21:08.742602 [debug] [ThreadPool]: On list_merveyasa: Close
[0m12:21:08.745512 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m12:21:08.756658 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m12:21:08.757318 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m12:21:08.757874 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:08.765001 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:21:08.765599 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m12:21:08.766182 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m12:21:08.772357 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:21:08.774714 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m12:21:08.775511 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m12:21:08.784735 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:08.785298 [debug] [MainThread]: On master: BEGIN
[0m12:21:08.785919 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:21:08.794720 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:21:08.795331 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:08.796152 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:21:08.833453 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m12:21:08.837167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4c3148b-d701-47f7-a5a2-9399b6b48159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d087d0>]}
[0m12:21:08.837977 [debug] [MainThread]: On master: ROLLBACK
[0m12:21:08.838837 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:08.839424 [debug] [MainThread]: On master: BEGIN
[0m12:21:08.840405 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:21:08.841021 [debug] [MainThread]: On master: COMMIT
[0m12:21:08.841677 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:08.842375 [debug] [MainThread]: On master: COMMIT
[0m12:21:08.843176 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:21:08.843774 [debug] [MainThread]: On master: Close
[0m12:21:08.844948 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:21:08.845659 [info ] [MainThread]: 
[0m12:21:08.849174 [debug] [Thread-1 (]: Began running node model.sumup.avg_transaction_amount
[0m12:21:08.850235 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.avg_transaction_amount ................... [RUN]
[0m12:21:08.851486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.avg_transaction_amount)
[0m12:21:08.852013 [debug] [Thread-1 (]: Began compiling node model.sumup.avg_transaction_amount
[0m12:21:08.863456 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.avg_transaction_amount"
[0m12:21:08.865026 [debug] [Thread-1 (]: Timing info for model.sumup.avg_transaction_amount (compile): 12:21:08.853181 => 12:21:08.864646
[0m12:21:08.865789 [debug] [Thread-1 (]: Began executing node model.sumup.avg_transaction_amount
[0m12:21:08.941348 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.avg_transaction_amount"
[0m12:21:08.942797 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m12:21:08.943615 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: BEGIN
[0m12:21:08.944358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:08.953205 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:21:08.954007 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m12:21:08.954797 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.avg_transaction_amount"} */

  create view "merveyasa"."dbt_merve"."avg_transaction_amount__dbt_tmp"
    
    
  as (
    WITH avg_transaction_amount AS (
    SELECT store_typology, store_country, AVG(transaction_amount) AS average_transaction_amount
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
    GROUP BY store_typology, store_country
)
SELECT * FROM avg_transaction_amount
  );
[0m12:21:08.973554 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:21:08.985028 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m12:21:08.985871 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.avg_transaction_amount"} */
alter table "merveyasa"."dbt_merve"."avg_transaction_amount__dbt_tmp" rename to "avg_transaction_amount"
[0m12:21:08.987233 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:21:09.012961 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: COMMIT
[0m12:21:09.013743 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m12:21:09.014376 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: COMMIT
[0m12:21:09.015585 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:21:09.030596 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m12:21:09.031271 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.avg_transaction_amount"} */
drop view if exists "merveyasa"."dbt_merve"."avg_transaction_amount__dbt_backup" cascade
[0m12:21:09.032306 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:21:09.034911 [debug] [Thread-1 (]: Timing info for model.sumup.avg_transaction_amount (execute): 12:21:08.866372 => 12:21:09.034557
[0m12:21:09.035657 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: Close
[0m12:21:09.037049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4c3148b-d701-47f7-a5a2-9399b6b48159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f1cad0>]}
[0m12:21:09.038363 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_merve.avg_transaction_amount .............. [[32mCREATE VIEW[0m in 0.19s]
[0m12:21:09.039559 [debug] [Thread-1 (]: Finished running node model.sumup.avg_transaction_amount
[0m12:21:09.042425 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:09.043036 [debug] [MainThread]: On master: BEGIN
[0m12:21:09.043556 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:21:09.052830 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:21:09.053761 [debug] [MainThread]: On master: COMMIT
[0m12:21:09.054410 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:09.054971 [debug] [MainThread]: On master: COMMIT
[0m12:21:09.055695 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:21:09.056288 [debug] [MainThread]: On master: Close
[0m12:21:09.057384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:09.058011 [debug] [MainThread]: Connection 'model.sumup.avg_transaction_amount' was properly closed.
[0m12:21:09.058611 [info ] [MainThread]: 
[0m12:21:09.059318 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m12:21:09.060175 [debug] [MainThread]: Command end result
[0m12:21:09.074922 [info ] [MainThread]: 
[0m12:21:09.075809 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:21:09.076610 [info ] [MainThread]: 
[0m12:21:09.077112 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:21:09.078185 [debug] [MainThread]: Command `dbt run` succeeded at 12:21:09.078006 after 0.82 seconds
[0m12:21:09.078720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126f5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ef8350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddffa90>]}
[0m12:21:09.079212 [debug] [MainThread]: Flushing usage events
[0m12:23:23.321565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bf6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e15810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c30290>]}


============================== 12:23:23.330506 | 9caae8af-b28e-4d89-a01d-5632b16fab12 ==============================
[0m12:23:23.330506 [info ] [MainThread]: Running with dbt=1.6.0
[0m12:23:23.331581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m pct_transaction', 'send_anonymous_usage_stats': 'True'}
[0m12:23:23.477653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9caae8af-b28e-4d89-a01d-5632b16fab12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10948f5d0>]}
[0m12:23:23.492702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9caae8af-b28e-4d89-a01d-5632b16fab12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10948fc90>]}
[0m12:23:23.493778 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m12:23:23.522051 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m12:23:23.565573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:23:23.566257 [debug] [MainThread]: Partial parsing: added file: sumup://models/pct_transaction.sql
[0m12:23:23.623526 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.my_project.store_transaction_view
- models.my_project.store_transaction_first
- models.my_project.product_agg
- models.my_project
[0m12:23:23.633668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9caae8af-b28e-4d89-a01d-5632b16fab12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094e5d90>]}
[0m12:23:23.651759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9caae8af-b28e-4d89-a01d-5632b16fab12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109593b10>]}
[0m12:23:23.652880 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m12:23:23.653784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9caae8af-b28e-4d89-a01d-5632b16fab12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c461d0>]}
[0m12:23:23.656716 [info ] [MainThread]: 
[0m12:23:23.658462 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:23:23.660785 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m12:23:23.679788 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m12:23:23.680364 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m12:23:23.680813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:23.733601 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:23:23.736550 [debug] [ThreadPool]: On list_merveyasa: Close
[0m12:23:23.740690 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m12:23:23.753320 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m12:23:23.754005 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m12:23:23.754590 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:23:23.762472 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:23:23.763141 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m12:23:23.763781 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m12:23:23.770214 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:23:23.772619 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m12:23:23.773426 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m12:23:23.785080 [debug] [MainThread]: Using postgres connection "master"
[0m12:23:23.785718 [debug] [MainThread]: On master: BEGIN
[0m12:23:23.786251 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:23:23.794239 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:23:23.794979 [debug] [MainThread]: Using postgres connection "master"
[0m12:23:23.795773 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:23:23.828105 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m12:23:23.832138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9caae8af-b28e-4d89-a01d-5632b16fab12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f8ba10>]}
[0m12:23:23.832912 [debug] [MainThread]: On master: ROLLBACK
[0m12:23:23.833694 [debug] [MainThread]: Using postgres connection "master"
[0m12:23:23.834417 [debug] [MainThread]: On master: BEGIN
[0m12:23:23.835313 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:23:23.836080 [debug] [MainThread]: On master: COMMIT
[0m12:23:23.836869 [debug] [MainThread]: Using postgres connection "master"
[0m12:23:23.837699 [debug] [MainThread]: On master: COMMIT
[0m12:23:23.838542 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:23:23.839128 [debug] [MainThread]: On master: Close
[0m12:23:23.840338 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:23:23.841366 [info ] [MainThread]: 
[0m12:23:23.844578 [debug] [Thread-1 (]: Began running node model.sumup.pct_transaction
[0m12:23:23.845587 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.pct_transaction .......................... [RUN]
[0m12:23:23.847132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.pct_transaction)
[0m12:23:23.847856 [debug] [Thread-1 (]: Began compiling node model.sumup.pct_transaction
[0m12:23:23.861542 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.pct_transaction"
[0m12:23:23.862922 [debug] [Thread-1 (]: Timing info for model.sumup.pct_transaction (compile): 12:23:23.848419 => 12:23:23.862301
[0m12:23:23.863696 [debug] [Thread-1 (]: Began executing node model.sumup.pct_transaction
[0m12:23:23.938412 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.pct_transaction"
[0m12:23:23.939943 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m12:23:23.940650 [debug] [Thread-1 (]: On model.sumup.pct_transaction: BEGIN
[0m12:23:23.941275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:23.949346 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:23:23.950119 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m12:23:23.950889 [debug] [Thread-1 (]: On model.sumup.pct_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.pct_transaction"} */

  create view "merveyasa"."dbt_merve"."pct_transaction__dbt_tmp"
    
    
  as (
    WITH pct_transaction AS (
    SELECT device_type, COUNT(*) * 100.0 / SUM(COUNT(*)) OVER () AS percentage
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
    GROUP BY device_type
)
SELECT * FROM pct_transaction
  );
[0m12:23:23.981707 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:23:23.992995 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m12:23:23.993749 [debug] [Thread-1 (]: On model.sumup.pct_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.pct_transaction"} */
alter table "merveyasa"."dbt_merve"."pct_transaction__dbt_tmp" rename to "pct_transaction"
[0m12:23:23.995231 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:23:24.021596 [debug] [Thread-1 (]: On model.sumup.pct_transaction: COMMIT
[0m12:23:24.022343 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m12:23:24.023007 [debug] [Thread-1 (]: On model.sumup.pct_transaction: COMMIT
[0m12:23:24.024369 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:23:24.039921 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m12:23:24.040648 [debug] [Thread-1 (]: On model.sumup.pct_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.pct_transaction"} */
drop view if exists "merveyasa"."dbt_merve"."pct_transaction__dbt_backup" cascade
[0m12:23:24.041702 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:23:24.044371 [debug] [Thread-1 (]: Timing info for model.sumup.pct_transaction (execute): 12:23:23.864273 => 12:23:24.043977
[0m12:23:24.045177 [debug] [Thread-1 (]: On model.sumup.pct_transaction: Close
[0m12:23:24.046493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9caae8af-b28e-4d89-a01d-5632b16fab12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091b3f10>]}
[0m12:23:24.047602 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_merve.pct_transaction ..................... [[32mCREATE VIEW[0m in 0.20s]
[0m12:23:24.048816 [debug] [Thread-1 (]: Finished running node model.sumup.pct_transaction
[0m12:23:24.051799 [debug] [MainThread]: Using postgres connection "master"
[0m12:23:24.052410 [debug] [MainThread]: On master: BEGIN
[0m12:23:24.052948 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:23:24.061283 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:23:24.062047 [debug] [MainThread]: On master: COMMIT
[0m12:23:24.063244 [debug] [MainThread]: Using postgres connection "master"
[0m12:23:24.064259 [debug] [MainThread]: On master: COMMIT
[0m12:23:24.065412 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:23:24.066150 [debug] [MainThread]: On master: Close
[0m12:23:24.067585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:23:24.068611 [debug] [MainThread]: Connection 'model.sumup.pct_transaction' was properly closed.
[0m12:23:24.069299 [info ] [MainThread]: 
[0m12:23:24.070063 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m12:23:24.071526 [debug] [MainThread]: Command end result
[0m12:23:24.089553 [info ] [MainThread]: 
[0m12:23:24.090415 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:23:24.091028 [info ] [MainThread]: 
[0m12:23:24.091799 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:23:24.093510 [debug] [MainThread]: Command `dbt run` succeeded at 12:23:24.093256 after 0.82 seconds
[0m12:23:24.094348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104491710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104491590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a52250>]}
[0m12:23:24.099812 [debug] [MainThread]: Flushing usage events
[0m12:27:29.671460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bc2b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e19790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106141210>]}


============================== 12:27:29.680811 | 7116ab4b-e8c3-4367-b305-d8659b019fb9 ==============================
[0m12:27:29.680811 [info ] [MainThread]: Running with dbt=1.6.0
[0m12:27:29.682172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m store_transaction_first', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:27:29.837750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7116ab4b-e8c3-4367-b305-d8659b019fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b8fa90>]}
[0m12:27:29.849887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7116ab4b-e8c3-4367-b305-d8659b019fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106400610>]}
[0m12:27:29.851112 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m12:27:29.883288 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m12:27:29.949478 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:27:29.950187 [debug] [MainThread]: Partial parsing: updated file: sumup://models/store_transaction_first.sql
[0m12:27:29.999715 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.my_project.store_transaction_first
- models.my_project.product_agg
- models.my_project.store_transaction_view
- models.my_project
[0m12:27:30.005059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7116ab4b-e8c3-4367-b305-d8659b019fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b951d0>]}
[0m12:27:30.026030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7116ab4b-e8c3-4367-b305-d8659b019fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10650c310>]}
[0m12:27:30.026883 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m12:27:30.027699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7116ab4b-e8c3-4367-b305-d8659b019fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f05190>]}
[0m12:27:30.030412 [info ] [MainThread]: 
[0m12:27:30.033884 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:27:30.037387 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m12:27:30.053931 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m12:27:30.054566 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m12:27:30.055050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:30.117949 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:27:30.120753 [debug] [ThreadPool]: On list_merveyasa: Close
[0m12:27:30.123727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m12:27:30.134852 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m12:27:30.135456 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m12:27:30.136032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:30.144550 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:27:30.145139 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m12:27:30.145702 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m12:27:30.149847 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:27:30.151315 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m12:27:30.151796 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m12:27:30.158125 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:30.158526 [debug] [MainThread]: On master: BEGIN
[0m12:27:30.158854 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:27:30.166785 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:27:30.167421 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:30.168237 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:27:30.199357 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m12:27:30.201641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7116ab4b-e8c3-4367-b305-d8659b019fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b8dc10>]}
[0m12:27:30.202081 [debug] [MainThread]: On master: ROLLBACK
[0m12:27:30.202614 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:30.202930 [debug] [MainThread]: On master: BEGIN
[0m12:27:30.203629 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:27:30.203968 [debug] [MainThread]: On master: COMMIT
[0m12:27:30.204283 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:30.204581 [debug] [MainThread]: On master: COMMIT
[0m12:27:30.205103 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:27:30.205441 [debug] [MainThread]: On master: Close
[0m12:27:30.206324 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:27:30.206894 [info ] [MainThread]: 
[0m12:27:30.210153 [debug] [Thread-1 (]: Began running node model.sumup.store_transaction_first
[0m12:27:30.211046 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.store_transaction_first .................. [RUN]
[0m12:27:30.212493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.store_transaction_first)
[0m12:27:30.213026 [debug] [Thread-1 (]: Began compiling node model.sumup.store_transaction_first
[0m12:27:30.226088 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.store_transaction_first"
[0m12:27:30.228455 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_first (compile): 12:27:30.213347 => 12:27:30.227939
[0m12:27:30.229259 [debug] [Thread-1 (]: Began executing node model.sumup.store_transaction_first
[0m12:27:30.297159 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.store_transaction_first"
[0m12:27:30.298094 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m12:27:30.298487 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: BEGIN
[0m12:27:30.298838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:30.305368 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:27:30.305947 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m12:27:30.306417 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_first"} */

  create view "merveyasa"."dbt_merve"."store_transaction_first__dbt_tmp"
    
    
  as (
    WITH store_first_five_transactions AS
(
SELECT
    store_id,
    AVG(time_diff) AS avg_time_diff
FROM (
    SELECT
        store_id,
        transaction_happened_at - LAG(transaction_happened_at, 1) OVER (PARTITION BY store_id ORDER BY transaction_happened_at) AS time_diff,
        ROW_NUMBER() OVER (PARTITION BY store_id ORDER BY transaction_happened_at) AS rn
    FROM
        "merveyasa"."dbt_merve"."store_transaction_view"
) subquery
WHERE
    rn <= 5
GROUP BY
    store_id
)

SELECT * FROM store_first_five_transactions
  );
[0m12:27:30.311490 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:27:30.322407 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m12:27:30.323155 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_first"} */
alter table "merveyasa"."dbt_merve"."store_transaction_first" rename to "store_transaction_first__dbt_backup"
[0m12:27:30.324452 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:27:30.329775 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m12:27:30.330587 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_first"} */
alter table "merveyasa"."dbt_merve"."store_transaction_first__dbt_tmp" rename to "store_transaction_first"
[0m12:27:30.332115 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:27:30.355075 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: COMMIT
[0m12:27:30.355681 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m12:27:30.356122 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: COMMIT
[0m12:27:30.357734 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:27:30.374088 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m12:27:30.374797 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_first"} */
drop view if exists "merveyasa"."dbt_merve"."store_transaction_first__dbt_backup" cascade
[0m12:27:30.379496 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:27:30.382127 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_first (execute): 12:27:30.229738 => 12:27:30.381773
[0m12:27:30.382783 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: Close
[0m12:27:30.384061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7116ab4b-e8c3-4367-b305-d8659b019fb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10612f290>]}
[0m12:27:30.385173 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_merve.store_transaction_first ............. [[32mCREATE VIEW[0m in 0.17s]
[0m12:27:30.386337 [debug] [Thread-1 (]: Finished running node model.sumup.store_transaction_first
[0m12:27:30.389271 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:30.392367 [debug] [MainThread]: On master: BEGIN
[0m12:27:30.392971 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:27:30.401191 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:27:30.402010 [debug] [MainThread]: On master: COMMIT
[0m12:27:30.403020 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:30.403785 [debug] [MainThread]: On master: COMMIT
[0m12:27:30.404541 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:27:30.405071 [debug] [MainThread]: On master: Close
[0m12:27:30.405887 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:30.406300 [debug] [MainThread]: Connection 'model.sumup.store_transaction_first' was properly closed.
[0m12:27:30.406674 [info ] [MainThread]: 
[0m12:27:30.407221 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m12:27:30.408098 [debug] [MainThread]: Command end result
[0m12:27:30.425573 [info ] [MainThread]: 
[0m12:27:30.426716 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:27:30.427354 [info ] [MainThread]: 
[0m12:27:30.427991 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:27:30.429395 [debug] [MainThread]: Command `dbt run` succeeded at 12:27:30.429176 after 0.82 seconds
[0m12:27:30.430086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1014a3c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1014a3bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1014b0410>]}
[0m12:27:30.430726 [debug] [MainThread]: Flushing usage events
[0m12:44:41.349555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd62c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6cc610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dccca10>]}


============================== 12:44:41.357799 | c448845e-9153-43f2-a277-f4831967d22f ==============================
[0m12:44:41.357799 [info ] [MainThread]: Running with dbt=1.6.0
[0m12:44:41.358759 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:44:41.546519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c448845e-9153-43f2-a277-f4831967d22f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df92dd0>]}
[0m12:44:41.555739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c448845e-9153-43f2-a277-f4831967d22f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e55bed0>]}
[0m12:44:41.556967 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m12:44:41.598199 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m12:44:41.620254 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:44:41.620964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c448845e-9153-43f2-a277-f4831967d22f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dccdbd0>]}
[0m12:44:42.380930 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.my_project.store_transaction_view
- models.my_project.product_agg
- models.my_project.store_transaction_first
- models.my_project.avg_transaction_amount
- models.my_project
[0m12:44:42.386165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c448845e-9153-43f2-a277-f4831967d22f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e609510>]}
[0m12:44:42.403640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c448845e-9153-43f2-a277-f4831967d22f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6bf750>]}
[0m12:44:42.404530 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m12:44:42.405155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c448845e-9153-43f2-a277-f4831967d22f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e65bcd0>]}
[0m12:44:42.407587 [info ] [MainThread]: 
[0m12:44:42.408588 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:44:42.410672 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m12:44:42.425895 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m12:44:42.426571 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m12:44:42.427025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:42.517771 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:44:42.520333 [debug] [ThreadPool]: On list_merveyasa: Close
[0m12:44:42.522859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m12:44:42.529868 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m12:44:42.530461 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m12:44:42.530792 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:44:42.536899 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:44:42.537305 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m12:44:42.537675 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m12:44:42.545184 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:44:42.546662 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m12:44:42.547136 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m12:44:42.553000 [debug] [MainThread]: Using postgres connection "master"
[0m12:44:42.553398 [debug] [MainThread]: On master: BEGIN
[0m12:44:42.553717 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:44:42.559855 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:44:42.560257 [debug] [MainThread]: Using postgres connection "master"
[0m12:44:42.560687 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:44:42.579367 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m12:44:42.582686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c448845e-9153-43f2-a277-f4831967d22f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec26d10>]}
[0m12:44:42.583164 [debug] [MainThread]: On master: ROLLBACK
[0m12:44:42.583659 [debug] [MainThread]: Using postgres connection "master"
[0m12:44:42.584061 [debug] [MainThread]: On master: BEGIN
[0m12:44:42.584700 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:44:42.585074 [debug] [MainThread]: On master: COMMIT
[0m12:44:42.585411 [debug] [MainThread]: Using postgres connection "master"
[0m12:44:42.585730 [debug] [MainThread]: On master: COMMIT
[0m12:44:42.586173 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:44:42.586515 [debug] [MainThread]: On master: Close
[0m12:44:42.587295 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:44:42.587699 [info ] [MainThread]: 
[0m12:44:42.591851 [debug] [Thread-1 (]: Began running node model.sumup.product_agg
[0m12:44:42.592441 [info ] [Thread-1 (]: 1 of 7 START sql view model dbt_merve.product_agg .............................. [RUN]
[0m12:44:42.593281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.product_agg)
[0m12:44:42.593831 [debug] [Thread-1 (]: Began compiling node model.sumup.product_agg
[0m12:44:42.600574 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.product_agg"
[0m12:44:42.602176 [debug] [Thread-1 (]: Timing info for model.sumup.product_agg (compile): 12:44:42.594141 => 12:44:42.601813
[0m12:44:42.602663 [debug] [Thread-1 (]: Began executing node model.sumup.product_agg
[0m12:44:42.650505 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.product_agg"
[0m12:44:42.651503 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m12:44:42.651950 [debug] [Thread-1 (]: On model.sumup.product_agg: BEGIN
[0m12:44:42.652394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:42.658967 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:44:42.659489 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m12:44:42.659911 [debug] [Thread-1 (]: On model.sumup.product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.product_agg"} */

  create view "merveyasa"."dbt_merve"."product_agg__dbt_tmp"
    
    
  as (
    WITH product_agg AS 
(
SELECT
    product_name,
    product_sku,
    COUNT(*) AS transactions_count,
    SUM(transaction_amount) AS total_amount
FROM
    transactions
WHERE
    transaction_status = 'accepted' -- Consider only accepted transactions
GROUP BY
    product_name, product_sku
)

select * from product_agg
  );
[0m12:44:42.665147 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:44:42.672155 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m12:44:42.672624 [debug] [Thread-1 (]: On model.sumup.product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.product_agg"} */
alter table "merveyasa"."dbt_merve"."product_agg" rename to "product_agg__dbt_backup"
[0m12:44:42.673446 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:44:42.676349 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m12:44:42.676761 [debug] [Thread-1 (]: On model.sumup.product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.product_agg"} */
alter table "merveyasa"."dbt_merve"."product_agg__dbt_tmp" rename to "product_agg"
[0m12:44:42.677476 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:44:42.695362 [debug] [Thread-1 (]: On model.sumup.product_agg: COMMIT
[0m12:44:42.695819 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m12:44:42.696195 [debug] [Thread-1 (]: On model.sumup.product_agg: COMMIT
[0m12:44:42.697744 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:44:42.706764 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m12:44:42.707215 [debug] [Thread-1 (]: On model.sumup.product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.product_agg"} */
drop view if exists "merveyasa"."dbt_merve"."product_agg__dbt_backup" cascade
[0m12:44:42.708921 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:44:42.710575 [debug] [Thread-1 (]: Timing info for model.sumup.product_agg (execute): 12:44:42.602975 => 12:44:42.710347
[0m12:44:42.710999 [debug] [Thread-1 (]: On model.sumup.product_agg: Close
[0m12:44:42.711925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c448845e-9153-43f2-a277-f4831967d22f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6585d0>]}
[0m12:44:42.712632 [info ] [Thread-1 (]: 1 of 7 OK created sql view model dbt_merve.product_agg ......................... [[32mCREATE VIEW[0m in 0.12s]
[0m12:44:42.713506 [debug] [Thread-1 (]: Finished running node model.sumup.product_agg
[0m12:44:42.714004 [debug] [Thread-1 (]: Began running node model.sumup.store_transaction_view
[0m12:44:42.714857 [info ] [Thread-1 (]: 2 of 7 START sql view model dbt_merve.store_transaction_view ................... [RUN]
[0m12:44:42.715741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.product_agg, now model.sumup.store_transaction_view)
[0m12:44:42.716192 [debug] [Thread-1 (]: Began compiling node model.sumup.store_transaction_view
[0m12:44:42.718192 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.store_transaction_view"
[0m12:44:42.719514 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_view (compile): 12:44:42.716566 => 12:44:42.719077
[0m12:44:42.719980 [debug] [Thread-1 (]: Began executing node model.sumup.store_transaction_view
[0m12:44:42.725650 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.store_transaction_view"
[0m12:44:42.726913 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m12:44:42.727636 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: BEGIN
[0m12:44:42.728063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:42.734221 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:44:42.734733 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m12:44:42.735190 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */

  create view "merveyasa"."dbt_merve"."store_transaction_view__dbt_tmp"
    
    
  as (
    WITH store_transactions AS
(
SELECT
    s.store_id,
    s.store_typology,
    s.store_country,
    t.product_name,
    t.product_sku,
    t.category_name,
    t.transaction_amount,
    t.transaction_status,
    t.transaction_happened_at,
    d.device_type
FROM
    transactions t
JOIN devices d ON t.device_id = d.device_id
JOIN stores s ON d.store_id = s.store_id
)

select * from store_transactions
  );
[0m12:44:42.741950 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:44:42.746171 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m12:44:42.746676 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */
alter table "merveyasa"."dbt_merve"."store_transaction_view" rename to "store_transaction_view__dbt_backup"
[0m12:44:42.747674 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:44:42.750923 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m12:44:42.751591 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */
alter table "merveyasa"."dbt_merve"."store_transaction_view__dbt_tmp" rename to "store_transaction_view"
[0m12:44:42.752654 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:44:42.756591 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: COMMIT
[0m12:44:42.757194 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m12:44:42.757640 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: COMMIT
[0m12:44:42.758813 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:44:42.762364 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m12:44:42.762861 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */
drop view if exists "merveyasa"."dbt_merve"."store_transaction_view__dbt_backup" cascade
[0m12:44:42.766064 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:44:42.768030 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_view (execute): 12:44:42.720275 => 12:44:42.767781
[0m12:44:42.768499 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: Close
[0m12:44:42.769724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c448845e-9153-43f2-a277-f4831967d22f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5c3f50>]}
[0m12:44:42.770848 [info ] [Thread-1 (]: 2 of 7 OK created sql view model dbt_merve.store_transaction_view .............. [[32mCREATE VIEW[0m in 0.05s]
[0m12:44:42.772178 [debug] [Thread-1 (]: Finished running node model.sumup.store_transaction_view
[0m12:44:42.774211 [debug] [Thread-1 (]: Began running node model.sumup.avg_transaction_amount
[0m12:44:42.774912 [info ] [Thread-1 (]: 3 of 7 START sql view model dbt_merve.avg_transaction_amount ................... [RUN]
[0m12:44:42.775755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.store_transaction_view, now model.sumup.avg_transaction_amount)
[0m12:44:42.776208 [debug] [Thread-1 (]: Began compiling node model.sumup.avg_transaction_amount
[0m12:44:42.781084 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.avg_transaction_amount"
[0m12:44:42.784492 [debug] [Thread-1 (]: Timing info for model.sumup.avg_transaction_amount (compile): 12:44:42.776506 => 12:44:42.783772
[0m12:44:42.785767 [debug] [Thread-1 (]: Began executing node model.sumup.avg_transaction_amount
[0m12:44:42.852484 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.avg_transaction_amount"
[0m12:44:42.853889 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m12:44:42.854542 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: BEGIN
[0m12:44:42.855139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:42.864378 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:44:42.865174 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m12:44:42.865857 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.avg_transaction_amount"} */

  create view "merveyasa"."dbt_merve"."avg_transaction_amount__dbt_tmp"
    
    
  as (
    
    SELECT store_typology, store_country, AVG(transaction_amount) AS average_transaction_amount
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
    GROUP BY store_typology, store_country

  );
[0m12:44:42.869991 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:44:42.874092 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m12:44:42.874657 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.avg_transaction_amount"} */
alter table "merveyasa"."dbt_merve"."avg_transaction_amount__dbt_tmp" rename to "avg_transaction_amount"
[0m12:44:42.875758 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:44:42.878046 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: COMMIT
[0m12:44:42.878573 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m12:44:42.879028 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: COMMIT
[0m12:44:42.880601 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:44:42.884185 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m12:44:42.884700 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.avg_transaction_amount"} */
drop view if exists "merveyasa"."dbt_merve"."avg_transaction_amount__dbt_backup" cascade
[0m12:44:42.885466 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:44:42.887288 [debug] [Thread-1 (]: Timing info for model.sumup.avg_transaction_amount (execute): 12:44:42.786462 => 12:44:42.887020
[0m12:44:42.887783 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: Close
[0m12:44:42.888835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c448845e-9153-43f2-a277-f4831967d22f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec9a590>]}
[0m12:44:42.889667 [info ] [Thread-1 (]: 3 of 7 OK created sql view model dbt_merve.avg_transaction_amount .............. [[32mCREATE VIEW[0m in 0.11s]
[0m12:44:42.890589 [debug] [Thread-1 (]: Finished running node model.sumup.avg_transaction_amount
[0m12:44:42.891153 [debug] [Thread-1 (]: Began running node model.sumup.pct_transaction
[0m12:44:42.892174 [info ] [Thread-1 (]: 4 of 7 START sql view model dbt_merve.pct_transaction .......................... [RUN]
[0m12:44:42.893320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.avg_transaction_amount, now model.sumup.pct_transaction)
[0m12:44:42.893891 [debug] [Thread-1 (]: Began compiling node model.sumup.pct_transaction
[0m12:44:42.897703 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.pct_transaction"
[0m12:44:42.903609 [debug] [Thread-1 (]: Timing info for model.sumup.pct_transaction (compile): 12:44:42.894231 => 12:44:42.899629
[0m12:44:42.904791 [debug] [Thread-1 (]: Began executing node model.sumup.pct_transaction
[0m12:44:42.912250 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.pct_transaction"
[0m12:44:42.913403 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m12:44:42.913886 [debug] [Thread-1 (]: On model.sumup.pct_transaction: BEGIN
[0m12:44:42.914323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:42.923522 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:44:42.926743 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m12:44:42.927343 [debug] [Thread-1 (]: On model.sumup.pct_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.pct_transaction"} */

  create view "merveyasa"."dbt_merve"."pct_transaction__dbt_tmp"
    
    
  as (
    WITH pct_transaction AS (
    SELECT device_type, COUNT(*) * 100.0 / SUM(COUNT(*)) OVER () AS percentage
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
    GROUP BY device_type
)
SELECT * FROM pct_transaction
  );
[0m12:44:42.931639 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:44:42.936443 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m12:44:42.937311 [debug] [Thread-1 (]: On model.sumup.pct_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.pct_transaction"} */
alter table "merveyasa"."dbt_merve"."pct_transaction__dbt_tmp" rename to "pct_transaction"
[0m12:44:42.938262 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:44:42.940673 [debug] [Thread-1 (]: On model.sumup.pct_transaction: COMMIT
[0m12:44:42.941189 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m12:44:42.941640 [debug] [Thread-1 (]: On model.sumup.pct_transaction: COMMIT
[0m12:44:42.943140 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:44:42.947839 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m12:44:42.948365 [debug] [Thread-1 (]: On model.sumup.pct_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.pct_transaction"} */
drop view if exists "merveyasa"."dbt_merve"."pct_transaction__dbt_backup" cascade
[0m12:44:42.949077 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:44:42.950988 [debug] [Thread-1 (]: Timing info for model.sumup.pct_transaction (execute): 12:44:42.905274 => 12:44:42.950731
[0m12:44:42.951470 [debug] [Thread-1 (]: On model.sumup.pct_transaction: Close
[0m12:44:42.952960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c448845e-9153-43f2-a277-f4831967d22f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec9a3d0>]}
[0m12:44:42.953982 [info ] [Thread-1 (]: 4 of 7 OK created sql view model dbt_merve.pct_transaction ..................... [[32mCREATE VIEW[0m in 0.06s]
[0m12:44:42.954749 [debug] [Thread-1 (]: Finished running node model.sumup.pct_transaction
[0m12:44:42.955280 [debug] [Thread-1 (]: Began running node model.sumup.store_transaction_first
[0m12:44:42.955808 [info ] [Thread-1 (]: 5 of 7 START sql view model dbt_merve.store_transaction_first .................. [RUN]
[0m12:44:42.956565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.pct_transaction, now model.sumup.store_transaction_first)
[0m12:44:42.957006 [debug] [Thread-1 (]: Began compiling node model.sumup.store_transaction_first
[0m12:44:42.960202 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.store_transaction_first"
[0m12:44:42.962173 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_first (compile): 12:44:42.957302 => 12:44:42.961563
[0m12:44:42.962696 [debug] [Thread-1 (]: Began executing node model.sumup.store_transaction_first
[0m12:44:42.969886 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.store_transaction_first"
[0m12:44:42.970955 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m12:44:42.971897 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: BEGIN
[0m12:44:42.972388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:42.986892 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:44:42.988175 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m12:44:42.989173 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_first"} */

  create view "merveyasa"."dbt_merve"."store_transaction_first__dbt_tmp"
    
    
  as (
    WITH store_first_five_transactions AS
(
SELECT
    store_id,
    AVG(time_diff) AS avg_time_diff
FROM (
    SELECT
        store_id,
        transaction_happened_at - LAG(transaction_happened_at, 1) OVER (PARTITION BY store_id ORDER BY transaction_happened_at) AS time_diff,
        ROW_NUMBER() OVER (PARTITION BY store_id ORDER BY transaction_happened_at) AS rn
    FROM
        "merveyasa"."dbt_merve"."store_transaction_view"
) subquery
WHERE
    rn <= 5
GROUP BY
    store_id
)

SELECT * FROM store_first_five_transactions
  );
[0m12:44:42.994723 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:44:42.999384 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m12:44:42.999939 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_first"} */
alter table "merveyasa"."dbt_merve"."store_transaction_first__dbt_tmp" rename to "store_transaction_first"
[0m12:44:43.001121 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:44:43.003708 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: COMMIT
[0m12:44:43.004237 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m12:44:43.004687 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: COMMIT
[0m12:44:43.006405 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:44:43.011879 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m12:44:43.012744 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_first"} */
drop view if exists "merveyasa"."dbt_merve"."store_transaction_first__dbt_backup" cascade
[0m12:44:43.014004 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:44:43.016057 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_first (execute): 12:44:42.963145 => 12:44:43.015747
[0m12:44:43.016680 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: Close
[0m12:44:43.018013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c448845e-9153-43f2-a277-f4831967d22f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e570fd0>]}
[0m12:44:43.019051 [info ] [Thread-1 (]: 5 of 7 OK created sql view model dbt_merve.store_transaction_first ............. [[32mCREATE VIEW[0m in 0.06s]
[0m12:44:43.020131 [debug] [Thread-1 (]: Finished running node model.sumup.store_transaction_first
[0m12:44:43.020703 [debug] [Thread-1 (]: Began running node model.sumup.top_ten_products
[0m12:44:43.021664 [info ] [Thread-1 (]: 6 of 7 START sql view model dbt_merve.top_ten_products ......................... [RUN]
[0m12:44:43.022596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.store_transaction_first, now model.sumup.top_ten_products)
[0m12:44:43.023093 [debug] [Thread-1 (]: Began compiling node model.sumup.top_ten_products
[0m12:44:43.026572 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.top_ten_products"
[0m12:44:43.027954 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_products (compile): 12:44:43.023416 => 12:44:43.027460
[0m12:44:43.028489 [debug] [Thread-1 (]: Began executing node model.sumup.top_ten_products
[0m12:44:43.038003 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.top_ten_products"
[0m12:44:43.039222 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m12:44:43.039707 [debug] [Thread-1 (]: On model.sumup.top_ten_products: BEGIN
[0m12:44:43.040149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:43.047274 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:44:43.048098 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m12:44:43.048628 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */

  create view "merveyasa"."dbt_merve"."top_ten_products__dbt_tmp"
    
    
  as (
    WITH top_ten_products AS (
    SELECT product_name, COUNT(*) AS total_count_sold
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
    GROUP BY product_name
    ORDER BY total_count_sold DESC
    LIMIT 10
)
SELECT * FROM top_ten_products
  );
[0m12:44:43.052603 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:44:43.061800 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m12:44:43.062989 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */
alter table "merveyasa"."dbt_merve"."top_ten_products__dbt_tmp" rename to "top_ten_products"
[0m12:44:43.064696 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:44:43.067796 [debug] [Thread-1 (]: On model.sumup.top_ten_products: COMMIT
[0m12:44:43.068368 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m12:44:43.068898 [debug] [Thread-1 (]: On model.sumup.top_ten_products: COMMIT
[0m12:44:43.070253 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:44:43.073269 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m12:44:43.073684 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */
drop view if exists "merveyasa"."dbt_merve"."top_ten_products__dbt_backup" cascade
[0m12:44:43.074416 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:44:43.075808 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_products (execute): 12:44:43.028813 => 12:44:43.075605
[0m12:44:43.076180 [debug] [Thread-1 (]: On model.sumup.top_ten_products: Close
[0m12:44:43.077131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c448845e-9153-43f2-a277-f4831967d22f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e69a690>]}
[0m12:44:43.077883 [info ] [Thread-1 (]: 6 of 7 OK created sql view model dbt_merve.top_ten_products .................... [[32mCREATE VIEW[0m in 0.05s]
[0m12:44:43.078650 [debug] [Thread-1 (]: Finished running node model.sumup.top_ten_products
[0m12:44:43.079137 [debug] [Thread-1 (]: Began running node model.sumup.top_ten_stores
[0m12:44:43.080038 [info ] [Thread-1 (]: 7 of 7 START sql view model dbt_merve.top_ten_stores ........................... [RUN]
[0m12:44:43.080929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.top_ten_products, now model.sumup.top_ten_stores)
[0m12:44:43.081389 [debug] [Thread-1 (]: Began compiling node model.sumup.top_ten_stores
[0m12:44:43.084644 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.top_ten_stores"
[0m12:44:43.085706 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_stores (compile): 12:44:43.081771 => 12:44:43.085364
[0m12:44:43.086154 [debug] [Thread-1 (]: Began executing node model.sumup.top_ten_stores
[0m12:44:43.092569 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.top_ten_stores"
[0m12:44:43.093434 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m12:44:43.093825 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: BEGIN
[0m12:44:43.094169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:43.100434 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:44:43.100866 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m12:44:43.101239 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */

  create view "merveyasa"."dbt_merve"."top_ten_stores__dbt_tmp"
    
    
  as (
    WITH top_ten_stores AS (
    SELECT store_id, SUM(transaction_amount) AS total_transaction_amount
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
    GROUP BY store_id
    ORDER BY total_transaction_amount DESC
    LIMIT 10
)
SELECT * FROM top_ten_stores
  );
[0m12:44:43.105220 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:44:43.110635 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m12:44:43.111355 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */
alter table "merveyasa"."dbt_merve"."top_ten_stores__dbt_tmp" rename to "top_ten_stores"
[0m12:44:43.112548 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:44:43.115131 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: COMMIT
[0m12:44:43.115590 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m12:44:43.115977 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: COMMIT
[0m12:44:43.117227 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:44:43.121699 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m12:44:43.122240 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */
drop view if exists "merveyasa"."dbt_merve"."top_ten_stores__dbt_backup" cascade
[0m12:44:43.122972 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:44:43.124395 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_stores (execute): 12:44:43.086433 => 12:44:43.124193
[0m12:44:43.124771 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: Close
[0m12:44:43.125590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c448845e-9153-43f2-a277-f4831967d22f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dca8b10>]}
[0m12:44:43.126219 [info ] [Thread-1 (]: 7 of 7 OK created sql view model dbt_merve.top_ten_stores ...................... [[32mCREATE VIEW[0m in 0.04s]
[0m12:44:43.126951 [debug] [Thread-1 (]: Finished running node model.sumup.top_ten_stores
[0m12:44:43.129339 [debug] [MainThread]: Using postgres connection "master"
[0m12:44:43.129946 [debug] [MainThread]: On master: BEGIN
[0m12:44:43.130361 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:44:43.137056 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:44:43.137519 [debug] [MainThread]: On master: COMMIT
[0m12:44:43.138133 [debug] [MainThread]: Using postgres connection "master"
[0m12:44:43.138558 [debug] [MainThread]: On master: COMMIT
[0m12:44:43.139739 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:44:43.140469 [debug] [MainThread]: On master: Close
[0m12:44:43.141443 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:44:43.142040 [debug] [MainThread]: Connection 'model.sumup.top_ten_stores' was properly closed.
[0m12:44:43.142463 [info ] [MainThread]: 
[0m12:44:43.142871 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m12:44:43.144660 [debug] [MainThread]: Command end result
[0m12:44:43.153851 [info ] [MainThread]: 
[0m12:44:43.154674 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:44:43.155060 [info ] [MainThread]: 
[0m12:44:43.155439 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:44:43.156115 [debug] [MainThread]: Command `dbt run` succeeded at 12:44:43.155968 after 1.84 seconds
[0m12:44:43.156577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094cba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d206bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0555d0>]}
[0m12:44:43.157068 [debug] [MainThread]: Flushing usage events
[0m12:45:17.511339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110abff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aa8d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d96990>]}


============================== 12:45:17.517438 | 66b3a8f1-94a3-48e1-950f-9771f18d3c6f ==============================
[0m12:45:17.517438 [info ] [MainThread]: Running with dbt=1.6.0
[0m12:45:17.518233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m avg_transaction_amount', 'send_anonymous_usage_stats': 'True'}
[0m12:45:17.617721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66b3a8f1-94a3-48e1-950f-9771f18d3c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110ade50>]}
[0m12:45:17.626788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66b3a8f1-94a3-48e1-950f-9771f18d3c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d7a8d0>]}
[0m12:45:17.627509 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m12:45:17.649096 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m12:45:17.695230 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:45:17.696268 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:45:17.697927 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.my_project.store_transaction_view
- models.my_project.avg_transaction_amount
- models.my_project.product_agg
- models.my_project
- models.my_project.store_transaction_first
[0m12:45:17.709462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66b3a8f1-94a3-48e1-950f-9771f18d3c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110acb650>]}
[0m12:45:17.727981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66b3a8f1-94a3-48e1-950f-9771f18d3c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11139f690>]}
[0m12:45:17.728619 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m12:45:17.729223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66b3a8f1-94a3-48e1-950f-9771f18d3c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f33b10>]}
[0m12:45:17.731076 [info ] [MainThread]: 
[0m12:45:17.732331 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:45:17.735139 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m12:45:17.763946 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m12:45:17.764524 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m12:45:17.764999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:17.807642 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:45:17.809730 [debug] [ThreadPool]: On list_merveyasa: Close
[0m12:45:17.812124 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m12:45:17.820016 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m12:45:17.820490 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m12:45:17.820864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:45:17.827530 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:45:17.827983 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m12:45:17.828396 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m12:45:17.832562 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:45:17.834107 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m12:45:17.834641 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m12:45:17.841066 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:17.841487 [debug] [MainThread]: On master: BEGIN
[0m12:45:17.841835 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:45:17.847927 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:45:17.848341 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:17.848789 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:45:17.868150 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m12:45:17.870572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66b3a8f1-94a3-48e1-950f-9771f18d3c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f33b10>]}
[0m12:45:17.871029 [debug] [MainThread]: On master: ROLLBACK
[0m12:45:17.871622 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:17.871967 [debug] [MainThread]: On master: BEGIN
[0m12:45:17.872584 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:45:17.873000 [debug] [MainThread]: On master: COMMIT
[0m12:45:17.873328 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:17.873641 [debug] [MainThread]: On master: COMMIT
[0m12:45:17.874166 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:45:17.874522 [debug] [MainThread]: On master: Close
[0m12:45:17.875337 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:45:17.875870 [info ] [MainThread]: 
[0m12:45:17.878509 [debug] [Thread-1 (]: Began running node model.sumup.avg_transaction_amount
[0m12:45:17.879064 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.avg_transaction_amount ................... [RUN]
[0m12:45:17.879846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.avg_transaction_amount)
[0m12:45:17.880401 [debug] [Thread-1 (]: Began compiling node model.sumup.avg_transaction_amount
[0m12:45:17.899810 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.avg_transaction_amount"
[0m12:45:17.901430 [debug] [Thread-1 (]: Timing info for model.sumup.avg_transaction_amount (compile): 12:45:17.880719 => 12:45:17.900713
[0m12:45:17.902524 [debug] [Thread-1 (]: Began executing node model.sumup.avg_transaction_amount
[0m12:45:17.948904 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.avg_transaction_amount"
[0m12:45:17.949890 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m12:45:17.950373 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: BEGIN
[0m12:45:17.950770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:17.957694 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:17.958312 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m12:45:17.958774 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.avg_transaction_amount"} */

  create view "merveyasa"."dbt_merve"."avg_transaction_amount__dbt_tmp"
    
    
  as (
    
    SELECT store_typology, store_country, AVG(transaction_amount) AS average_transaction_amount
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
    GROUP BY store_typology, store_country

  );
[0m12:45:17.963159 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:45:17.971927 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m12:45:17.972413 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.avg_transaction_amount"} */
alter table "merveyasa"."dbt_merve"."avg_transaction_amount" rename to "avg_transaction_amount__dbt_backup"
[0m12:45:17.973231 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:17.977435 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m12:45:17.977899 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.avg_transaction_amount"} */
alter table "merveyasa"."dbt_merve"."avg_transaction_amount__dbt_tmp" rename to "avg_transaction_amount"
[0m12:45:17.978707 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:17.996501 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: COMMIT
[0m12:45:17.996963 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m12:45:17.997342 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: COMMIT
[0m12:45:17.998815 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:45:18.008546 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m12:45:18.009016 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.avg_transaction_amount"} */
drop view if exists "merveyasa"."dbt_merve"."avg_transaction_amount__dbt_backup" cascade
[0m12:45:18.010663 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:45:18.012541 [debug] [Thread-1 (]: Timing info for model.sumup.avg_transaction_amount (execute): 12:45:17.903111 => 12:45:18.012284
[0m12:45:18.012982 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: Close
[0m12:45:18.013962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66b3a8f1-94a3-48e1-950f-9771f18d3c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dfb550>]}
[0m12:45:18.014723 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_merve.avg_transaction_amount .............. [[32mCREATE VIEW[0m in 0.13s]
[0m12:45:18.015551 [debug] [Thread-1 (]: Finished running node model.sumup.avg_transaction_amount
[0m12:45:18.017594 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:18.017965 [debug] [MainThread]: On master: BEGIN
[0m12:45:18.018281 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:45:18.026341 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:45:18.027108 [debug] [MainThread]: On master: COMMIT
[0m12:45:18.027552 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:18.028258 [debug] [MainThread]: On master: COMMIT
[0m12:45:18.029347 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:45:18.030000 [debug] [MainThread]: On master: Close
[0m12:45:18.031105 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:18.031554 [debug] [MainThread]: Connection 'model.sumup.avg_transaction_amount' was properly closed.
[0m12:45:18.031970 [info ] [MainThread]: 
[0m12:45:18.032567 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m12:45:18.033447 [debug] [MainThread]: Command end result
[0m12:45:18.044578 [info ] [MainThread]: 
[0m12:45:18.045139 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:45:18.045571 [info ] [MainThread]: 
[0m12:45:18.046032 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:45:18.046820 [debug] [MainThread]: Command `dbt run` succeeded at 12:45:18.046674 after 0.56 seconds
[0m12:45:18.047312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b75110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c32b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e5a4d0>]}
[0m12:45:18.047776 [debug] [MainThread]: Flushing usage events
[0m16:27:22.210531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd32650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0bc490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0526d0>]}


============================== 16:27:22.221823 | ba79cfc2-3907-44ff-8bd5-fa89ce55a637 ==============================
[0m16:27:22.221823 [info ] [MainThread]: Running with dbt=1.6.0
[0m16:27:22.223020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m pct_transaction', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:27:22.459143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba79cfc2-3907-44ff-8bd5-fa89ce55a637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd32290>]}
[0m16:27:22.468595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba79cfc2-3907-44ff-8bd5-fa89ce55a637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd31a10>]}
[0m16:27:22.471195 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m16:27:22.505958 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m16:27:22.524963 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:27:22.525590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ba79cfc2-3907-44ff-8bd5-fa89ce55a637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfb7e90>]}
[0m16:27:23.338167 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.sumup.inc_first_five_transaction' (models/inc_first_five_transaction.sql) depends on a node named 'first_five_transactions' which was not found
[0m16:27:23.339226 [debug] [MainThread]: Command `dbt run` failed at 16:27:23.339002 after 1.22 seconds
[0m16:27:23.339678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0bc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf19190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108565750>]}
[0m16:27:23.340109 [debug] [MainThread]: Flushing usage events
[0m16:28:53.940950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10661fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10662c810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a4750>]}


============================== 16:28:53.947038 | de144900-6222-450d-9846-9052904d8bbb ==============================
[0m16:28:53.947038 [info ] [MainThread]: Running with dbt=1.6.0
[0m16:28:53.947949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m16:28:54.045009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de144900-6222-450d-9846-9052904d8bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106415950>]}
[0m16:28:54.053980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de144900-6222-450d-9846-9052904d8bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c06050>]}
[0m16:28:54.054701 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m16:28:54.076199 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m16:28:54.090445 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:28:54.091722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'de144900-6222-450d-9846-9052904d8bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066343d0>]}
[0m16:28:54.865186 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.my_project.product_agg
- models.my_project
- models.my_project.store_transaction_first
- models.my_project.store_transaction_view
- models.my_project.avg_transaction_amount
- models.my_project.pct_transaction
- models.my_project.top_ten_products
- models.my_project.top_ten_stores
- models.my_project.inc_first_five_transaction
[0m16:28:54.871005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de144900-6222-450d-9846-9052904d8bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d89e90>]}
[0m16:28:54.896630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de144900-6222-450d-9846-9052904d8bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d36310>]}
[0m16:28:54.897828 [info ] [MainThread]: Found 7 models, 13 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m16:28:54.898773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de144900-6222-450d-9846-9052904d8bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106371690>]}
[0m16:28:54.901480 [info ] [MainThread]: 
[0m16:28:54.902661 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:28:54.904447 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m16:28:54.921047 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m16:28:54.921611 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m16:28:54.922036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:54.983989 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:28:54.985867 [debug] [ThreadPool]: On list_merveyasa: Close
[0m16:28:54.989168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m16:28:54.997120 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m16:28:54.997599 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m16:28:54.998010 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:28:55.010067 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:28:55.010549 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m16:28:55.010925 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m16:28:55.019791 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:28:55.021412 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m16:28:55.021995 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m16:28:55.079968 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:55.080487 [debug] [MainThread]: On master: BEGIN
[0m16:28:55.080816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:28:55.086624 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:28:55.087056 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:55.087485 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:28:55.116907 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m16:28:55.119532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de144900-6222-450d-9846-9052904d8bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104752d90>]}
[0m16:28:55.120021 [debug] [MainThread]: On master: ROLLBACK
[0m16:28:55.120523 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:55.120855 [debug] [MainThread]: On master: BEGIN
[0m16:28:55.121370 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:28:55.121713 [debug] [MainThread]: On master: COMMIT
[0m16:28:55.122036 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:55.122350 [debug] [MainThread]: On master: COMMIT
[0m16:28:55.122761 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:28:55.123095 [debug] [MainThread]: On master: Close
[0m16:28:55.123844 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:28:55.124271 [info ] [MainThread]: 
[0m16:28:55.127447 [debug] [Thread-1 (]: Began running node model.sumup.store_transaction_view
[0m16:28:55.128075 [info ] [Thread-1 (]: 1 of 7 START sql view model dbt_merve.store_transaction_view ................... [RUN]
[0m16:28:55.129346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.store_transaction_view)
[0m16:28:55.129996 [debug] [Thread-1 (]: Began compiling node model.sumup.store_transaction_view
[0m16:28:55.141037 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.store_transaction_view"
[0m16:28:55.143843 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_view (compile): 16:28:55.130373 => 16:28:55.143165
[0m16:28:55.144505 [debug] [Thread-1 (]: Began executing node model.sumup.store_transaction_view
[0m16:28:55.200044 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.store_transaction_view"
[0m16:28:55.201386 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m16:28:55.201925 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: BEGIN
[0m16:28:55.202362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:55.209029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:28:55.209583 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m16:28:55.210060 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */

  create view "merveyasa"."dbt_merve"."store_transaction_view__dbt_tmp"
    
    
  as (
    

WITH store_transactions AS
(
SELECT
    s.store_id,
    s.store_typology,
    s.store_country,
    t.product_name,
    t.product_sku,
    t.category_name,
    t.transaction_amount,
    t.transaction_status,
    t.transaction_happened_at,
    d.device_type
FROM
    transactions t
JOIN devices d ON t.device_id = d.device_id
JOIN stores s ON d.store_id = s.store_id
)

select * from store_transactions
  );
[0m16:28:55.224153 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:28:55.231187 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m16:28:55.231751 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */
alter table "merveyasa"."dbt_merve"."store_transaction_view" rename to "store_transaction_view__dbt_backup"
[0m16:28:55.234272 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:28:55.237654 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m16:28:55.238080 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */
alter table "merveyasa"."dbt_merve"."store_transaction_view__dbt_tmp" rename to "store_transaction_view"
[0m16:28:55.239544 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:28:55.257041 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: COMMIT
[0m16:28:55.257620 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m16:28:55.258025 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: COMMIT
[0m16:28:55.259303 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:28:55.268077 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m16:28:55.268658 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */
drop view if exists "merveyasa"."dbt_merve"."store_transaction_view__dbt_backup" cascade
[0m16:28:55.273406 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:28:55.275332 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_view (execute): 16:28:55.144891 => 16:28:55.275084
[0m16:28:55.275789 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: Close
[0m16:28:55.276735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de144900-6222-450d-9846-9052904d8bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069363d0>]}
[0m16:28:55.277606 [info ] [Thread-1 (]: 1 of 7 OK created sql view model dbt_merve.store_transaction_view .............. [[32mCREATE VIEW[0m in 0.15s]
[0m16:28:55.278428 [debug] [Thread-1 (]: Finished running node model.sumup.store_transaction_view
[0m16:28:55.280156 [debug] [Thread-1 (]: Began running node model.sumup.avg_transaction_amount
[0m16:28:55.280739 [info ] [Thread-1 (]: 2 of 7 START sql incremental model dbt_merve.avg_transaction_amount ............ [RUN]
[0m16:28:55.281604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.store_transaction_view, now model.sumup.avg_transaction_amount)
[0m16:28:55.282160 [debug] [Thread-1 (]: Began compiling node model.sumup.avg_transaction_amount
[0m16:28:55.287330 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.avg_transaction_amount"
[0m16:28:55.289857 [debug] [Thread-1 (]: Timing info for model.sumup.avg_transaction_amount (compile): 16:28:55.282535 => 16:28:55.289236
[0m16:28:55.290570 [debug] [Thread-1 (]: Began executing node model.sumup.avg_transaction_amount
[0m16:28:55.344137 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.avg_transaction_amount"
[0m16:28:55.345262 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m16:28:55.345710 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: BEGIN
[0m16:28:55.346111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:55.352490 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:28:55.353022 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m16:28:55.353463 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.avg_transaction_amount"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."avg_transaction_amount"
  
  
    as
  
  (
    


    SELECT store_typology, store_country, AVG(transaction_amount) AS average_transaction_amount
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
    GROUP BY store_typology, store_country

  );
  
  
[0m16:28:55.478986 [debug] [Thread-1 (]: SQL status: SELECT 74 in 0.0 seconds
[0m16:28:55.490211 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: COMMIT
[0m16:28:55.491106 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m16:28:55.491909 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: COMMIT
[0m16:28:55.493919 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:28:55.495797 [debug] [Thread-1 (]: Timing info for model.sumup.avg_transaction_amount (execute): 16:28:55.291624 => 16:28:55.495449
[0m16:28:55.496617 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: Close
[0m16:28:55.498065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de144900-6222-450d-9846-9052904d8bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c39c90>]}
[0m16:28:55.498863 [info ] [Thread-1 (]: 2 of 7 OK created sql incremental model dbt_merve.avg_transaction_amount ....... [[32mSELECT 74[0m in 0.22s]
[0m16:28:55.499961 [debug] [Thread-1 (]: Finished running node model.sumup.avg_transaction_amount
[0m16:28:55.500557 [debug] [Thread-1 (]: Began running node model.sumup.pct_transaction
[0m16:28:55.501528 [info ] [Thread-1 (]: 3 of 7 START sql view model dbt_merve.pct_transaction .......................... [RUN]
[0m16:28:55.502558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.avg_transaction_amount, now model.sumup.pct_transaction)
[0m16:28:55.503156 [debug] [Thread-1 (]: Began compiling node model.sumup.pct_transaction
[0m16:28:55.508669 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.pct_transaction"
[0m16:28:55.512991 [debug] [Thread-1 (]: Timing info for model.sumup.pct_transaction (compile): 16:28:55.503478 => 16:28:55.510913
[0m16:28:55.513789 [debug] [Thread-1 (]: Began executing node model.sumup.pct_transaction
[0m16:28:55.520433 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.pct_transaction"
[0m16:28:55.522374 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m16:28:55.523417 [debug] [Thread-1 (]: On model.sumup.pct_transaction: BEGIN
[0m16:28:55.524514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:55.532142 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:28:55.532926 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m16:28:55.533685 [debug] [Thread-1 (]: On model.sumup.pct_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.pct_transaction"} */

  create view "merveyasa"."dbt_merve"."pct_transaction__dbt_tmp"
    
    
  as (
    

WITH pct_transaction AS (
    SELECT device_type, COUNT(*) * 100.0 / SUM(COUNT(*)) OVER () AS percentage
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
    GROUP BY device_type
)
SELECT * FROM pct_transaction
ORDER BY device_type
  );
[0m16:28:55.550540 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:28:55.556026 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m16:28:55.556545 [debug] [Thread-1 (]: On model.sumup.pct_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.pct_transaction"} */
alter table "merveyasa"."dbt_merve"."pct_transaction__dbt_tmp" rename to "pct_transaction"
[0m16:28:55.557482 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:28:55.559470 [debug] [Thread-1 (]: On model.sumup.pct_transaction: COMMIT
[0m16:28:55.560293 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m16:28:55.560783 [debug] [Thread-1 (]: On model.sumup.pct_transaction: COMMIT
[0m16:28:55.562377 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:28:55.567631 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m16:28:55.568565 [debug] [Thread-1 (]: On model.sumup.pct_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.pct_transaction"} */
drop view if exists "merveyasa"."dbt_merve"."pct_transaction__dbt_backup" cascade
[0m16:28:55.570139 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:28:55.572105 [debug] [Thread-1 (]: Timing info for model.sumup.pct_transaction (execute): 16:28:55.514261 => 16:28:55.571869
[0m16:28:55.572553 [debug] [Thread-1 (]: On model.sumup.pct_transaction: Close
[0m16:28:55.573491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de144900-6222-450d-9846-9052904d8bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10692f650>]}
[0m16:28:55.574420 [info ] [Thread-1 (]: 3 of 7 OK created sql view model dbt_merve.pct_transaction ..................... [[32mCREATE VIEW[0m in 0.07s]
[0m16:28:55.575772 [debug] [Thread-1 (]: Finished running node model.sumup.pct_transaction
[0m16:28:55.576812 [debug] [Thread-1 (]: Began running node model.sumup.store_transaction_first
[0m16:28:55.578470 [info ] [Thread-1 (]: 4 of 7 START sql view model dbt_merve.store_transaction_first .................. [RUN]
[0m16:28:55.580207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.pct_transaction, now model.sumup.store_transaction_first)
[0m16:28:55.581224 [debug] [Thread-1 (]: Began compiling node model.sumup.store_transaction_first
[0m16:28:55.587409 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.store_transaction_first"
[0m16:28:55.590007 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_first (compile): 16:28:55.581770 => 16:28:55.589418
[0m16:28:55.590828 [debug] [Thread-1 (]: Began executing node model.sumup.store_transaction_first
[0m16:28:55.597075 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.store_transaction_first"
[0m16:28:55.598202 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m16:28:55.598984 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: BEGIN
[0m16:28:55.599489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:55.609197 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:28:55.610082 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m16:28:55.611205 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_first"} */

  create view "merveyasa"."dbt_merve"."store_transaction_first__dbt_tmp"
    
    
  as (
    

WITH numbered_transactions AS (
    SELECT
        store_id,
        transaction_happened_at,
        ROW_NUMBER() OVER (PARTITION BY store_id ORDER BY transaction_happened_at) AS rn
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
)
SELECT
    store_id,
    transaction_happened_at
FROM numbered_transactions
WHERE rn <= 5
  );
[0m16:28:55.617919 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:28:55.623401 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m16:28:55.624405 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_first"} */
alter table "merveyasa"."dbt_merve"."store_transaction_first__dbt_tmp" rename to "store_transaction_first"
[0m16:28:55.625708 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:28:55.630461 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: COMMIT
[0m16:28:55.631415 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m16:28:55.631888 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: COMMIT
[0m16:28:55.632863 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:28:55.636280 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m16:28:55.636794 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_first"} */
drop view if exists "merveyasa"."dbt_merve"."store_transaction_first__dbt_backup" cascade
[0m16:28:55.637589 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:28:55.640113 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_first (execute): 16:28:55.591224 => 16:28:55.639826
[0m16:28:55.640786 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: Close
[0m16:28:55.642082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de144900-6222-450d-9846-9052904d8bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c3b190>]}
[0m16:28:55.643351 [info ] [Thread-1 (]: 4 of 7 OK created sql view model dbt_merve.store_transaction_first ............. [[32mCREATE VIEW[0m in 0.06s]
[0m16:28:55.644441 [debug] [Thread-1 (]: Finished running node model.sumup.store_transaction_first
[0m16:28:55.645048 [debug] [Thread-1 (]: Began running node model.sumup.top_ten_products
[0m16:28:55.646568 [info ] [Thread-1 (]: 5 of 7 START sql view model dbt_merve.top_ten_products ......................... [RUN]
[0m16:28:55.647588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.store_transaction_first, now model.sumup.top_ten_products)
[0m16:28:55.648097 [debug] [Thread-1 (]: Began compiling node model.sumup.top_ten_products
[0m16:28:55.654925 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.top_ten_products"
[0m16:28:55.659006 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_products (compile): 16:28:55.648422 => 16:28:55.658167
[0m16:28:55.660228 [debug] [Thread-1 (]: Began executing node model.sumup.top_ten_products
[0m16:28:55.674094 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.top_ten_products"
[0m16:28:55.675897 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m16:28:55.676642 [debug] [Thread-1 (]: On model.sumup.top_ten_products: BEGIN
[0m16:28:55.677512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:55.687450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:28:55.688239 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m16:28:55.689290 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */

  create view "merveyasa"."dbt_merve"."top_ten_products__dbt_tmp"
    
    
  as (
    

WITH top_ten_products AS (
    SELECT product_name, COUNT(*) AS total_count_sold
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
    GROUP BY product_name
    ORDER BY total_count_sold DESC
    LIMIT 10
)
SELECT * FROM top_ten_products
  );
[0m16:28:55.693943 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:28:55.697219 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m16:28:55.697698 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */
alter table "merveyasa"."dbt_merve"."top_ten_products__dbt_tmp" rename to "top_ten_products"
[0m16:28:55.698544 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:28:55.700246 [debug] [Thread-1 (]: On model.sumup.top_ten_products: COMMIT
[0m16:28:55.700622 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m16:28:55.700971 [debug] [Thread-1 (]: On model.sumup.top_ten_products: COMMIT
[0m16:28:55.701996 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:28:55.705037 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m16:28:55.705443 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */
drop view if exists "merveyasa"."dbt_merve"."top_ten_products__dbt_backup" cascade
[0m16:28:55.706179 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:28:55.707584 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_products (execute): 16:28:55.660926 => 16:28:55.707381
[0m16:28:55.707965 [debug] [Thread-1 (]: On model.sumup.top_ten_products: Close
[0m16:28:55.708853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de144900-6222-450d-9846-9052904d8bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e0e10>]}
[0m16:28:55.709584 [info ] [Thread-1 (]: 5 of 7 OK created sql view model dbt_merve.top_ten_products .................... [[32mCREATE VIEW[0m in 0.06s]
[0m16:28:55.710378 [debug] [Thread-1 (]: Finished running node model.sumup.top_ten_products
[0m16:28:55.711054 [debug] [Thread-1 (]: Began running node model.sumup.top_ten_stores
[0m16:28:55.712088 [info ] [Thread-1 (]: 6 of 7 START sql view model dbt_merve.top_ten_stores ........................... [RUN]
[0m16:28:55.713032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.top_ten_products, now model.sumup.top_ten_stores)
[0m16:28:55.713672 [debug] [Thread-1 (]: Began compiling node model.sumup.top_ten_stores
[0m16:28:55.717226 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.top_ten_stores"
[0m16:28:55.718592 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_stores (compile): 16:28:55.713959 => 16:28:55.718281
[0m16:28:55.719061 [debug] [Thread-1 (]: Began executing node model.sumup.top_ten_stores
[0m16:28:55.725960 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.top_ten_stores"
[0m16:28:55.726869 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m16:28:55.727322 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: BEGIN
[0m16:28:55.727744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:55.735646 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:28:55.736586 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m16:28:55.737549 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */

  create view "merveyasa"."dbt_merve"."top_ten_stores__dbt_tmp"
    
    
  as (
    

WITH top_ten_stores AS (
    SELECT store_id, SUM(transaction_amount) AS total_transaction_amount
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
    GROUP BY store_id
    ORDER BY total_transaction_amount DESC
    LIMIT 10
)
SELECT * FROM top_ten_stores
  );
[0m16:28:55.742433 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:28:55.747688 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m16:28:55.748412 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */
alter table "merveyasa"."dbt_merve"."top_ten_stores__dbt_tmp" rename to "top_ten_stores"
[0m16:28:55.749508 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:28:55.751644 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: COMMIT
[0m16:28:55.752127 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m16:28:55.752579 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: COMMIT
[0m16:28:55.753671 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:28:55.757516 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m16:28:55.758157 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */
drop view if exists "merveyasa"."dbt_merve"."top_ten_stores__dbt_backup" cascade
[0m16:28:55.758921 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m16:28:55.760789 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_stores (execute): 16:28:55.719343 => 16:28:55.760414
[0m16:28:55.761304 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: Close
[0m16:28:55.764029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de144900-6222-450d-9846-9052904d8bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c29150>]}
[0m16:28:55.765203 [info ] [Thread-1 (]: 6 of 7 OK created sql view model dbt_merve.top_ten_stores ...................... [[32mCREATE VIEW[0m in 0.05s]
[0m16:28:55.766109 [debug] [Thread-1 (]: Finished running node model.sumup.top_ten_stores
[0m16:28:55.766667 [debug] [Thread-1 (]: Began running node model.sumup.inc_first_five_transaction
[0m16:28:55.767686 [info ] [Thread-1 (]: 7 of 7 START sql incremental model dbt_merve.inc_first_five_transaction ........ [RUN]
[0m16:28:55.768762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.top_ten_stores, now model.sumup.inc_first_five_transaction)
[0m16:28:55.769517 [debug] [Thread-1 (]: Began compiling node model.sumup.inc_first_five_transaction
[0m16:28:55.776484 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.inc_first_five_transaction"
[0m16:28:55.777678 [debug] [Thread-1 (]: Timing info for model.sumup.inc_first_five_transaction (compile): 16:28:55.770015 => 16:28:55.777269
[0m16:28:55.778271 [debug] [Thread-1 (]: Began executing node model.sumup.inc_first_five_transaction
[0m16:28:55.787364 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.inc_first_five_transaction"
[0m16:28:55.788827 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m16:28:55.789452 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: BEGIN
[0m16:28:55.789921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:55.797463 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:28:55.798037 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m16:28:55.798470 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.inc_first_five_transaction"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."inc_first_five_transaction"
  
  
    as
  
  (
    


SELECT
    store_id,
    AVG(time_diff) AS avg_time_diff
FROM (
    SELECT
        store_id,
        transaction_happened_at - LAG(transaction_happened_at, 1) OVER (PARTITION BY store_id ORDER BY transaction_happened_at) AS time_diff
    FROM "merveyasa"."dbt_merve"."store_transaction_first"
) subquery
GROUP BY store_id

  );
  
  
[0m16:28:56.001837 [debug] [Thread-1 (]: SQL status: SELECT 87 in 0.0 seconds
[0m16:28:56.004049 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: COMMIT
[0m16:28:56.004461 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m16:28:56.004841 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: COMMIT
[0m16:28:56.005870 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:28:56.006915 [debug] [Thread-1 (]: Timing info for model.sumup.inc_first_five_transaction (execute): 16:28:55.778626 => 16:28:56.006694
[0m16:28:56.007315 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: Close
[0m16:28:56.008156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de144900-6222-450d-9846-9052904d8bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072ceb10>]}
[0m16:28:56.008797 [info ] [Thread-1 (]: 7 of 7 OK created sql incremental model dbt_merve.inc_first_five_transaction ... [[32mSELECT 87[0m in 0.24s]
[0m16:28:56.009600 [debug] [Thread-1 (]: Finished running node model.sumup.inc_first_five_transaction
[0m16:28:56.011969 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:56.012392 [debug] [MainThread]: On master: BEGIN
[0m16:28:56.012714 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:28:56.020000 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:28:56.020544 [debug] [MainThread]: On master: COMMIT
[0m16:28:56.020976 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:56.021529 [debug] [MainThread]: On master: COMMIT
[0m16:28:56.022398 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:28:56.023176 [debug] [MainThread]: On master: Close
[0m16:28:56.024472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:28:56.025237 [debug] [MainThread]: Connection 'model.sumup.inc_first_five_transaction' was properly closed.
[0m16:28:56.025710 [info ] [MainThread]: 
[0m16:28:56.026222 [info ] [MainThread]: Finished running 5 view models, 2 incremental models in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m16:28:56.028156 [debug] [MainThread]: Command end result
[0m16:28:56.040066 [info ] [MainThread]: 
[0m16:28:56.040979 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:28:56.041511 [info ] [MainThread]: 
[0m16:28:56.042094 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m16:28:56.043018 [debug] [MainThread]: Command `dbt run` succeeded at 16:28:56.042861 after 2.12 seconds
[0m16:28:56.043499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101c8bbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101c98650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101c98a50>]}
[0m16:28:56.043971 [debug] [MainThread]: Flushing usage events
[0m17:15:17.508918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f04150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eea6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107190c90>]}


============================== 17:15:17.518810 | fcbb3b0c-dad3-488d-b685-88fc7a426bf7 ==============================
[0m17:15:17.518810 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:15:17.520068 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:15:17.730675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcbb3b0c-dad3-488d-b685-88fc7a426bf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec5f10>]}
[0m17:15:17.740409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcbb3b0c-dad3-488d-b685-88fc7a426bf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107752ad0>]}
[0m17:15:17.741645 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:15:17.770039 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:15:17.789780 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:15:17.790600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fcbb3b0c-dad3-488d-b685-88fc7a426bf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107190ed0>]}
[0m17:15:18.604622 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test arguments must be a dict, got <class 'int'> (value 0)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m17:15:18.605531 [debug] [MainThread]: Command `dbt run` failed at 17:15:18.605363 after 1.14 seconds
[0m17:15:18.605970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10747fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f62d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee9f90>]}
[0m17:15:18.606373 [debug] [MainThread]: Flushing usage events
[0m17:17:52.613657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111612f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bcb150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11195d490>]}


============================== 17:17:52.620922 | 050746d3-6327-4405-a719-3ca24097a70e ==============================
[0m17:17:52.620922 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:17:52.621776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:17:52.750124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '050746d3-6327-4405-a719-3ca24097a70e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11161bf90>]}
[0m17:17:52.759589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '050746d3-6327-4405-a719-3ca24097a70e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e9cf90>]}
[0m17:17:52.760977 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:17:52.797002 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:17:52.814315 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:17:52.815871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '050746d3-6327-4405-a719-3ca24097a70e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119be3d0>]}
[0m17:17:53.621442 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test definition dictionary must have exactly one key, got [('greater_than', None), ('value', 0)] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m17:17:53.622372 [debug] [MainThread]: Command `dbt run` failed at 17:17:53.622200 after 1.03 seconds
[0m17:17:53.622816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119bded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118d6b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118d5c90>]}
[0m17:17:53.623225 [debug] [MainThread]: Flushing usage events
[0m17:23:48.793637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107201c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f04a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10748bf50>]}


============================== 17:23:48.806213 | a9137f6d-04bb-4430-a711-ad652575f158 ==============================
[0m17:23:48.806213 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:23:48.808111 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:23:49.017619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9137f6d-04bb-4430-a711-ad652575f158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10726bf90>]}
[0m17:23:49.029321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9137f6d-04bb-4430-a711-ad652575f158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f05310>]}
[0m17:23:49.030734 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:23:49.068923 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:23:49.088520 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:23:49.089244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a9137f6d-04bb-4430-a711-ad652575f158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed1d50>]}
[0m17:23:49.943838 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 8 unused configuration paths:
- models.my_project.store_transaction_view
- models.my_project.store_transaction_first
- models.my_project
- models.my_project.pct_transaction
- models.my_project.avg_transaction_amount
- models.my_project.inc_first_five_transaction
- models.my_project.top_ten_products
- models.my_project.top_ten_stores
[0m17:23:49.949896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9137f6d-04bb-4430-a711-ad652575f158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107812950>]}
[0m17:23:50.047467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9137f6d-04bb-4430-a711-ad652575f158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078bdb50>]}
[0m17:23:50.048281 [info ] [MainThread]: Found 7 models, 22 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:23:50.048887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9137f6d-04bb-4430-a711-ad652575f158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105173bd0>]}
[0m17:23:50.051964 [info ] [MainThread]: 
[0m17:23:50.053113 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:23:50.055513 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m17:23:50.069726 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m17:23:50.070446 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m17:23:50.070967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:50.147830 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:23:50.149670 [debug] [ThreadPool]: On list_merveyasa: Close
[0m17:23:50.151779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m17:23:50.157990 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:23:50.158408 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m17:23:50.158720 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:23:50.166481 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:23:50.167055 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:23:50.167549 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m17:23:50.175341 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m17:23:50.177192 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m17:23:50.177825 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m17:23:50.185873 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:50.186391 [debug] [MainThread]: On master: BEGIN
[0m17:23:50.186776 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:23:50.193599 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:23:50.194102 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:50.194622 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:23:50.223368 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m17:23:50.226025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9137f6d-04bb-4430-a711-ad652575f158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f69b90>]}
[0m17:23:50.226583 [debug] [MainThread]: On master: ROLLBACK
[0m17:23:50.227188 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:50.227584 [debug] [MainThread]: On master: BEGIN
[0m17:23:50.228213 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:23:50.228618 [debug] [MainThread]: On master: COMMIT
[0m17:23:50.228994 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:50.229353 [debug] [MainThread]: On master: COMMIT
[0m17:23:50.229875 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:23:50.230330 [debug] [MainThread]: On master: Close
[0m17:23:50.231404 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:23:50.232141 [info ] [MainThread]: 
[0m17:23:50.235254 [debug] [Thread-1 (]: Began running node model.sumup.store_transaction_view
[0m17:23:50.236258 [info ] [Thread-1 (]: 1 of 7 START sql view model dbt_merve.store_transaction_view ................... [RUN]
[0m17:23:50.237247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.store_transaction_view)
[0m17:23:50.237789 [debug] [Thread-1 (]: Began compiling node model.sumup.store_transaction_view
[0m17:23:50.247961 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.store_transaction_view"
[0m17:23:50.249112 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_view (compile): 17:23:50.238159 => 17:23:50.248763
[0m17:23:50.249641 [debug] [Thread-1 (]: Began executing node model.sumup.store_transaction_view
[0m17:23:50.337199 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.store_transaction_view"
[0m17:23:50.338307 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:23:50.338973 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: BEGIN
[0m17:23:50.339657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:50.346702 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:23:50.347281 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:23:50.347818 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */

  create view "merveyasa"."dbt_merve"."store_transaction_view__dbt_tmp"
    
    
  as (
    

WITH store_transactions AS
(
SELECT
    s.store_id,
    s.store_typology,
    s.store_country,
    t.product_name,
    t.product_sku,
    t.category_name,
    t.transaction_amount,
    t.transaction_status,
    t.transaction_happened_at,
    d.device_type
FROM
    transactions t
JOIN devices d ON t.device_id = d.device_id
JOIN stores s ON d.store_id = s.store_id
)

select * from store_transactions
  );
[0m17:23:50.354928 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:23:50.362868 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:23:50.363437 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */
alter table "merveyasa"."dbt_merve"."store_transaction_view" rename to "store_transaction_view__dbt_backup"
[0m17:23:50.364547 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:23:50.368309 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:23:50.368956 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */
alter table "merveyasa"."dbt_merve"."store_transaction_view__dbt_tmp" rename to "store_transaction_view"
[0m17:23:50.370008 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:23:50.394373 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: COMMIT
[0m17:23:50.394846 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:23:50.395214 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: COMMIT
[0m17:23:50.396462 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:23:50.406013 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m17:23:50.406527 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */
drop view if exists "merveyasa"."dbt_merve"."store_transaction_view__dbt_backup" cascade
[0m17:23:50.410378 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:23:50.412226 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_view (execute): 17:23:50.249975 => 17:23:50.411978
[0m17:23:50.412696 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: Close
[0m17:23:50.413680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9137f6d-04bb-4430-a711-ad652575f158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d6a8d0>]}
[0m17:23:50.415009 [info ] [Thread-1 (]: 1 of 7 OK created sql view model dbt_merve.store_transaction_view .............. [[32mCREATE VIEW[0m in 0.18s]
[0m17:23:50.416264 [debug] [Thread-1 (]: Finished running node model.sumup.store_transaction_view
[0m17:23:50.424450 [debug] [Thread-1 (]: Began running node model.sumup.avg_transaction_amount
[0m17:23:50.425845 [info ] [Thread-1 (]: 2 of 7 START sql incremental model dbt_merve.avg_transaction_amount ............ [RUN]
[0m17:23:50.427750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.store_transaction_view, now model.sumup.avg_transaction_amount)
[0m17:23:50.428344 [debug] [Thread-1 (]: Began compiling node model.sumup.avg_transaction_amount
[0m17:23:50.444991 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.avg_transaction_amount"
[0m17:23:50.465029 [debug] [Thread-1 (]: Timing info for model.sumup.avg_transaction_amount (compile): 17:23:50.428709 => 17:23:50.464633
[0m17:23:50.465635 [debug] [Thread-1 (]: Began executing node model.sumup.avg_transaction_amount
[0m17:23:50.513846 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.avg_transaction_amount"
[0m17:23:50.514889 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m17:23:50.515335 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: BEGIN
[0m17:23:50.515809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:50.521771 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:23:50.522269 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m17:23:50.522706 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.avg_transaction_amount"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."avg_transaction_amount__dbt_tmp"
  
  
    as
  
  (
    


    SELECT store_typology, store_country, AVG(transaction_amount) AS average_transaction_amount
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
    GROUP BY store_typology, store_country

  );
  
  
[0m17:23:50.592943 [debug] [Thread-1 (]: SQL status: SELECT 74 in 0.0 seconds
[0m17:23:50.595847 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m17:23:50.596244 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.avg_transaction_amount"} */
alter table "merveyasa"."dbt_merve"."avg_transaction_amount" rename to "avg_transaction_amount__dbt_backup"
[0m17:23:50.597041 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:23:50.599965 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m17:23:50.600362 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.avg_transaction_amount"} */
alter table "merveyasa"."dbt_merve"."avg_transaction_amount__dbt_tmp" rename to "avg_transaction_amount"
[0m17:23:50.601244 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:23:50.607491 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: COMMIT
[0m17:23:50.607935 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m17:23:50.608300 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: COMMIT
[0m17:23:50.609394 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:23:50.614390 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m17:23:50.614850 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.avg_transaction_amount"} */
drop table if exists "merveyasa"."dbt_merve"."avg_transaction_amount__dbt_backup" cascade
[0m17:23:50.621252 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:23:50.623152 [debug] [Thread-1 (]: Timing info for model.sumup.avg_transaction_amount (execute): 17:23:50.466062 => 17:23:50.622921
[0m17:23:50.623576 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: Close
[0m17:23:50.624435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9137f6d-04bb-4430-a711-ad652575f158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077828d0>]}
[0m17:23:50.625127 [info ] [Thread-1 (]: 2 of 7 OK created sql incremental model dbt_merve.avg_transaction_amount ....... [[32mSELECT 74[0m in 0.20s]
[0m17:23:50.626069 [debug] [Thread-1 (]: Finished running node model.sumup.avg_transaction_amount
[0m17:23:50.626598 [debug] [Thread-1 (]: Began running node model.sumup.pct_transaction
[0m17:23:50.627440 [info ] [Thread-1 (]: 3 of 7 START sql view model dbt_merve.pct_transaction .......................... [RUN]
[0m17:23:50.628371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.avg_transaction_amount, now model.sumup.pct_transaction)
[0m17:23:50.628883 [debug] [Thread-1 (]: Began compiling node model.sumup.pct_transaction
[0m17:23:50.632245 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.pct_transaction"
[0m17:23:50.634766 [debug] [Thread-1 (]: Timing info for model.sumup.pct_transaction (compile): 17:23:50.629215 => 17:23:50.634374
[0m17:23:50.635286 [debug] [Thread-1 (]: Began executing node model.sumup.pct_transaction
[0m17:23:50.641837 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.pct_transaction"
[0m17:23:50.643657 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m17:23:50.644666 [debug] [Thread-1 (]: On model.sumup.pct_transaction: BEGIN
[0m17:23:50.645774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:50.656539 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:23:50.657654 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m17:23:50.658561 [debug] [Thread-1 (]: On model.sumup.pct_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.pct_transaction"} */

  create view "merveyasa"."dbt_merve"."pct_transaction__dbt_tmp"
    
    
  as (
    

WITH pct_transaction AS (
    SELECT device_type, COUNT(*) * 100.0 / SUM(COUNT(*)) OVER () AS percentage
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
    GROUP BY device_type
)
SELECT * FROM pct_transaction
ORDER BY device_type
  );
[0m17:23:50.664903 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:23:50.670363 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m17:23:50.671094 [debug] [Thread-1 (]: On model.sumup.pct_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.pct_transaction"} */
alter table "merveyasa"."dbt_merve"."pct_transaction__dbt_tmp" rename to "pct_transaction"
[0m17:23:50.672986 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:23:50.675828 [debug] [Thread-1 (]: On model.sumup.pct_transaction: COMMIT
[0m17:23:50.676563 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m17:23:50.677191 [debug] [Thread-1 (]: On model.sumup.pct_transaction: COMMIT
[0m17:23:50.678565 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:23:50.682488 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m17:23:50.683055 [debug] [Thread-1 (]: On model.sumup.pct_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.pct_transaction"} */
drop view if exists "merveyasa"."dbt_merve"."pct_transaction__dbt_backup" cascade
[0m17:23:50.683924 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:23:50.685986 [debug] [Thread-1 (]: Timing info for model.sumup.pct_transaction (execute): 17:23:50.635607 => 17:23:50.685718
[0m17:23:50.686523 [debug] [Thread-1 (]: On model.sumup.pct_transaction: Close
[0m17:23:50.688085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9137f6d-04bb-4430-a711-ad652575f158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107853ad0>]}
[0m17:23:50.689201 [info ] [Thread-1 (]: 3 of 7 OK created sql view model dbt_merve.pct_transaction ..................... [[32mCREATE VIEW[0m in 0.06s]
[0m17:23:50.690362 [debug] [Thread-1 (]: Finished running node model.sumup.pct_transaction
[0m17:23:50.691006 [debug] [Thread-1 (]: Began running node model.sumup.store_transaction_first
[0m17:23:50.691581 [info ] [Thread-1 (]: 4 of 7 START sql view model dbt_merve.store_transaction_first .................. [RUN]
[0m17:23:50.692408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.pct_transaction, now model.sumup.store_transaction_first)
[0m17:23:50.692892 [debug] [Thread-1 (]: Began compiling node model.sumup.store_transaction_first
[0m17:23:50.699106 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.store_transaction_first"
[0m17:23:50.700195 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_first (compile): 17:23:50.693354 => 17:23:50.699875
[0m17:23:50.700750 [debug] [Thread-1 (]: Began executing node model.sumup.store_transaction_first
[0m17:23:50.708259 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.store_transaction_first"
[0m17:23:50.711322 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m17:23:50.712154 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: BEGIN
[0m17:23:50.713563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:50.727927 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:23:50.728870 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m17:23:50.729685 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_first"} */

  create view "merveyasa"."dbt_merve"."store_transaction_first__dbt_tmp"
    
    
  as (
    

WITH numbered_transactions AS (
    SELECT
        store_id,
        transaction_happened_at,
        ROW_NUMBER() OVER (PARTITION BY store_id ORDER BY transaction_happened_at) AS rownumber
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
)
SELECT
    store_id,
    transaction_happened_at
FROM numbered_transactions
WHERE rownumber <= 5
  );
[0m17:23:50.735770 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:23:50.741835 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m17:23:50.742431 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_first"} */
alter table "merveyasa"."dbt_merve"."store_transaction_first__dbt_tmp" rename to "store_transaction_first"
[0m17:23:50.743466 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:23:50.745741 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: COMMIT
[0m17:23:50.746483 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m17:23:50.747272 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: COMMIT
[0m17:23:50.748757 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:23:50.754965 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m17:23:50.755891 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_first"} */
drop view if exists "merveyasa"."dbt_merve"."store_transaction_first__dbt_backup" cascade
[0m17:23:50.757182 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:23:50.760021 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_first (execute): 17:23:50.701388 => 17:23:50.759548
[0m17:23:50.760860 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: Close
[0m17:23:50.762246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9137f6d-04bb-4430-a711-ad652575f158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10717a510>]}
[0m17:23:50.763290 [info ] [Thread-1 (]: 4 of 7 OK created sql view model dbt_merve.store_transaction_first ............. [[32mCREATE VIEW[0m in 0.07s]
[0m17:23:50.764501 [debug] [Thread-1 (]: Finished running node model.sumup.store_transaction_first
[0m17:23:50.765226 [debug] [Thread-1 (]: Began running node model.sumup.top_ten_products
[0m17:23:50.766331 [info ] [Thread-1 (]: 5 of 7 START sql view model dbt_merve.top_ten_products ......................... [RUN]
[0m17:23:50.767269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.store_transaction_first, now model.sumup.top_ten_products)
[0m17:23:50.768378 [debug] [Thread-1 (]: Began compiling node model.sumup.top_ten_products
[0m17:23:50.773054 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.top_ten_products"
[0m17:23:50.775387 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_products (compile): 17:23:50.769386 => 17:23:50.774714
[0m17:23:50.776004 [debug] [Thread-1 (]: Began executing node model.sumup.top_ten_products
[0m17:23:50.784199 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.top_ten_products"
[0m17:23:50.785929 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m17:23:50.786768 [debug] [Thread-1 (]: On model.sumup.top_ten_products: BEGIN
[0m17:23:50.787281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:50.804969 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:23:50.806136 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m17:23:50.807043 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */

  create view "merveyasa"."dbt_merve"."top_ten_products__dbt_tmp"
    
    
  as (
    

WITH top_ten_products AS (
    SELECT product_name, COUNT(*) AS total_count_sold
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
    GROUP BY product_name
    ORDER BY total_count_sold DESC
    LIMIT 10
)
SELECT * FROM top_ten_products
  );
[0m17:23:50.813556 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:23:50.825263 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m17:23:50.826145 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */
alter table "merveyasa"."dbt_merve"."top_ten_products__dbt_tmp" rename to "top_ten_products"
[0m17:23:50.827609 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:23:50.831297 [debug] [Thread-1 (]: On model.sumup.top_ten_products: COMMIT
[0m17:23:50.832164 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m17:23:50.832978 [debug] [Thread-1 (]: On model.sumup.top_ten_products: COMMIT
[0m17:23:50.834576 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:23:50.840691 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m17:23:50.841586 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */
drop view if exists "merveyasa"."dbt_merve"."top_ten_products__dbt_backup" cascade
[0m17:23:50.842785 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:23:50.845734 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_products (execute): 17:23:50.776357 => 17:23:50.845296
[0m17:23:50.846575 [debug] [Thread-1 (]: On model.sumup.top_ten_products: Close
[0m17:23:50.848160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9137f6d-04bb-4430-a711-ad652575f158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c0550>]}
[0m17:23:50.849282 [info ] [Thread-1 (]: 5 of 7 OK created sql view model dbt_merve.top_ten_products .................... [[32mCREATE VIEW[0m in 0.08s]
[0m17:23:50.851170 [debug] [Thread-1 (]: Finished running node model.sumup.top_ten_products
[0m17:23:50.852390 [debug] [Thread-1 (]: Began running node model.sumup.top_ten_stores
[0m17:23:50.855778 [info ] [Thread-1 (]: 6 of 7 START sql view model dbt_merve.top_ten_stores ........................... [RUN]
[0m17:23:50.857724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.top_ten_products, now model.sumup.top_ten_stores)
[0m17:23:50.858583 [debug] [Thread-1 (]: Began compiling node model.sumup.top_ten_stores
[0m17:23:50.864970 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.top_ten_stores"
[0m17:23:50.866540 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_stores (compile): 17:23:50.859153 => 17:23:50.866046
[0m17:23:50.867674 [debug] [Thread-1 (]: Began executing node model.sumup.top_ten_stores
[0m17:23:50.879138 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.top_ten_stores"
[0m17:23:50.880693 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m17:23:50.881648 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: BEGIN
[0m17:23:50.882405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:50.911313 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:23:50.912390 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m17:23:50.913310 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */

  create view "merveyasa"."dbt_merve"."top_ten_stores__dbt_tmp"
    
    
  as (
    

WITH top_ten_stores AS (
    SELECT store_id, SUM(transaction_amount) AS total_transaction_amount
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
    GROUP BY store_id
    ORDER BY total_transaction_amount DESC
    LIMIT 10
)
SELECT * FROM top_ten_stores
  );
[0m17:23:50.921142 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:23:50.948052 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m17:23:50.948849 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */
alter table "merveyasa"."dbt_merve"."top_ten_stores__dbt_tmp" rename to "top_ten_stores"
[0m17:23:50.950291 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:23:50.962890 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: COMMIT
[0m17:23:50.963648 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m17:23:50.964291 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: COMMIT
[0m17:23:50.966169 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:23:50.988574 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m17:23:50.989316 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */
drop view if exists "merveyasa"."dbt_merve"."top_ten_stores__dbt_backup" cascade
[0m17:23:50.991275 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:23:50.994291 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_stores (execute): 17:23:50.868460 => 17:23:50.993949
[0m17:23:50.994969 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: Close
[0m17:23:50.996316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9137f6d-04bb-4430-a711-ad652575f158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10777ce50>]}
[0m17:23:50.997456 [info ] [Thread-1 (]: 6 of 7 OK created sql view model dbt_merve.top_ten_stores ...................... [[32mCREATE VIEW[0m in 0.14s]
[0m17:23:50.998869 [debug] [Thread-1 (]: Finished running node model.sumup.top_ten_stores
[0m17:23:50.999721 [debug] [Thread-1 (]: Began running node model.sumup.inc_first_five_transaction
[0m17:23:51.001459 [info ] [Thread-1 (]: 7 of 7 START sql incremental model dbt_merve.inc_first_five_transaction ........ [RUN]
[0m17:23:51.004359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.top_ten_stores, now model.sumup.inc_first_five_transaction)
[0m17:23:51.005508 [debug] [Thread-1 (]: Began compiling node model.sumup.inc_first_five_transaction
[0m17:23:51.016640 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.inc_first_five_transaction"
[0m17:23:51.022603 [debug] [Thread-1 (]: Timing info for model.sumup.inc_first_five_transaction (compile): 17:23:51.006053 => 17:23:51.017747
[0m17:23:51.023458 [debug] [Thread-1 (]: Began executing node model.sumup.inc_first_five_transaction
[0m17:23:51.055768 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.inc_first_five_transaction"
[0m17:23:51.057686 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m17:23:51.058690 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: BEGIN
[0m17:23:51.059424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:51.067807 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:23:51.068687 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m17:23:51.069671 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.inc_first_five_transaction"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."inc_first_five_transaction__dbt_tmp"
  
  
    as
  
  (
    


SELECT
    store_id,
    AVG(time_diff) AS avg_time_diff
FROM (
    SELECT
        store_id,
        transaction_happened_at - LAG(transaction_happened_at, 1) OVER (PARTITION BY store_id ORDER BY transaction_happened_at) AS time_diff
    FROM "merveyasa"."dbt_merve"."store_transaction_first"
) subquery
GROUP BY store_id

  );
  
  
[0m17:23:51.364459 [debug] [Thread-1 (]: SQL status: SELECT 87 in 0.0 seconds
[0m17:23:51.367403 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m17:23:51.367803 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.inc_first_five_transaction"} */
alter table "merveyasa"."dbt_merve"."inc_first_five_transaction" rename to "inc_first_five_transaction__dbt_backup"
[0m17:23:51.368615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:23:51.371867 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m17:23:51.372334 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.inc_first_five_transaction"} */
alter table "merveyasa"."dbt_merve"."inc_first_five_transaction__dbt_tmp" rename to "inc_first_five_transaction"
[0m17:23:51.373342 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:23:51.377131 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: COMMIT
[0m17:23:51.377625 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m17:23:51.378016 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: COMMIT
[0m17:23:51.379064 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:23:51.382024 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m17:23:51.382450 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.inc_first_five_transaction"} */
drop table if exists "merveyasa"."dbt_merve"."inc_first_five_transaction__dbt_backup" cascade
[0m17:23:51.384472 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:23:51.386166 [debug] [Thread-1 (]: Timing info for model.sumup.inc_first_five_transaction (execute): 17:23:51.024157 => 17:23:51.385924
[0m17:23:51.386602 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: Close
[0m17:23:51.387485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9137f6d-04bb-4430-a711-ad652575f158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107494850>]}
[0m17:23:51.388539 [info ] [Thread-1 (]: 7 of 7 OK created sql incremental model dbt_merve.inc_first_five_transaction ... [[32mSELECT 87[0m in 0.38s]
[0m17:23:51.389501 [debug] [Thread-1 (]: Finished running node model.sumup.inc_first_five_transaction
[0m17:23:51.391920 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:51.392387 [debug] [MainThread]: On master: BEGIN
[0m17:23:51.392916 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:23:51.403010 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:23:51.403934 [debug] [MainThread]: On master: COMMIT
[0m17:23:51.404848 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:51.405816 [debug] [MainThread]: On master: COMMIT
[0m17:23:51.406579 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:23:51.407100 [debug] [MainThread]: On master: Close
[0m17:23:51.408225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:51.408822 [debug] [MainThread]: Connection 'model.sumup.inc_first_five_transaction' was properly closed.
[0m17:23:51.409322 [info ] [MainThread]: 
[0m17:23:51.409823 [info ] [MainThread]: Finished running 5 view models, 2 incremental models in 0 hours 0 minutes and 1.36 seconds (1.36s).
[0m17:23:51.412659 [debug] [MainThread]: Command end result
[0m17:23:51.426240 [info ] [MainThread]: 
[0m17:23:51.427303 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:23:51.427993 [info ] [MainThread]: 
[0m17:23:51.429258 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m17:23:51.430161 [debug] [MainThread]: Command `dbt run` succeeded at 17:23:51.429995 after 2.69 seconds
[0m17:23:51.430803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee86d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027c7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f9b710>]}
[0m17:23:51.431346 [debug] [MainThread]: Flushing usage events
[0m17:44:13.340309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f25410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f14650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f26650>]}


============================== 17:44:13.348782 | 9cdf271c-03f0-44c2-8771-a2474908fac2 ==============================
[0m17:44:13.348782 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:44:13.349901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'version_check': 'True', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m product_agg', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:44:13.599176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9cdf271c-03f0-44c2-8771-a2474908fac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b0f90>]}
[0m17:44:13.617236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9cdf271c-03f0-44c2-8771-a2474908fac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107784b10>]}
[0m17:44:13.618847 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:44:13.663257 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:44:13.779424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m17:44:13.780183 [debug] [MainThread]: Partial parsing: added file: sumup://models/product_agg.sql
[0m17:44:13.780744 [debug] [MainThread]: Partial parsing: updated file: sumup://models/store_transaction_view.sql
[0m17:44:13.930900 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 8 unused configuration paths:
- models.my_project.inc_first_five_transaction
- models.my_project.pct_transaction
- models.my_project.avg_transaction_amount
- models.my_project.top_ten_stores
- models.my_project.store_transaction_view
- models.my_project.top_ten_products
- models.my_project
- models.my_project.store_transaction_first
[0m17:44:13.948165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cdf271c-03f0-44c2-8771-a2474908fac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b1610>]}
[0m17:44:14.044044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cdf271c-03f0-44c2-8771-a2474908fac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077730d0>]}
[0m17:44:14.046997 [info ] [MainThread]: Found 8 models, 22 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:44:14.049388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cdf271c-03f0-44c2-8771-a2474908fac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b20050>]}
[0m17:44:14.057688 [info ] [MainThread]: 
[0m17:44:14.061126 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:44:14.067084 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m17:44:14.089536 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m17:44:14.090416 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m17:44:14.091437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:14.161141 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:44:14.164483 [debug] [ThreadPool]: On list_merveyasa: Close
[0m17:44:14.169190 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m17:44:14.179313 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:44:14.180001 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m17:44:14.180808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:44:14.189458 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:44:14.190197 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:44:14.190615 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m17:44:14.197180 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m17:44:14.199633 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m17:44:14.200497 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m17:44:14.210544 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:14.211112 [debug] [MainThread]: On master: BEGIN
[0m17:44:14.211472 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:44:14.220053 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:44:14.220637 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:14.222070 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:44:14.248201 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m17:44:14.251096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cdf271c-03f0-44c2-8771-a2474908fac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f5a50>]}
[0m17:44:14.252230 [debug] [MainThread]: On master: ROLLBACK
[0m17:44:14.253524 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:14.255197 [debug] [MainThread]: On master: BEGIN
[0m17:44:14.255991 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:44:14.256516 [debug] [MainThread]: On master: COMMIT
[0m17:44:14.257048 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:14.257568 [debug] [MainThread]: On master: COMMIT
[0m17:44:14.258377 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:44:14.259121 [debug] [MainThread]: On master: Close
[0m17:44:14.260131 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:44:14.260756 [info ] [MainThread]: 
[0m17:44:14.266127 [debug] [Thread-1 (]: Began running node model.sumup.product_agg
[0m17:44:14.266955 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.product_agg .............................. [RUN]
[0m17:44:14.267934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.product_agg)
[0m17:44:14.268523 [debug] [Thread-1 (]: Began compiling node model.sumup.product_agg
[0m17:44:14.283220 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.product_agg"
[0m17:44:14.285709 [debug] [Thread-1 (]: Timing info for model.sumup.product_agg (compile): 17:44:14.268949 => 17:44:14.284960
[0m17:44:14.286992 [debug] [Thread-1 (]: Began executing node model.sumup.product_agg
[0m17:44:14.456498 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.product_agg"
[0m17:44:14.463276 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m17:44:14.466393 [debug] [Thread-1 (]: On model.sumup.product_agg: BEGIN
[0m17:44:14.467255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:14.511115 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:44:14.511735 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m17:44:14.512686 [debug] [Thread-1 (]: On model.sumup.product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.product_agg"} */

  create view "merveyasa"."dbt_merve"."product_agg__dbt_tmp"
    
    
  as (
    WITH products_aggregated AS
(
SELECT
    product_name,
    product_sku,
    COUNT(*) AS transactions_count,
    SUM(amount) AS total_amount
FROM
    transactions
WHERE
    status = 'accepted' 
GROUP BY
    product_name, product_sku
)
select * from products_aggregated
  );
[0m17:44:14.515313 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "amount" does not exist
LINE 13:     SUM(amount) AS total_amount
                 ^

[0m17:44:14.517377 [debug] [Thread-1 (]: On model.sumup.product_agg: ROLLBACK
[0m17:44:14.518609 [debug] [Thread-1 (]: Timing info for model.sumup.product_agg (execute): 17:44:14.287544 => 17:44:14.518281
[0m17:44:14.519144 [debug] [Thread-1 (]: On model.sumup.product_agg: Close
[0m17:44:14.550143 [debug] [Thread-1 (]: Database Error in model product_agg (models/product_agg.sql)
  column "amount" does not exist
  LINE 13:     SUM(amount) AS total_amount
                   ^
  compiled Code at target/run/sumup/models/product_agg.sql
[0m17:44:14.550929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cdf271c-03f0-44c2-8771-a2474908fac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aac110>]}
[0m17:44:14.552153 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_merve.product_agg ..................... [[31mERROR[0m in 0.28s]
[0m17:44:14.553866 [debug] [Thread-1 (]: Finished running node model.sumup.product_agg
[0m17:44:14.558766 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:14.559467 [debug] [MainThread]: On master: BEGIN
[0m17:44:14.560060 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:44:14.569016 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:44:14.569659 [debug] [MainThread]: On master: COMMIT
[0m17:44:14.570170 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:14.570671 [debug] [MainThread]: On master: COMMIT
[0m17:44:14.571261 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:44:14.571762 [debug] [MainThread]: On master: Close
[0m17:44:14.572729 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:14.573373 [debug] [MainThread]: Connection 'model.sumup.product_agg' was properly closed.
[0m17:44:14.573821 [info ] [MainThread]: 
[0m17:44:14.574455 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m17:44:14.575706 [debug] [MainThread]: Command end result
[0m17:44:14.590860 [info ] [MainThread]: 
[0m17:44:14.591866 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:44:14.592779 [info ] [MainThread]: 
[0m17:44:14.594468 [error] [MainThread]: [33mDatabase Error in model product_agg (models/product_agg.sql)[0m
[0m17:44:14.596010 [error] [MainThread]:   column "amount" does not exist
[0m17:44:14.596925 [error] [MainThread]:   LINE 13:     SUM(amount) AS total_amount
[0m17:44:14.598216 [error] [MainThread]:                    ^
[0m17:44:14.599253 [error] [MainThread]:   compiled Code at target/run/sumup/models/product_agg.sql
[0m17:44:14.600160 [info ] [MainThread]: 
[0m17:44:14.601091 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:44:14.602518 [debug] [MainThread]: Command `dbt run` failed at 17:44:14.602347 after 1.30 seconds
[0m17:44:14.603632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e86850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107799c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102818490>]}
[0m17:44:14.604409 [debug] [MainThread]: Flushing usage events
[0m17:44:52.263525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10913a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091696d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10943fe10>]}


============================== 17:44:52.270102 | b9bad805-fa06-43a8-861e-6c6f86fbbb16 ==============================
[0m17:44:52.270102 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:44:52.271006 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m product_agg', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:44:52.372403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9bad805-fa06-43a8-861e-6c6f86fbbb16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109465dd0>]}
[0m17:44:52.383091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9bad805-fa06-43a8-861e-6c6f86fbbb16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10970a450>]}
[0m17:44:52.384017 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:44:52.422022 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:44:52.478732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:44:52.479613 [debug] [MainThread]: Partial parsing: updated file: sumup://models/product_agg.sql
[0m17:44:52.518165 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 8 unused configuration paths:
- models.my_project.store_transaction_view
- models.my_project.top_ten_products
- models.my_project.avg_transaction_amount
- models.my_project.pct_transaction
- models.my_project.store_transaction_first
- models.my_project
- models.my_project.top_ten_stores
- models.my_project.inc_first_five_transaction
[0m17:44:52.525078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9bad805-fa06-43a8-861e-6c6f86fbbb16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109465a90>]}
[0m17:44:52.554948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9bad805-fa06-43a8-861e-6c6f86fbbb16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097f2490>]}
[0m17:44:52.555789 [info ] [MainThread]: Found 8 models, 22 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:44:52.556986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9bad805-fa06-43a8-861e-6c6f86fbbb16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109155f90>]}
[0m17:44:52.560967 [info ] [MainThread]: 
[0m17:44:52.562953 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:44:52.564671 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m17:44:52.581068 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m17:44:52.581641 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m17:44:52.582066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:52.634057 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:44:52.636339 [debug] [ThreadPool]: On list_merveyasa: Close
[0m17:44:52.640027 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m17:44:52.650771 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:44:52.651302 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m17:44:52.651754 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:44:52.659933 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:44:52.660461 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:44:52.660898 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m17:44:52.665737 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m17:44:52.667613 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m17:44:52.668333 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m17:44:52.676187 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:52.676700 [debug] [MainThread]: On master: BEGIN
[0m17:44:52.677087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:44:52.684067 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:44:52.684582 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:52.685105 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:44:52.707216 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m17:44:52.709695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9bad805-fa06-43a8-861e-6c6f86fbbb16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109464f90>]}
[0m17:44:52.710193 [debug] [MainThread]: On master: ROLLBACK
[0m17:44:52.710717 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:52.711070 [debug] [MainThread]: On master: BEGIN
[0m17:44:52.711719 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:44:52.712114 [debug] [MainThread]: On master: COMMIT
[0m17:44:52.712470 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:52.712803 [debug] [MainThread]: On master: COMMIT
[0m17:44:52.713259 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:44:52.713631 [debug] [MainThread]: On master: Close
[0m17:44:52.714543 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:44:52.715011 [info ] [MainThread]: 
[0m17:44:52.717476 [debug] [Thread-1 (]: Began running node model.sumup.product_agg
[0m17:44:52.718118 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.product_agg .............................. [RUN]
[0m17:44:52.718964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.product_agg)
[0m17:44:52.719423 [debug] [Thread-1 (]: Began compiling node model.sumup.product_agg
[0m17:44:52.730323 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.product_agg"
[0m17:44:52.731481 [debug] [Thread-1 (]: Timing info for model.sumup.product_agg (compile): 17:44:52.719728 => 17:44:52.731160
[0m17:44:52.731995 [debug] [Thread-1 (]: Began executing node model.sumup.product_agg
[0m17:44:52.782532 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.product_agg"
[0m17:44:52.783662 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m17:44:52.784150 [debug] [Thread-1 (]: On model.sumup.product_agg: BEGIN
[0m17:44:52.784582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:52.791990 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:44:52.792679 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m17:44:52.793211 [debug] [Thread-1 (]: On model.sumup.product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.product_agg"} */

  create view "merveyasa"."dbt_merve"."product_agg__dbt_tmp"
    
    
  as (
    

WITH products_aggregated AS
(
SELECT
    product_name,
    product_sku,
    COUNT(*) AS transactions_count,
    SUM(transaction_amount) AS total_amount
FROM
    transactions
WHERE
    status = 'accepted' 
GROUP BY
    product_name, product_sku
)
select * from products_aggregated
  );
[0m17:44:52.794907 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "status" does not exist
LINE 19:     status = 'accepted' 
             ^

[0m17:44:52.795535 [debug] [Thread-1 (]: On model.sumup.product_agg: ROLLBACK
[0m17:44:52.796546 [debug] [Thread-1 (]: Timing info for model.sumup.product_agg (execute): 17:44:52.732326 => 17:44:52.796184
[0m17:44:52.797176 [debug] [Thread-1 (]: On model.sumup.product_agg: Close
[0m17:44:52.802545 [debug] [Thread-1 (]: Database Error in model product_agg (models/product_agg.sql)
  column "status" does not exist
  LINE 19:     status = 'accepted' 
               ^
  compiled Code at target/run/sumup/models/product_agg.sql
[0m17:44:52.803241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9bad805-fa06-43a8-861e-6c6f86fbbb16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109741e90>]}
[0m17:44:52.803995 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_merve.product_agg ..................... [[31mERROR[0m in 0.08s]
[0m17:44:52.804812 [debug] [Thread-1 (]: Finished running node model.sumup.product_agg
[0m17:44:52.807458 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:52.807960 [debug] [MainThread]: On master: BEGIN
[0m17:44:52.808348 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:44:52.817565 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:44:52.818645 [debug] [MainThread]: On master: COMMIT
[0m17:44:52.819568 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:52.820324 [debug] [MainThread]: On master: COMMIT
[0m17:44:52.821303 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:44:52.821872 [debug] [MainThread]: On master: Close
[0m17:44:52.823420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:52.823945 [debug] [MainThread]: Connection 'model.sumup.product_agg' was properly closed.
[0m17:44:52.824716 [info ] [MainThread]: 
[0m17:44:52.826002 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m17:44:52.827627 [debug] [MainThread]: Command end result
[0m17:44:52.843022 [info ] [MainThread]: 
[0m17:44:52.844012 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:44:52.844634 [info ] [MainThread]: 
[0m17:44:52.845389 [error] [MainThread]: [33mDatabase Error in model product_agg (models/product_agg.sql)[0m
[0m17:44:52.845936 [error] [MainThread]:   column "status" does not exist
[0m17:44:52.846950 [error] [MainThread]:   LINE 19:     status = 'accepted' 
[0m17:44:52.848618 [error] [MainThread]:                ^
[0m17:44:52.849467 [error] [MainThread]:   compiled Code at target/run/sumup/models/product_agg.sql
[0m17:44:52.850591 [info ] [MainThread]: 
[0m17:44:52.851633 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:44:52.852791 [debug] [MainThread]: Command `dbt run` failed at 17:44:52.852601 after 0.61 seconds
[0m17:44:52.853379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109128750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10912b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109437f90>]}
[0m17:44:52.853957 [debug] [MainThread]: Flushing usage events
[0m17:45:09.203558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6b0290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d931350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6b1f10>]}


============================== 17:45:09.209558 | 2ce4ae18-e069-4fd8-b49e-571e71825549 ==============================
[0m17:45:09.209558 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:45:09.210436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'version_check': 'True', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m product_agg', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:45:09.310659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ce4ae18-e069-4fd8-b49e-571e71825549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc5bc50>]}
[0m17:45:09.319924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ce4ae18-e069-4fd8-b49e-571e71825549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df097d0>]}
[0m17:45:09.320745 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:45:09.341323 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:45:09.418928 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:45:09.420056 [debug] [MainThread]: Partial parsing: updated file: sumup://models/product_agg.sql
[0m17:45:09.473661 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 8 unused configuration paths:
- models.my_project.avg_transaction_amount
- models.my_project
- models.my_project.pct_transaction
- models.my_project.top_ten_stores
- models.my_project.store_transaction_view
- models.my_project.inc_first_five_transaction
- models.my_project.store_transaction_first
- models.my_project.top_ten_products
[0m17:45:09.483144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ce4ae18-e069-4fd8-b49e-571e71825549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfed490>]}
[0m17:45:09.512732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ce4ae18-e069-4fd8-b49e-571e71825549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e06da10>]}
[0m17:45:09.513820 [info ] [MainThread]: Found 8 models, 22 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:45:09.514744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ce4ae18-e069-4fd8-b49e-571e71825549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8ef6d0>]}
[0m17:45:09.517883 [info ] [MainThread]: 
[0m17:45:09.522301 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:45:09.525319 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m17:45:09.553551 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m17:45:09.554167 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m17:45:09.554641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:09.602391 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:45:09.605403 [debug] [ThreadPool]: On list_merveyasa: Close
[0m17:45:09.608784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m17:45:09.619398 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:45:09.619969 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m17:45:09.620674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:09.629130 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:45:09.629674 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:45:09.630290 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m17:45:09.635726 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m17:45:09.637401 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m17:45:09.637956 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m17:45:09.645051 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:09.645490 [debug] [MainThread]: On master: BEGIN
[0m17:45:09.645838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:45:09.652025 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:45:09.652457 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:09.652926 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:45:09.673874 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m17:45:09.676160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ce4ae18-e069-4fd8-b49e-571e71825549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d93cb10>]}
[0m17:45:09.676642 [debug] [MainThread]: On master: ROLLBACK
[0m17:45:09.677196 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:09.677558 [debug] [MainThread]: On master: BEGIN
[0m17:45:09.678333 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:45:09.678689 [debug] [MainThread]: On master: COMMIT
[0m17:45:09.679018 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:09.679330 [debug] [MainThread]: On master: COMMIT
[0m17:45:09.679851 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:45:09.680204 [debug] [MainThread]: On master: Close
[0m17:45:09.681070 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:45:09.681516 [info ] [MainThread]: 
[0m17:45:09.684165 [debug] [Thread-1 (]: Began running node model.sumup.product_agg
[0m17:45:09.684886 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.product_agg .............................. [RUN]
[0m17:45:09.685762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.product_agg)
[0m17:45:09.686230 [debug] [Thread-1 (]: Began compiling node model.sumup.product_agg
[0m17:45:09.695934 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.product_agg"
[0m17:45:09.697072 [debug] [Thread-1 (]: Timing info for model.sumup.product_agg (compile): 17:45:09.686526 => 17:45:09.696706
[0m17:45:09.697581 [debug] [Thread-1 (]: Began executing node model.sumup.product_agg
[0m17:45:09.743858 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.product_agg"
[0m17:45:09.745116 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m17:45:09.745615 [debug] [Thread-1 (]: On model.sumup.product_agg: BEGIN
[0m17:45:09.746006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:09.752224 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:45:09.752702 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m17:45:09.753276 [debug] [Thread-1 (]: On model.sumup.product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.product_agg"} */

  create view "merveyasa"."dbt_merve"."product_agg__dbt_tmp"
    
    
  as (
    

WITH products_aggregated AS
(
SELECT
    product_name,
    product_sku,
    COUNT(*) AS transactions_count,
    SUM(transaction_amount) AS total_amount
FROM
    transactions
WHERE
    transaction_status = 'accepted' 
GROUP BY
    product_name, product_sku
)
select * from products_aggregated
  );
[0m17:45:09.759062 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:45:09.765568 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m17:45:09.766019 [debug] [Thread-1 (]: On model.sumup.product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.product_agg"} */
alter table "merveyasa"."dbt_merve"."product_agg" rename to "product_agg__dbt_backup"
[0m17:45:09.766929 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:09.770195 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m17:45:09.770624 [debug] [Thread-1 (]: On model.sumup.product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.product_agg"} */
alter table "merveyasa"."dbt_merve"."product_agg__dbt_tmp" rename to "product_agg"
[0m17:45:09.771385 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:45:09.790974 [debug] [Thread-1 (]: On model.sumup.product_agg: COMMIT
[0m17:45:09.791437 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m17:45:09.791805 [debug] [Thread-1 (]: On model.sumup.product_agg: COMMIT
[0m17:45:09.793439 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:45:09.802395 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m17:45:09.802854 [debug] [Thread-1 (]: On model.sumup.product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.product_agg"} */
drop view if exists "merveyasa"."dbt_merve"."product_agg__dbt_backup" cascade
[0m17:45:09.804597 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:45:09.806311 [debug] [Thread-1 (]: Timing info for model.sumup.product_agg (execute): 17:45:09.697882 => 17:45:09.806088
[0m17:45:09.806741 [debug] [Thread-1 (]: On model.sumup.product_agg: Close
[0m17:45:09.807894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ce4ae18-e069-4fd8-b49e-571e71825549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df68790>]}
[0m17:45:09.808746 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_merve.product_agg ......................... [[32mCREATE VIEW[0m in 0.12s]
[0m17:45:09.809624 [debug] [Thread-1 (]: Finished running node model.sumup.product_agg
[0m17:45:09.811699 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:09.812091 [debug] [MainThread]: On master: BEGIN
[0m17:45:09.812413 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:45:09.824196 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:45:09.824937 [debug] [MainThread]: On master: COMMIT
[0m17:45:09.825349 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:09.825716 [debug] [MainThread]: On master: COMMIT
[0m17:45:09.826438 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:45:09.826954 [debug] [MainThread]: On master: Close
[0m17:45:09.828189 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:09.828775 [debug] [MainThread]: Connection 'model.sumup.product_agg' was properly closed.
[0m17:45:09.829477 [info ] [MainThread]: 
[0m17:45:09.830304 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m17:45:09.831920 [debug] [MainThread]: Command end result
[0m17:45:09.846135 [info ] [MainThread]: 
[0m17:45:09.847151 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:45:09.848456 [info ] [MainThread]: 
[0m17:45:09.849177 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:45:09.850193 [debug] [MainThread]: Command `dbt run` succeeded at 17:45:09.849949 after 0.67 seconds
[0m17:45:09.850918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108edba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108edba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee83d0>]}
[0m17:45:09.851410 [debug] [MainThread]: Flushing usage events
[0m17:50:00.827379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b0a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120e9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120e9550>]}


============================== 17:50:00.841465 | 5d2aaa04-97e5-48e4-a51e-fe056db59d05 ==============================
[0m17:50:00.841465 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:50:00.842344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m top_ten_products', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:50:01.048827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d2aaa04-97e5-48e4-a51e-fe056db59d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fa4710>]}
[0m17:50:01.058067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d2aaa04-97e5-48e4-a51e-fe056db59d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123279d0>]}
[0m17:50:01.059711 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:50:01.110264 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:50:01.198054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:50:01.198952 [debug] [MainThread]: Partial parsing: updated file: sumup://models/top_ten_products.sql
[0m17:50:01.199416 [debug] [MainThread]: Partial parsing: updated file: sumup://models/product_agg.sql
[0m17:50:01.273938 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 8 unused configuration paths:
- models.my_project.store_transaction_first
- models.my_project.inc_first_five_transaction
- models.my_project.avg_transaction_amount
- models.my_project.top_ten_stores
- models.my_project.pct_transaction
- models.my_project.top_ten_products
- models.my_project
- models.my_project.store_transaction_view
[0m17:50:01.280807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d2aaa04-97e5-48e4-a51e-fe056db59d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dec950>]}
[0m17:50:01.302799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d2aaa04-97e5-48e4-a51e-fe056db59d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112383e90>]}
[0m17:50:01.303536 [info ] [MainThread]: Found 8 models, 22 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:50:01.304285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d2aaa04-97e5-48e4-a51e-fe056db59d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d8fa50>]}
[0m17:50:01.307468 [info ] [MainThread]: 
[0m17:50:01.308619 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:50:01.310150 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m17:50:01.326416 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m17:50:01.326976 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m17:50:01.327394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:01.373128 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:50:01.375124 [debug] [ThreadPool]: On list_merveyasa: Close
[0m17:50:01.377735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m17:50:01.384950 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:50:01.385414 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m17:50:01.385738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:01.401548 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:50:01.402003 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:50:01.402375 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m17:50:01.407088 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m17:50:01.409005 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m17:50:01.409624 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m17:50:01.417144 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:01.417614 [debug] [MainThread]: On master: BEGIN
[0m17:50:01.417958 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:01.427645 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:50:01.428177 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:01.428706 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:50:01.452058 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m17:50:01.454812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d2aaa04-97e5-48e4-a51e-fe056db59d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123279d0>]}
[0m17:50:01.455396 [debug] [MainThread]: On master: ROLLBACK
[0m17:50:01.456019 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:01.456420 [debug] [MainThread]: On master: BEGIN
[0m17:50:01.457097 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:50:01.457487 [debug] [MainThread]: On master: COMMIT
[0m17:50:01.457848 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:01.458187 [debug] [MainThread]: On master: COMMIT
[0m17:50:01.458640 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:50:01.459003 [debug] [MainThread]: On master: Close
[0m17:50:01.459944 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:50:01.460466 [info ] [MainThread]: 
[0m17:50:01.463496 [debug] [Thread-1 (]: Began running node model.sumup.top_ten_products
[0m17:50:01.464171 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.top_ten_products ......................... [RUN]
[0m17:50:01.465062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.top_ten_products)
[0m17:50:01.465554 [debug] [Thread-1 (]: Began compiling node model.sumup.top_ten_products
[0m17:50:01.477003 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.top_ten_products"
[0m17:50:01.478552 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_products (compile): 17:50:01.465880 => 17:50:01.478161
[0m17:50:01.479081 [debug] [Thread-1 (]: Began executing node model.sumup.top_ten_products
[0m17:50:01.529180 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.top_ten_products"
[0m17:50:01.530256 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m17:50:01.530730 [debug] [Thread-1 (]: On model.sumup.top_ten_products: BEGIN
[0m17:50:01.531148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:01.537897 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:50:01.538442 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m17:50:01.538903 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */

  create view "merveyasa"."dbt_merve"."top_ten_products__dbt_tmp"
    
    
  as (
    

WITH top_ten_products AS (
    SELECT
        product_name,
        product_sku,
        transactions_count,
        total_transaction_amount
    FROM "merveyasa"."dbt_merve"."product_agg"
    ORDER BY
        total_transaction_amount DESC
    LIMIT 10
)

SELECT * FROM top_ten_products
  );
[0m17:50:01.540452 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "total_transaction_amount" does not exist
LINE 14:         total_transaction_amount
                 ^

[0m17:50:01.540985 [debug] [Thread-1 (]: On model.sumup.top_ten_products: ROLLBACK
[0m17:50:01.541971 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_products (execute): 17:50:01.479402 => 17:50:01.541624
[0m17:50:01.542526 [debug] [Thread-1 (]: On model.sumup.top_ten_products: Close
[0m17:50:01.585596 [debug] [Thread-1 (]: Database Error in model top_ten_products (models/top_ten_products.sql)
  column "total_transaction_amount" does not exist
  LINE 14:         total_transaction_amount
                   ^
  compiled Code at target/run/sumup/models/top_ten_products.sql
[0m17:50:01.586761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d2aaa04-97e5-48e4-a51e-fe056db59d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123eb4d0>]}
[0m17:50:01.587789 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_merve.top_ten_products ................ [[31mERROR[0m in 0.12s]
[0m17:50:01.588873 [debug] [Thread-1 (]: Finished running node model.sumup.top_ten_products
[0m17:50:01.591520 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:01.591976 [debug] [MainThread]: On master: BEGIN
[0m17:50:01.592341 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:01.602641 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:50:01.603404 [debug] [MainThread]: On master: COMMIT
[0m17:50:01.603789 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:01.604113 [debug] [MainThread]: On master: COMMIT
[0m17:50:01.604721 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:50:01.605069 [debug] [MainThread]: On master: Close
[0m17:50:01.605844 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:01.606200 [debug] [MainThread]: Connection 'model.sumup.top_ten_products' was properly closed.
[0m17:50:01.606715 [info ] [MainThread]: 
[0m17:50:01.607149 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m17:50:01.607941 [debug] [MainThread]: Command end result
[0m17:50:01.619874 [info ] [MainThread]: 
[0m17:50:01.620799 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:50:01.621767 [info ] [MainThread]: 
[0m17:50:01.622212 [error] [MainThread]: [33mDatabase Error in model top_ten_products (models/top_ten_products.sql)[0m
[0m17:50:01.622554 [error] [MainThread]:   column "total_transaction_amount" does not exist
[0m17:50:01.622876 [error] [MainThread]:   LINE 14:         total_transaction_amount
[0m17:50:01.623191 [error] [MainThread]:                    ^
[0m17:50:01.623505 [error] [MainThread]:   compiled Code at target/run/sumup/models/top_ten_products.sql
[0m17:50:01.623838 [info ] [MainThread]: 
[0m17:50:01.624216 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:50:01.624906 [debug] [MainThread]: Command `dbt run` failed at 17:50:01.624775 after 0.82 seconds
[0m17:50:01.625388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bc29d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d8fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e682d0>]}
[0m17:50:01.626038 [debug] [MainThread]: Flushing usage events
[0m17:50:20.613511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9241d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac36e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a67f650>]}


============================== 17:50:20.623587 | 57444e76-4211-48fa-8976-8920b33dcd76 ==============================
[0m17:50:20.623587 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:50:20.624512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m product_agg', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:50:20.751679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57444e76-4211-48fa-8976-8920b33dcd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9fce90>]}
[0m17:50:20.761095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57444e76-4211-48fa-8976-8920b33dcd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af028d0>]}
[0m17:50:20.761910 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:50:20.785861 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:50:20.827337 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:50:20.828100 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:50:20.829526 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 8 unused configuration paths:
- models.my_project.store_transaction_first
- models.my_project.inc_first_five_transaction
- models.my_project.top_ten_products
- models.my_project.store_transaction_view
- models.my_project.avg_transaction_amount
- models.my_project
- models.my_project.top_ten_stores
- models.my_project.pct_transaction
[0m17:50:20.838343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57444e76-4211-48fa-8976-8920b33dcd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a698910>]}
[0m17:50:20.857675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57444e76-4211-48fa-8976-8920b33dcd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af77e10>]}
[0m17:50:20.858280 [info ] [MainThread]: Found 8 models, 22 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:50:20.858740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57444e76-4211-48fa-8976-8920b33dcd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5abf10>]}
[0m17:50:20.861723 [info ] [MainThread]: 
[0m17:50:20.862755 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:50:20.864202 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m17:50:20.878847 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m17:50:20.879450 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m17:50:20.879844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:20.920734 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:50:20.922936 [debug] [ThreadPool]: On list_merveyasa: Close
[0m17:50:20.925876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m17:50:20.936513 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:50:20.937182 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m17:50:20.937572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:20.956241 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:50:20.957027 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:50:20.957856 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m17:50:20.972262 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m17:50:20.974843 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m17:50:20.976241 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m17:50:20.991695 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:20.992530 [debug] [MainThread]: On master: BEGIN
[0m17:50:20.993361 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:21.008033 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:50:21.008968 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:21.009798 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:50:21.059648 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m17:50:21.069902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57444e76-4211-48fa-8976-8920b33dcd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af4ad10>]}
[0m17:50:21.071548 [debug] [MainThread]: On master: ROLLBACK
[0m17:50:21.072945 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:21.074013 [debug] [MainThread]: On master: BEGIN
[0m17:50:21.075830 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:50:21.078559 [debug] [MainThread]: On master: COMMIT
[0m17:50:21.079228 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:21.081390 [debug] [MainThread]: On master: COMMIT
[0m17:50:21.082698 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:50:21.083220 [debug] [MainThread]: On master: Close
[0m17:50:21.086195 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:50:21.087397 [info ] [MainThread]: 
[0m17:50:21.090785 [debug] [Thread-1 (]: Began running node model.sumup.product_agg
[0m17:50:21.091466 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.product_agg .............................. [RUN]
[0m17:50:21.092445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.product_agg)
[0m17:50:21.093159 [debug] [Thread-1 (]: Began compiling node model.sumup.product_agg
[0m17:50:21.108455 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.product_agg"
[0m17:50:21.110271 [debug] [Thread-1 (]: Timing info for model.sumup.product_agg (compile): 17:50:21.093776 => 17:50:21.109471
[0m17:50:21.111418 [debug] [Thread-1 (]: Began executing node model.sumup.product_agg
[0m17:50:21.184737 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.product_agg"
[0m17:50:21.185725 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m17:50:21.186162 [debug] [Thread-1 (]: On model.sumup.product_agg: BEGIN
[0m17:50:21.186571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:21.192985 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:50:21.193468 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m17:50:21.193897 [debug] [Thread-1 (]: On model.sumup.product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.product_agg"} */

  create view "merveyasa"."dbt_merve"."product_agg__dbt_tmp"
    
    
  as (
    

WITH products_aggregated AS
(
SELECT
    product_name,
    product_sku,
    COUNT(*) AS transactions_count,
    SUM(transaction_amount) AS total_transaction_amount
FROM
    transactions
WHERE
    transaction_status = 'accepted' 
GROUP BY
    product_name, product_sku
)
select * from products_aggregated
  );
[0m17:50:21.198536 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:50:21.205456 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m17:50:21.205935 [debug] [Thread-1 (]: On model.sumup.product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.product_agg"} */
alter table "merveyasa"."dbt_merve"."product_agg" rename to "product_agg__dbt_backup"
[0m17:50:21.206776 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:50:21.210824 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m17:50:21.211521 [debug] [Thread-1 (]: On model.sumup.product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.product_agg"} */
alter table "merveyasa"."dbt_merve"."product_agg__dbt_tmp" rename to "product_agg"
[0m17:50:21.212748 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:50:21.237527 [debug] [Thread-1 (]: On model.sumup.product_agg: COMMIT
[0m17:50:21.238318 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m17:50:21.238947 [debug] [Thread-1 (]: On model.sumup.product_agg: COMMIT
[0m17:50:21.240291 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:50:21.252307 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m17:50:21.253146 [debug] [Thread-1 (]: On model.sumup.product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.product_agg"} */
drop view if exists "merveyasa"."dbt_merve"."product_agg__dbt_backup" cascade
[0m17:50:21.255232 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:50:21.258087 [debug] [Thread-1 (]: Timing info for model.sumup.product_agg (execute): 17:50:21.112092 => 17:50:21.257833
[0m17:50:21.258587 [debug] [Thread-1 (]: On model.sumup.product_agg: Close
[0m17:50:21.259548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57444e76-4211-48fa-8976-8920b33dcd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a727710>]}
[0m17:50:21.260374 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_merve.product_agg ......................... [[32mCREATE VIEW[0m in 0.17s]
[0m17:50:21.261286 [debug] [Thread-1 (]: Finished running node model.sumup.product_agg
[0m17:50:21.263707 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:21.264229 [debug] [MainThread]: On master: BEGIN
[0m17:50:21.264598 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:21.274378 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:50:21.275430 [debug] [MainThread]: On master: COMMIT
[0m17:50:21.276138 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:21.276574 [debug] [MainThread]: On master: COMMIT
[0m17:50:21.277729 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:50:21.278766 [debug] [MainThread]: On master: Close
[0m17:50:21.279784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:21.280494 [debug] [MainThread]: Connection 'model.sumup.product_agg' was properly closed.
[0m17:50:21.281008 [info ] [MainThread]: 
[0m17:50:21.281697 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m17:50:21.283025 [debug] [MainThread]: Command end result
[0m17:50:21.295482 [info ] [MainThread]: 
[0m17:50:21.296367 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:21.297171 [info ] [MainThread]: 
[0m17:50:21.298683 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:50:21.300556 [debug] [MainThread]: Command `dbt run` succeeded at 17:50:21.300134 after 0.72 seconds
[0m17:50:21.301452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9b9750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ecfa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f63c10>]}
[0m17:50:21.302407 [debug] [MainThread]: Flushing usage events
[0m17:50:27.688652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10631a490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063009d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066903d0>]}


============================== 17:50:27.694927 | f3204fed-bf5b-4d6d-9098-5e155797273b ==============================
[0m17:50:27.694927 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:50:27.695917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m top_ten_products', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:50:27.801527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3204fed-bf5b-4d6d-9098-5e155797273b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ccf90>]}
[0m17:50:27.810819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3204fed-bf5b-4d6d-9098-5e155797273b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b6b210>]}
[0m17:50:27.811601 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:50:27.841903 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:50:27.883824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:50:27.884440 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:50:27.885776 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 8 unused configuration paths:
- models.my_project.avg_transaction_amount
- models.my_project.store_transaction_view
- models.my_project.inc_first_five_transaction
- models.my_project.top_ten_stores
- models.my_project.store_transaction_first
- models.my_project.top_ten_products
- models.my_project
- models.my_project.pct_transaction
[0m17:50:27.893692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3204fed-bf5b-4d6d-9098-5e155797273b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb1e10>]}
[0m17:50:27.915806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3204fed-bf5b-4d6d-9098-5e155797273b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a8f10>]}
[0m17:50:27.917185 [info ] [MainThread]: Found 8 models, 22 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:50:27.918657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3204fed-bf5b-4d6d-9098-5e155797273b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d27e50>]}
[0m17:50:27.923000 [info ] [MainThread]: 
[0m17:50:27.924733 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:50:27.927031 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m17:50:27.959176 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m17:50:27.959932 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m17:50:27.960477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:27.993100 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:50:27.995172 [debug] [ThreadPool]: On list_merveyasa: Close
[0m17:50:27.997990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m17:50:28.005881 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:50:28.006363 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m17:50:28.006761 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:28.013520 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:50:28.013982 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:50:28.014399 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m17:50:28.018895 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m17:50:28.020638 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m17:50:28.021270 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m17:50:28.028388 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:28.028829 [debug] [MainThread]: On master: BEGIN
[0m17:50:28.029189 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:28.035746 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:50:28.036189 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:28.036677 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:50:28.057341 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m17:50:28.059513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3204fed-bf5b-4d6d-9098-5e155797273b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10505e350>]}
[0m17:50:28.059972 [debug] [MainThread]: On master: ROLLBACK
[0m17:50:28.060549 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:28.060883 [debug] [MainThread]: On master: BEGIN
[0m17:50:28.061467 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:50:28.061873 [debug] [MainThread]: On master: COMMIT
[0m17:50:28.062209 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:28.062552 [debug] [MainThread]: On master: COMMIT
[0m17:50:28.063010 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:50:28.063365 [debug] [MainThread]: On master: Close
[0m17:50:28.064145 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:50:28.064669 [info ] [MainThread]: 
[0m17:50:28.067351 [debug] [Thread-1 (]: Began running node model.sumup.top_ten_products
[0m17:50:28.067903 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.top_ten_products ......................... [RUN]
[0m17:50:28.068681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.top_ten_products)
[0m17:50:28.069246 [debug] [Thread-1 (]: Began compiling node model.sumup.top_ten_products
[0m17:50:28.080738 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.top_ten_products"
[0m17:50:28.082248 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_products (compile): 17:50:28.069553 => 17:50:28.081886
[0m17:50:28.082756 [debug] [Thread-1 (]: Began executing node model.sumup.top_ten_products
[0m17:50:28.132944 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.top_ten_products"
[0m17:50:28.133915 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m17:50:28.134429 [debug] [Thread-1 (]: On model.sumup.top_ten_products: BEGIN
[0m17:50:28.135035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:50:28.141841 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:50:28.142327 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m17:50:28.142754 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */

  create view "merveyasa"."dbt_merve"."top_ten_products__dbt_tmp"
    
    
  as (
    

WITH top_ten_products AS (
    SELECT
        product_name,
        product_sku,
        transactions_count,
        total_transaction_amount
    FROM "merveyasa"."dbt_merve"."product_agg"
    ORDER BY
        total_transaction_amount DESC
    LIMIT 10
)

SELECT * FROM top_ten_products
  );
[0m17:50:28.146687 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:50:28.154041 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m17:50:28.154564 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */
alter table "merveyasa"."dbt_merve"."top_ten_products" rename to "top_ten_products__dbt_backup"
[0m17:50:28.155913 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:50:28.159560 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m17:50:28.160394 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */
alter table "merveyasa"."dbt_merve"."top_ten_products__dbt_tmp" rename to "top_ten_products"
[0m17:50:28.161586 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:50:28.190013 [debug] [Thread-1 (]: On model.sumup.top_ten_products: COMMIT
[0m17:50:28.190873 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m17:50:28.191693 [debug] [Thread-1 (]: On model.sumup.top_ten_products: COMMIT
[0m17:50:28.193306 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:50:28.213848 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m17:50:28.214893 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */
drop view if exists "merveyasa"."dbt_merve"."top_ten_products__dbt_backup" cascade
[0m17:50:28.217644 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:50:28.223968 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_products (execute): 17:50:28.083080 => 17:50:28.220602
[0m17:50:28.225211 [debug] [Thread-1 (]: On model.sumup.top_ten_products: Close
[0m17:50:28.229154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3204fed-bf5b-4d6d-9098-5e155797273b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb6190>]}
[0m17:50:28.230698 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_merve.top_ten_products .................... [[32mCREATE VIEW[0m in 0.16s]
[0m17:50:28.232364 [debug] [Thread-1 (]: Finished running node model.sumup.top_ten_products
[0m17:50:28.236139 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:28.236911 [debug] [MainThread]: On master: BEGIN
[0m17:50:28.237813 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:28.251450 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:50:28.252419 [debug] [MainThread]: On master: COMMIT
[0m17:50:28.253042 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:28.253472 [debug] [MainThread]: On master: COMMIT
[0m17:50:28.254395 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:50:28.255227 [debug] [MainThread]: On master: Close
[0m17:50:28.257873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:28.259141 [debug] [MainThread]: Connection 'model.sumup.top_ten_products' was properly closed.
[0m17:50:28.260013 [info ] [MainThread]: 
[0m17:50:28.261142 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m17:50:28.262300 [debug] [MainThread]: Command end result
[0m17:50:28.280820 [info ] [MainThread]: 
[0m17:50:28.281720 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:28.282856 [info ] [MainThread]: 
[0m17:50:28.283919 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:50:28.288316 [debug] [MainThread]: Command `dbt run` succeeded at 17:50:28.287833 after 0.63 seconds
[0m17:50:28.289675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106897e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101cc0c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101cc0c90>]}
[0m17:50:28.290387 [debug] [MainThread]: Flushing usage events
[0m17:52:22.874645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134960d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113520d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11321c890>]}


============================== 17:52:22.881897 | e0284570-2856-40c0-8dc5-6ec4a2d14b18 ==============================
[0m17:52:22.881897 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:52:22.882744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m top_ten_products', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:52:23.034481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0284570-2856-40c0-8dc5-6ec4a2d14b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132c29d0>]}
[0m17:52:23.055945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0284570-2856-40c0-8dc5-6ec4a2d14b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b54a90>]}
[0m17:52:23.061587 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:52:23.111734 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:52:23.195791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:52:23.196724 [debug] [MainThread]: Partial parsing: updated file: sumup://models/top_ten_products.sql
[0m17:52:23.290265 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 8 unused configuration paths:
- models.my_project.store_transaction_first
- models.my_project.inc_first_five_transaction
- models.my_project.pct_transaction
- models.my_project.top_ten_products
- models.my_project.avg_transaction_amount
- models.my_project
- models.my_project.store_transaction_view
- models.my_project.top_ten_stores
[0m17:52:23.298930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0284570-2856-40c0-8dc5-6ec4a2d14b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d20390>]}
[0m17:52:23.326509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0284570-2856-40c0-8dc5-6ec4a2d14b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137ade50>]}
[0m17:52:23.327466 [info ] [MainThread]: Found 8 models, 22 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:52:23.329366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0284570-2856-40c0-8dc5-6ec4a2d14b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131ea350>]}
[0m17:52:23.332565 [info ] [MainThread]: 
[0m17:52:23.333681 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:52:23.335355 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m17:52:23.356846 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m17:52:23.357405 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m17:52:23.357828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:23.468275 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:52:23.470611 [debug] [ThreadPool]: On list_merveyasa: Close
[0m17:52:23.477272 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m17:52:23.492871 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:52:23.494482 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m17:52:23.495141 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:52:23.506592 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:52:23.508367 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m17:52:23.509153 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m17:52:23.516994 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m17:52:23.519305 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m17:52:23.520049 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m17:52:23.534654 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:23.535175 [debug] [MainThread]: On master: BEGIN
[0m17:52:23.535567 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:52:23.546955 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:52:23.548606 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:23.549329 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:52:23.580553 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m17:52:23.583137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0284570-2856-40c0-8dc5-6ec4a2d14b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8b2250>]}
[0m17:52:23.583737 [debug] [MainThread]: On master: ROLLBACK
[0m17:52:23.584511 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:23.585010 [debug] [MainThread]: On master: BEGIN
[0m17:52:23.585702 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:52:23.586181 [debug] [MainThread]: On master: COMMIT
[0m17:52:23.586565 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:23.587692 [debug] [MainThread]: On master: COMMIT
[0m17:52:23.589307 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:52:23.589893 [debug] [MainThread]: On master: Close
[0m17:52:23.590866 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:52:23.591547 [info ] [MainThread]: 
[0m17:52:23.595244 [debug] [Thread-1 (]: Began running node model.sumup.top_ten_products
[0m17:52:23.596970 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.top_ten_products ......................... [RUN]
[0m17:52:23.598151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.top_ten_products)
[0m17:52:23.598885 [debug] [Thread-1 (]: Began compiling node model.sumup.top_ten_products
[0m17:52:23.610833 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.top_ten_products"
[0m17:52:23.612468 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_products (compile): 17:52:23.599369 => 17:52:23.611786
[0m17:52:23.613926 [debug] [Thread-1 (]: Began executing node model.sumup.top_ten_products
[0m17:52:23.666961 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.top_ten_products"
[0m17:52:23.667892 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m17:52:23.668372 [debug] [Thread-1 (]: On model.sumup.top_ten_products: BEGIN
[0m17:52:23.668884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:23.676061 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:52:23.676647 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m17:52:23.677124 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */

  create view "merveyasa"."dbt_merve"."top_ten_products__dbt_tmp"
    
    
  as (
    

WITH top_ten_products AS (
    SELECT
        product_name,
        product_sku,
        transactions_count,
        total_transaction_amount
    FROM "merveyasa"."dbt_merve"."product_agg"
    ORDER BY
        transactions_count DESC
    LIMIT 10
)

SELECT * FROM top_ten_products
  );
[0m17:52:23.680835 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:52:23.689330 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m17:52:23.690091 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */
alter table "merveyasa"."dbt_merve"."top_ten_products" rename to "top_ten_products__dbt_backup"
[0m17:52:23.691424 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:52:23.695841 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m17:52:23.696341 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */
alter table "merveyasa"."dbt_merve"."top_ten_products__dbt_tmp" rename to "top_ten_products"
[0m17:52:23.697280 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:52:23.717469 [debug] [Thread-1 (]: On model.sumup.top_ten_products: COMMIT
[0m17:52:23.717971 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m17:52:23.718359 [debug] [Thread-1 (]: On model.sumup.top_ten_products: COMMIT
[0m17:52:23.719987 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:52:23.730459 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m17:52:23.730915 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */
drop view if exists "merveyasa"."dbt_merve"."top_ten_products__dbt_backup" cascade
[0m17:52:23.732597 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:52:23.734430 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_products (execute): 17:52:23.614600 => 17:52:23.734210
[0m17:52:23.734856 [debug] [Thread-1 (]: On model.sumup.top_ten_products: Close
[0m17:52:23.735920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0284570-2856-40c0-8dc5-6ec4a2d14b18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c02290>]}
[0m17:52:23.736774 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_merve.top_ten_products .................... [[32mCREATE VIEW[0m in 0.14s]
[0m17:52:23.737531 [debug] [Thread-1 (]: Finished running node model.sumup.top_ten_products
[0m17:52:23.739866 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:23.740271 [debug] [MainThread]: On master: BEGIN
[0m17:52:23.740598 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:52:23.747495 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:52:23.748077 [debug] [MainThread]: On master: COMMIT
[0m17:52:23.748451 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:23.748833 [debug] [MainThread]: On master: COMMIT
[0m17:52:23.749422 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:52:23.750011 [debug] [MainThread]: On master: Close
[0m17:52:23.751089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:52:23.751604 [debug] [MainThread]: Connection 'model.sumup.top_ten_products' was properly closed.
[0m17:52:23.752123 [info ] [MainThread]: 
[0m17:52:23.752565 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m17:52:23.753349 [debug] [MainThread]: Command end result
[0m17:52:23.765538 [info ] [MainThread]: 
[0m17:52:23.767479 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:52:23.768124 [info ] [MainThread]: 
[0m17:52:23.768673 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:52:23.769550 [debug] [MainThread]: Command `dbt run` succeeded at 17:52:23.769421 after 0.93 seconds
[0m17:52:23.770030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea8fbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea9c890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea9c510>]}
[0m17:52:23.770517 [debug] [MainThread]: Flushing usage events
[0m18:25:43.613806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e22150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113aa010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e22650>]}


============================== 18:25:43.624351 | 95411942-d4b1-44ed-b455-99e05b47dbb2 ==============================
[0m18:25:43.624351 [info ] [MainThread]: Running with dbt=1.6.0
[0m18:25:43.625418 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'debug': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:25:43.819907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95411942-d4b1-44ed-b455-99e05b47dbb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110d14d0>]}
[0m18:25:43.829041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95411942-d4b1-44ed-b455-99e05b47dbb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116739d0>]}
[0m18:25:43.830550 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m18:25:43.866112 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m18:25:43.976133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:25:43.976728 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:25:43.978248 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 8 unused configuration paths:
- models.my_project.store_transaction_view
- models.my_project
- models.my_project.top_ten_products
- models.my_project.store_transaction_first
- models.my_project.pct_transaction
- models.my_project.top_ten_stores
- models.my_project.avg_transaction_amount
- models.my_project.inc_first_five_transaction
[0m18:25:43.988534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95411942-d4b1-44ed-b455-99e05b47dbb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117b5ad0>]}
[0m18:25:44.037346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95411942-d4b1-44ed-b455-99e05b47dbb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111090d90>]}
[0m18:25:44.038390 [info ] [MainThread]: Found 8 models, 22 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:25:44.039354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95411942-d4b1-44ed-b455-99e05b47dbb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11182fed0>]}
[0m18:25:44.042871 [info ] [MainThread]: 
[0m18:25:44.043943 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:25:44.045930 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m18:25:44.063398 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m18:25:44.063933 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m18:25:44.064360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:44.120805 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:25:44.122661 [debug] [ThreadPool]: On list_merveyasa: Close
[0m18:25:44.125784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m18:25:44.132677 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m18:25:44.133146 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m18:25:44.133469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:44.143451 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:25:44.144072 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m18:25:44.144610 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m18:25:44.149003 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:25:44.150627 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m18:25:44.151256 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m18:25:44.157401 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:44.157899 [debug] [MainThread]: On master: BEGIN
[0m18:25:44.158294 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:25:44.165561 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:25:44.166050 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:44.166577 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:25:44.178000 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:25:44.179624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95411942-d4b1-44ed-b455-99e05b47dbb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11117b690>]}
[0m18:25:44.180503 [debug] [MainThread]: On master: ROLLBACK
[0m18:25:44.181116 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:44.181529 [debug] [MainThread]: On master: BEGIN
[0m18:25:44.182176 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:25:44.182619 [debug] [MainThread]: On master: COMMIT
[0m18:25:44.183002 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:44.183370 [debug] [MainThread]: On master: COMMIT
[0m18:25:44.183957 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:25:44.184383 [debug] [MainThread]: On master: Close
[0m18:25:44.185308 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:25:44.185941 [info ] [MainThread]: 
[0m18:25:44.189693 [debug] [Thread-1 (]: Began running node model.sumup.product_agg
[0m18:25:44.190388 [info ] [Thread-1 (]: 1 of 8 START sql view model dbt_merve.product_agg .............................. [RUN]
[0m18:25:44.191456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.product_agg)
[0m18:25:44.192108 [debug] [Thread-1 (]: Began compiling node model.sumup.product_agg
[0m18:25:44.205918 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.product_agg"
[0m18:25:44.207727 [debug] [Thread-1 (]: Timing info for model.sumup.product_agg (compile): 18:25:44.192545 => 18:25:44.207263
[0m18:25:44.208331 [debug] [Thread-1 (]: Began executing node model.sumup.product_agg
[0m18:25:44.274006 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.product_agg"
[0m18:25:44.275237 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m18:25:44.275758 [debug] [Thread-1 (]: On model.sumup.product_agg: BEGIN
[0m18:25:44.276206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:44.283461 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:44.284030 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m18:25:44.284521 [debug] [Thread-1 (]: On model.sumup.product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.product_agg"} */

  create view "merveyasa"."dbt_merve"."product_agg__dbt_tmp"
    
    
  as (
    

WITH products_aggregated AS
(
SELECT
    product_name,
    product_sku,
    COUNT(*) AS transactions_count,
    SUM(transaction_amount) AS total_transaction_amount
FROM
    transactions
WHERE
    transaction_status = 'accepted' 
GROUP BY
    product_name, product_sku
)
select * from products_aggregated
  );
[0m18:25:44.289569 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:25:44.297351 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m18:25:44.297919 [debug] [Thread-1 (]: On model.sumup.product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.product_agg"} */
alter table "merveyasa"."dbt_merve"."product_agg__dbt_tmp" rename to "product_agg"
[0m18:25:44.298915 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:25:44.318238 [debug] [Thread-1 (]: On model.sumup.product_agg: COMMIT
[0m18:25:44.318817 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m18:25:44.319232 [debug] [Thread-1 (]: On model.sumup.product_agg: COMMIT
[0m18:25:44.320501 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:25:44.330596 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m18:25:44.331125 [debug] [Thread-1 (]: On model.sumup.product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.product_agg"} */
drop view if exists "merveyasa"."dbt_merve"."product_agg__dbt_backup" cascade
[0m18:25:44.331854 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:25:44.333631 [debug] [Thread-1 (]: Timing info for model.sumup.product_agg (execute): 18:25:44.208669 => 18:25:44.333389
[0m18:25:44.334167 [debug] [Thread-1 (]: On model.sumup.product_agg: Close
[0m18:25:44.335233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95411942-d4b1-44ed-b455-99e05b47dbb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110624590>]}
[0m18:25:44.336156 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dbt_merve.product_agg ......................... [[32mCREATE VIEW[0m in 0.14s]
[0m18:25:44.337009 [debug] [Thread-1 (]: Finished running node model.sumup.product_agg
[0m18:25:44.337558 [debug] [Thread-1 (]: Began running node model.sumup.store_transaction_view
[0m18:25:44.338554 [info ] [Thread-1 (]: 2 of 8 START sql view model dbt_merve.store_transaction_view ................... [RUN]
[0m18:25:44.339799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.product_agg, now model.sumup.store_transaction_view)
[0m18:25:44.340357 [debug] [Thread-1 (]: Began compiling node model.sumup.store_transaction_view
[0m18:25:44.343970 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.store_transaction_view"
[0m18:25:44.345684 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_view (compile): 18:25:44.340706 => 18:25:44.345264
[0m18:25:44.346342 [debug] [Thread-1 (]: Began executing node model.sumup.store_transaction_view
[0m18:25:44.352943 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.store_transaction_view"
[0m18:25:44.355255 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m18:25:44.356083 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: BEGIN
[0m18:25:44.356746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:44.366747 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:44.367702 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m18:25:44.368628 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */

  create view "merveyasa"."dbt_merve"."store_transaction_view__dbt_tmp"
    
    
  as (
    

WITH store_transactions AS
(
SELECT
    s.store_id,
    s.store_typology,
    s.store_country,
    LOWER(REGEXP_REPLACE(t.product_name, '[^a-zA-Z\s]+', '', 'g')),
    t.product_sku,
    t.category_name,
    t.transaction_amount,
    t.transaction_status,
    t.transaction_happened_at,
    d.device_type
FROM
    transactions t
JOIN devices d ON t.device_id = d.device_id
JOIN stores s ON d.store_id = s.store_id
)

select * from store_transactions
  );
[0m18:25:44.377942 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:25:44.383312 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m18:25:44.383918 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */
alter table "merveyasa"."dbt_merve"."store_transaction_view__dbt_tmp" rename to "store_transaction_view"
[0m18:25:44.388832 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:25:44.391444 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: COMMIT
[0m18:25:44.392214 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m18:25:44.392698 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: COMMIT
[0m18:25:44.394015 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:25:44.397966 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m18:25:44.398681 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */
drop view if exists "merveyasa"."dbt_merve"."store_transaction_view__dbt_backup" cascade
[0m18:25:44.400159 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:25:44.404575 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_view (execute): 18:25:44.346708 => 18:25:44.404247
[0m18:25:44.405168 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: Close
[0m18:25:44.406879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95411942-d4b1-44ed-b455-99e05b47dbb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e0a110>]}
[0m18:25:44.407940 [info ] [Thread-1 (]: 2 of 8 OK created sql view model dbt_merve.store_transaction_view .............. [[32mCREATE VIEW[0m in 0.07s]
[0m18:25:44.409151 [debug] [Thread-1 (]: Finished running node model.sumup.store_transaction_view
[0m18:25:44.409943 [debug] [Thread-1 (]: Began running node model.sumup.top_ten_products
[0m18:25:44.410984 [info ] [Thread-1 (]: 3 of 8 START sql view model dbt_merve.top_ten_products ......................... [RUN]
[0m18:25:44.412567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.store_transaction_view, now model.sumup.top_ten_products)
[0m18:25:44.413163 [debug] [Thread-1 (]: Began compiling node model.sumup.top_ten_products
[0m18:25:44.418147 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.top_ten_products"
[0m18:25:44.420029 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_products (compile): 18:25:44.413746 => 18:25:44.419682
[0m18:25:44.420544 [debug] [Thread-1 (]: Began executing node model.sumup.top_ten_products
[0m18:25:44.426767 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.top_ten_products"
[0m18:25:44.427806 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m18:25:44.428298 [debug] [Thread-1 (]: On model.sumup.top_ten_products: BEGIN
[0m18:25:44.428740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:44.440775 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:44.441408 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m18:25:44.441913 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */

  create view "merveyasa"."dbt_merve"."top_ten_products__dbt_tmp"
    
    
  as (
    

WITH top_ten_products AS (
    SELECT
        product_name,
        product_sku,
        transactions_count,
        total_transaction_amount
    FROM "merveyasa"."dbt_merve"."product_agg"
    ORDER BY
        transactions_count DESC
    LIMIT 10
)

SELECT * FROM top_ten_products
  );
[0m18:25:44.448663 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:25:44.454039 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m18:25:44.454611 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */
alter table "merveyasa"."dbt_merve"."top_ten_products__dbt_tmp" rename to "top_ten_products"
[0m18:25:44.455591 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:25:44.457821 [debug] [Thread-1 (]: On model.sumup.top_ten_products: COMMIT
[0m18:25:44.458743 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m18:25:44.462220 [debug] [Thread-1 (]: On model.sumup.top_ten_products: COMMIT
[0m18:25:44.467593 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:25:44.477786 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m18:25:44.478539 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */
drop view if exists "merveyasa"."dbt_merve"."top_ten_products__dbt_backup" cascade
[0m18:25:44.479609 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:25:44.481670 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_products (execute): 18:25:44.420929 => 18:25:44.481397
[0m18:25:44.482197 [debug] [Thread-1 (]: On model.sumup.top_ten_products: Close
[0m18:25:44.483475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95411942-d4b1-44ed-b455-99e05b47dbb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111df4990>]}
[0m18:25:44.484363 [info ] [Thread-1 (]: 3 of 8 OK created sql view model dbt_merve.top_ten_products .................... [[32mCREATE VIEW[0m in 0.07s]
[0m18:25:44.485440 [debug] [Thread-1 (]: Finished running node model.sumup.top_ten_products
[0m18:25:44.486037 [debug] [Thread-1 (]: Began running node model.sumup.avg_transaction_amount
[0m18:25:44.487075 [info ] [Thread-1 (]: 4 of 8 START sql incremental model dbt_merve.avg_transaction_amount ............ [RUN]
[0m18:25:44.488188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.top_ten_products, now model.sumup.avg_transaction_amount)
[0m18:25:44.488843 [debug] [Thread-1 (]: Began compiling node model.sumup.avg_transaction_amount
[0m18:25:44.506546 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.avg_transaction_amount"
[0m18:25:44.510586 [debug] [Thread-1 (]: Timing info for model.sumup.avg_transaction_amount (compile): 18:25:44.489220 => 18:25:44.510098
[0m18:25:44.511363 [debug] [Thread-1 (]: Began executing node model.sumup.avg_transaction_amount
[0m18:25:44.578987 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.avg_transaction_amount"
[0m18:25:44.580125 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m18:25:44.580630 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: BEGIN
[0m18:25:44.581126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:44.588107 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:44.588922 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m18:25:44.589617 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.avg_transaction_amount"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."avg_transaction_amount"
  
  
    as
  
  (
    


    SELECT store_typology, store_country, AVG(transaction_amount) AS average_transaction_amount
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
    GROUP BY store_typology, store_country

  );
  
  
[0m18:25:44.598439 [debug] [Thread-1 (]: SQL status: SELECT 74 in 0.0 seconds
[0m18:25:44.606646 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: COMMIT
[0m18:25:44.607400 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m18:25:44.608084 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: COMMIT
[0m18:25:44.609447 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:25:44.611180 [debug] [Thread-1 (]: Timing info for model.sumup.avg_transaction_amount (execute): 18:25:44.511943 => 18:25:44.610778
[0m18:25:44.611909 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: Close
[0m18:25:44.613300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95411942-d4b1-44ed-b455-99e05b47dbb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110d1810>]}
[0m18:25:44.614455 [info ] [Thread-1 (]: 4 of 8 OK created sql incremental model dbt_merve.avg_transaction_amount ....... [[32mSELECT 74[0m in 0.13s]
[0m18:25:44.615428 [debug] [Thread-1 (]: Finished running node model.sumup.avg_transaction_amount
[0m18:25:44.615950 [debug] [Thread-1 (]: Began running node model.sumup.pct_transaction
[0m18:25:44.616448 [info ] [Thread-1 (]: 5 of 8 START sql view model dbt_merve.pct_transaction .......................... [RUN]
[0m18:25:44.617170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.avg_transaction_amount, now model.sumup.pct_transaction)
[0m18:25:44.617640 [debug] [Thread-1 (]: Began compiling node model.sumup.pct_transaction
[0m18:25:44.622719 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.pct_transaction"
[0m18:25:44.625396 [debug] [Thread-1 (]: Timing info for model.sumup.pct_transaction (compile): 18:25:44.618106 => 18:25:44.624951
[0m18:25:44.626233 [debug] [Thread-1 (]: Began executing node model.sumup.pct_transaction
[0m18:25:44.633611 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.pct_transaction"
[0m18:25:44.634598 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m18:25:44.639332 [debug] [Thread-1 (]: On model.sumup.pct_transaction: BEGIN
[0m18:25:44.639987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:44.671404 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:44.672188 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m18:25:44.673859 [debug] [Thread-1 (]: On model.sumup.pct_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.pct_transaction"} */

  create view "merveyasa"."dbt_merve"."pct_transaction__dbt_tmp"
    
    
  as (
    

WITH pct_transaction AS (
    SELECT device_type, COUNT(*) * 100.0 / SUM(COUNT(*)) OVER () AS percentage
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
    GROUP BY device_type
)
SELECT * FROM pct_transaction
ORDER BY device_type
  );
[0m18:25:44.680900 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:25:44.686918 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m18:25:44.687688 [debug] [Thread-1 (]: On model.sumup.pct_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.pct_transaction"} */
alter table "merveyasa"."dbt_merve"."pct_transaction__dbt_tmp" rename to "pct_transaction"
[0m18:25:44.689356 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:25:44.693033 [debug] [Thread-1 (]: On model.sumup.pct_transaction: COMMIT
[0m18:25:44.693765 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m18:25:44.694397 [debug] [Thread-1 (]: On model.sumup.pct_transaction: COMMIT
[0m18:25:44.695752 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:25:44.701230 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m18:25:44.702546 [debug] [Thread-1 (]: On model.sumup.pct_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.pct_transaction"} */
drop view if exists "merveyasa"."dbt_merve"."pct_transaction__dbt_backup" cascade
[0m18:25:44.703836 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:25:44.706247 [debug] [Thread-1 (]: Timing info for model.sumup.pct_transaction (execute): 18:25:44.626746 => 18:25:44.705905
[0m18:25:44.706895 [debug] [Thread-1 (]: On model.sumup.pct_transaction: Close
[0m18:25:44.708212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95411942-d4b1-44ed-b455-99e05b47dbb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111269210>]}
[0m18:25:44.709263 [info ] [Thread-1 (]: 5 of 8 OK created sql view model dbt_merve.pct_transaction ..................... [[32mCREATE VIEW[0m in 0.09s]
[0m18:25:44.710413 [debug] [Thread-1 (]: Finished running node model.sumup.pct_transaction
[0m18:25:44.711231 [debug] [Thread-1 (]: Began running node model.sumup.store_transaction_first
[0m18:25:44.712857 [info ] [Thread-1 (]: 6 of 8 START sql view model dbt_merve.store_transaction_first .................. [RUN]
[0m18:25:44.714277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.pct_transaction, now model.sumup.store_transaction_first)
[0m18:25:44.714942 [debug] [Thread-1 (]: Began compiling node model.sumup.store_transaction_first
[0m18:25:44.720844 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.store_transaction_first"
[0m18:25:44.725101 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_first (compile): 18:25:44.715439 => 18:25:44.723843
[0m18:25:44.725941 [debug] [Thread-1 (]: Began executing node model.sumup.store_transaction_first
[0m18:25:44.740534 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.store_transaction_first"
[0m18:25:44.742359 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m18:25:44.743544 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: BEGIN
[0m18:25:44.744463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:44.758644 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:44.759409 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m18:25:44.760114 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_first"} */

  create view "merveyasa"."dbt_merve"."store_transaction_first__dbt_tmp"
    
    
  as (
    

WITH numbered_transactions AS (
    SELECT
        store_id,
        transaction_happened_at,
        ROW_NUMBER() OVER (PARTITION BY store_id ORDER BY transaction_happened_at) AS rownumber
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
)
SELECT
    store_id,
    transaction_happened_at
FROM numbered_transactions
WHERE rownumber <= 5
  );
[0m18:25:44.768192 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:25:44.775112 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m18:25:44.775950 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_first"} */
alter table "merveyasa"."dbt_merve"."store_transaction_first__dbt_tmp" rename to "store_transaction_first"
[0m18:25:44.777254 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:25:44.781486 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: COMMIT
[0m18:25:44.782802 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m18:25:44.783553 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: COMMIT
[0m18:25:44.784929 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:25:44.790897 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m18:25:44.792069 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_first"} */
drop view if exists "merveyasa"."dbt_merve"."store_transaction_first__dbt_backup" cascade
[0m18:25:44.793317 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:25:44.795920 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_first (execute): 18:25:44.726430 => 18:25:44.795567
[0m18:25:44.797061 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: Close
[0m18:25:44.798390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95411942-d4b1-44ed-b455-99e05b47dbb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110d1810>]}
[0m18:25:44.799675 [info ] [Thread-1 (]: 6 of 8 OK created sql view model dbt_merve.store_transaction_first ............. [[32mCREATE VIEW[0m in 0.08s]
[0m18:25:44.801084 [debug] [Thread-1 (]: Finished running node model.sumup.store_transaction_first
[0m18:25:44.801998 [debug] [Thread-1 (]: Began running node model.sumup.top_ten_stores
[0m18:25:44.803655 [info ] [Thread-1 (]: 7 of 8 START sql view model dbt_merve.top_ten_stores ........................... [RUN]
[0m18:25:44.805485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.store_transaction_first, now model.sumup.top_ten_stores)
[0m18:25:44.806823 [debug] [Thread-1 (]: Began compiling node model.sumup.top_ten_stores
[0m18:25:44.818190 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.top_ten_stores"
[0m18:25:44.820495 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_stores (compile): 18:25:44.807615 => 18:25:44.820000
[0m18:25:44.821257 [debug] [Thread-1 (]: Began executing node model.sumup.top_ten_stores
[0m18:25:44.839474 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.top_ten_stores"
[0m18:25:44.840685 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m18:25:44.841301 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: BEGIN
[0m18:25:44.841847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:44.850434 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:44.851146 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m18:25:44.852008 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */

  create view "merveyasa"."dbt_merve"."top_ten_stores__dbt_tmp"
    
    
  as (
    

WITH top_ten_stores AS (
    SELECT store_id, SUM(transaction_amount) AS total_transaction_amount
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
    GROUP BY store_id
    ORDER BY total_transaction_amount DESC
    LIMIT 10
)
SELECT * FROM top_ten_stores
  );
[0m18:25:44.857018 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:25:44.860859 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m18:25:44.861323 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */
alter table "merveyasa"."dbt_merve"."top_ten_stores__dbt_tmp" rename to "top_ten_stores"
[0m18:25:44.862246 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:25:44.864419 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: COMMIT
[0m18:25:44.864955 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m18:25:44.865364 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: COMMIT
[0m18:25:44.866321 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:25:44.869250 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m18:25:44.869678 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */
drop view if exists "merveyasa"."dbt_merve"."top_ten_stores__dbt_backup" cascade
[0m18:25:44.870472 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:25:44.872132 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_stores (execute): 18:25:44.821576 => 18:25:44.871906
[0m18:25:44.872553 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: Close
[0m18:25:44.874820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95411942-d4b1-44ed-b455-99e05b47dbb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e10610>]}
[0m18:25:44.875853 [info ] [Thread-1 (]: 7 of 8 OK created sql view model dbt_merve.top_ten_stores ...................... [[32mCREATE VIEW[0m in 0.07s]
[0m18:25:44.877041 [debug] [Thread-1 (]: Finished running node model.sumup.top_ten_stores
[0m18:25:44.877797 [debug] [Thread-1 (]: Began running node model.sumup.inc_first_five_transaction
[0m18:25:44.878929 [info ] [Thread-1 (]: 8 of 8 START sql incremental model dbt_merve.inc_first_five_transaction ........ [RUN]
[0m18:25:44.880469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.top_ten_stores, now model.sumup.inc_first_five_transaction)
[0m18:25:44.881120 [debug] [Thread-1 (]: Began compiling node model.sumup.inc_first_five_transaction
[0m18:25:44.891889 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.inc_first_five_transaction"
[0m18:25:44.894074 [debug] [Thread-1 (]: Timing info for model.sumup.inc_first_five_transaction (compile): 18:25:44.881574 => 18:25:44.893499
[0m18:25:44.894905 [debug] [Thread-1 (]: Began executing node model.sumup.inc_first_five_transaction
[0m18:25:44.905765 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.inc_first_five_transaction"
[0m18:25:44.907238 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m18:25:44.908021 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: BEGIN
[0m18:25:44.908748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:44.924739 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:44.925344 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m18:25:44.926121 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.inc_first_five_transaction"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."inc_first_five_transaction"
  
  
    as
  
  (
    


SELECT
    store_id,
    AVG(time_diff) AS avg_time_diff
FROM (
    SELECT
        store_id,
        transaction_happened_at - LAG(transaction_happened_at, 1) OVER (PARTITION BY store_id ORDER BY transaction_happened_at) AS time_diff
    FROM "merveyasa"."dbt_merve"."store_transaction_first"
) subquery
GROUP BY store_id

  );
  
  
[0m18:25:44.939384 [debug] [Thread-1 (]: SQL status: SELECT 87 in 0.0 seconds
[0m18:25:44.943793 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: COMMIT
[0m18:25:44.944695 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m18:25:44.945429 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: COMMIT
[0m18:25:44.946874 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:25:44.948716 [debug] [Thread-1 (]: Timing info for model.sumup.inc_first_five_transaction (execute): 18:25:44.895591 => 18:25:44.948313
[0m18:25:44.949427 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: Close
[0m18:25:44.950874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95411942-d4b1-44ed-b455-99e05b47dbb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e177d0>]}
[0m18:25:44.952186 [info ] [Thread-1 (]: 8 of 8 OK created sql incremental model dbt_merve.inc_first_five_transaction ... [[32mSELECT 87[0m in 0.07s]
[0m18:25:44.953279 [debug] [Thread-1 (]: Finished running node model.sumup.inc_first_five_transaction
[0m18:25:44.957204 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:44.957901 [debug] [MainThread]: On master: BEGIN
[0m18:25:44.958532 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:25:44.966201 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:25:44.966938 [debug] [MainThread]: On master: COMMIT
[0m18:25:44.967376 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:44.967844 [debug] [MainThread]: On master: COMMIT
[0m18:25:44.969165 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:25:44.969957 [debug] [MainThread]: On master: Close
[0m18:25:44.971220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:25:44.971643 [debug] [MainThread]: Connection 'model.sumup.inc_first_five_transaction' was properly closed.
[0m18:25:44.972387 [info ] [MainThread]: 
[0m18:25:44.972997 [info ] [MainThread]: Finished running 6 view models, 2 incremental models in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m18:25:44.976133 [debug] [MainThread]: Command end result
[0m18:25:44.991087 [info ] [MainThread]: 
[0m18:25:44.991791 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:25:44.992400 [info ] [MainThread]: 
[0m18:25:44.993102 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m18:25:44.994284 [debug] [MainThread]: Command `dbt run` succeeded at 18:25:44.994034 after 1.41 seconds
[0m18:25:44.995011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11112ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c717b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c717b90>]}
[0m18:25:44.995675 [debug] [MainThread]: Flushing usage events
[0m18:55:24.051327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f23f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f57c690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f25c310>]}


============================== 18:55:24.063876 | 9fd5b5e5-76e6-4c2c-a503-50ecedddd29e ==============================
[0m18:55:24.063876 [info ] [MainThread]: Running with dbt=1.6.0
[0m18:55:24.065885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m store_transaction_view', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:55:24.276895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fd5b5e5-76e6-4c2c-a503-50ecedddd29e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fac8f90>]}
[0m18:55:24.287700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fd5b5e5-76e6-4c2c-a503-50ecedddd29e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10faca410>]}
[0m18:55:24.289056 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m18:55:24.333127 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m18:55:24.454020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:55:24.454501 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:55:24.455996 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 8 unused configuration paths:
- models.my_project.pct_transaction
- models.my_project.store_transaction_view
- models.my_project
- models.my_project.store_transaction_first
- models.my_project.top_ten_products
- models.my_project.inc_first_five_transaction
- models.my_project.top_ten_stores
- models.my_project.avg_transaction_amount
[0m18:55:24.464864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fd5b5e5-76e6-4c2c-a503-50ecedddd29e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbf2090>]}
[0m18:55:24.488932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fd5b5e5-76e6-4c2c-a503-50ecedddd29e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4ec710>]}
[0m18:55:24.489495 [info ] [MainThread]: Found 8 models, 22 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:55:24.489948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fd5b5e5-76e6-4c2c-a503-50ecedddd29e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4c3010>]}
[0m18:55:24.491889 [info ] [MainThread]: 
[0m18:55:24.492886 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:55:24.494894 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m18:55:24.511829 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m18:55:24.512558 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m18:55:24.512907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:24.590178 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:55:24.592745 [debug] [ThreadPool]: On list_merveyasa: Close
[0m18:55:24.595467 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m18:55:24.602808 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m18:55:24.603263 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m18:55:24.603586 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:55:24.610822 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:55:24.611459 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m18:55:24.611918 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m18:55:24.616324 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m18:55:24.618208 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m18:55:24.618865 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m18:55:24.626754 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:24.627334 [debug] [MainThread]: On master: BEGIN
[0m18:55:24.627728 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:55:24.634587 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:55:24.635081 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:24.635601 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:55:24.655620 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m18:55:24.658291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fd5b5e5-76e6-4c2c-a503-50ecedddd29e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb23a90>]}
[0m18:55:24.658895 [debug] [MainThread]: On master: ROLLBACK
[0m18:55:24.659473 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:24.659852 [debug] [MainThread]: On master: BEGIN
[0m18:55:24.660417 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:55:24.660801 [debug] [MainThread]: On master: COMMIT
[0m18:55:24.661164 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:24.661507 [debug] [MainThread]: On master: COMMIT
[0m18:55:24.661967 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:55:24.662337 [debug] [MainThread]: On master: Close
[0m18:55:24.663231 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:55:24.663699 [info ] [MainThread]: 
[0m18:55:24.667353 [debug] [Thread-1 (]: Began running node model.sumup.store_transaction_view
[0m18:55:24.668072 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_merve.store_transaction_view ................... [RUN]
[0m18:55:24.669002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.store_transaction_view)
[0m18:55:24.669514 [debug] [Thread-1 (]: Began compiling node model.sumup.store_transaction_view
[0m18:55:24.681137 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.store_transaction_view"
[0m18:55:24.683872 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_view (compile): 18:55:24.669857 => 18:55:24.682355
[0m18:55:24.684561 [debug] [Thread-1 (]: Began executing node model.sumup.store_transaction_view
[0m18:55:24.746318 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.store_transaction_view"
[0m18:55:24.747724 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m18:55:24.748243 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: BEGIN
[0m18:55:24.748696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:24.756586 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:55:24.757247 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m18:55:24.757755 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */

  create view "merveyasa"."dbt_merve"."store_transaction_view__dbt_tmp"
    
    
  as (
    

WITH store_transactions AS
(
SELECT
    s.store_id,
    s.store_typology,
    s.store_country,
    LOWER(REGEXP_REPLACE(t.product_name, '[^a-zA-Z\s]+', '', 'g')),
    t.product_sku,
    t.category_name,
    t.transaction_amount,
    t.transaction_status,
    t.transaction_happened_at,
    d.device_type
FROM
    transactions t
JOIN devices d ON t.device_id = d.device_id
JOIN stores s ON d.store_id = s.store_id
)

select * from store_transactions
  );
[0m18:55:24.764698 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:55:24.772761 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m18:55:24.773349 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */
alter table "merveyasa"."dbt_merve"."store_transaction_view" rename to "store_transaction_view__dbt_backup"
[0m18:55:24.774408 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:55:24.778339 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m18:55:24.778874 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */
alter table "merveyasa"."dbt_merve"."store_transaction_view__dbt_tmp" rename to "store_transaction_view"
[0m18:55:24.779857 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:55:24.802967 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: COMMIT
[0m18:55:24.803462 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m18:55:24.803889 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: COMMIT
[0m18:55:24.805533 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:55:24.814942 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m18:55:24.815467 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */
drop view if exists "merveyasa"."dbt_merve"."store_transaction_view__dbt_backup" cascade
[0m18:55:24.817995 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:55:24.819812 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_view (execute): 18:55:24.685016 => 18:55:24.819592
[0m18:55:24.820231 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: Close
[0m18:55:24.821333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fd5b5e5-76e6-4c2c-a503-50ecedddd29e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f26efd0>]}
[0m18:55:24.822720 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_merve.store_transaction_view .............. [[32mCREATE VIEW[0m in 0.15s]
[0m18:55:24.823735 [debug] [Thread-1 (]: Finished running node model.sumup.store_transaction_view
[0m18:55:24.827260 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:24.827717 [debug] [MainThread]: On master: BEGIN
[0m18:55:24.828073 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:55:24.839279 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:55:24.839826 [debug] [MainThread]: On master: COMMIT
[0m18:55:24.840233 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:24.840625 [debug] [MainThread]: On master: COMMIT
[0m18:55:24.841266 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:55:24.841733 [debug] [MainThread]: On master: Close
[0m18:55:24.842816 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:24.843521 [debug] [MainThread]: Connection 'model.sumup.store_transaction_view' was properly closed.
[0m18:55:24.844191 [info ] [MainThread]: 
[0m18:55:24.844792 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:55:24.846078 [debug] [MainThread]: Command end result
[0m18:55:24.859724 [info ] [MainThread]: 
[0m18:55:24.860456 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:55:24.861148 [info ] [MainThread]: 
[0m18:55:24.861769 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:55:24.863137 [debug] [MainThread]: Command `dbt run` succeeded at 18:55:24.862964 after 0.85 seconds
[0m18:55:24.863670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aabd590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab53bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac04cd0>]}
[0m18:55:24.864160 [debug] [MainThread]: Flushing usage events
[0m19:03:26.850811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a1390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068376d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b42ad0>]}


============================== 19:03:26.859478 | c06661e6-52e2-4336-b6a0-655d4a79d6e3 ==============================
[0m19:03:26.859478 [info ] [MainThread]: Running with dbt=1.6.0
[0m19:03:26.860558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m19:03:27.007187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c06661e6-52e2-4336-b6a0-655d4a79d6e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10690e690>]}
[0m19:03:27.018057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c06661e6-52e2-4336-b6a0-655d4a79d6e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e28a10>]}
[0m19:03:27.019335 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m19:03:27.054766 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m19:03:27.158266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:03:27.159411 [debug] [MainThread]: Partial parsing: updated file: sumup://models/store_transaction_view.sql
[0m19:03:27.159942 [debug] [MainThread]: Partial parsing: updated file: sumup://models/product_agg.sql
[0m19:03:27.264245 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 8 unused configuration paths:
- models.my_project.top_ten_stores
- models.my_project.store_transaction_view
- models.my_project.store_transaction_first
- models.my_project.inc_first_five_transaction
- models.my_project.pct_transaction
- models.my_project
- models.my_project.top_ten_products
- models.my_project.avg_transaction_amount
[0m19:03:27.271007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c06661e6-52e2-4336-b6a0-655d4a79d6e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e579d0>]}
[0m19:03:27.297548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c06661e6-52e2-4336-b6a0-655d4a79d6e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f370d0>]}
[0m19:03:27.298291 [info ] [MainThread]: Found 8 models, 22 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:03:27.299069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c06661e6-52e2-4336-b6a0-655d4a79d6e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b3ac50>]}
[0m19:03:27.302877 [info ] [MainThread]: 
[0m19:03:27.304672 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:03:27.308619 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m19:03:27.324064 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m19:03:27.324884 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m19:03:27.325925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:27.403161 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m19:03:27.406006 [debug] [ThreadPool]: On list_merveyasa: Close
[0m19:03:27.409443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m19:03:27.417794 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m19:03:27.418295 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m19:03:27.418634 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:03:27.425314 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:03:27.425802 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m19:03:27.426197 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m19:03:27.430647 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m19:03:27.432465 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m19:03:27.433096 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m19:03:27.440240 [debug] [MainThread]: Using postgres connection "master"
[0m19:03:27.440749 [debug] [MainThread]: On master: BEGIN
[0m19:03:27.441132 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:03:27.448375 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:03:27.448872 [debug] [MainThread]: Using postgres connection "master"
[0m19:03:27.449432 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:03:27.466249 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m19:03:27.468277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c06661e6-52e2-4336-b6a0-655d4a79d6e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b42f50>]}
[0m19:03:27.468827 [debug] [MainThread]: On master: ROLLBACK
[0m19:03:27.469410 [debug] [MainThread]: Using postgres connection "master"
[0m19:03:27.469829 [debug] [MainThread]: On master: BEGIN
[0m19:03:27.470494 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:03:27.470897 [debug] [MainThread]: On master: COMMIT
[0m19:03:27.471262 [debug] [MainThread]: Using postgres connection "master"
[0m19:03:27.471610 [debug] [MainThread]: On master: COMMIT
[0m19:03:27.472173 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:03:27.472572 [debug] [MainThread]: On master: Close
[0m19:03:27.473504 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:03:27.474003 [info ] [MainThread]: 
[0m19:03:27.477697 [debug] [Thread-1 (]: Began running node model.sumup.product_agg
[0m19:03:27.478396 [info ] [Thread-1 (]: 1 of 8 START sql view model dbt_merve.product_agg .............................. [RUN]
[0m19:03:27.479485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.product_agg)
[0m19:03:27.480143 [debug] [Thread-1 (]: Began compiling node model.sumup.product_agg
[0m19:03:27.491344 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.product_agg"
[0m19:03:27.492633 [debug] [Thread-1 (]: Timing info for model.sumup.product_agg (compile): 19:03:27.480572 => 19:03:27.492247
[0m19:03:27.493211 [debug] [Thread-1 (]: Began executing node model.sumup.product_agg
[0m19:03:27.546307 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.product_agg"
[0m19:03:27.547476 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m19:03:27.548122 [debug] [Thread-1 (]: On model.sumup.product_agg: BEGIN
[0m19:03:27.548581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:27.555675 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:03:27.556235 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m19:03:27.556724 [debug] [Thread-1 (]: On model.sumup.product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.product_agg"} */

  create view "merveyasa"."dbt_merve"."product_agg__dbt_tmp"
    
    
  as (
    

WITH products_aggregated AS
(
SELECT
    LOWER(REGEXP_REPLACE(product_name, '[^a-zA-Z\s]+', '', 'g')) as product_name,
    (CASE 
        WHEN product_sku ~ E'^\\d+\\.\\d+E\\+\\d+$' 
        THEN LTRIM(TO_CHAR(CAST(product_sku AS DOUBLE PRECISION), '9999999999999999999999999'))
        ELSE product_sku
    END) as product_sku,
    COUNT(*) AS transactions_count,
    SUM(transaction_amount) AS total_transaction_amount
FROM
    transactions
WHERE
    transaction_status = 'accepted' 
GROUP BY
    product_name, product_sku
)
select * from products_aggregated
  );
[0m19:03:27.561727 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:03:27.569304 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m19:03:27.569875 [debug] [Thread-1 (]: On model.sumup.product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.product_agg"} */
alter table "merveyasa"."dbt_merve"."product_agg" rename to "product_agg__dbt_backup"
[0m19:03:27.570942 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:03:27.574865 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m19:03:27.575382 [debug] [Thread-1 (]: On model.sumup.product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.product_agg"} */
alter table "merveyasa"."dbt_merve"."product_agg__dbt_tmp" rename to "product_agg"
[0m19:03:27.576368 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:03:27.596416 [debug] [Thread-1 (]: On model.sumup.product_agg: COMMIT
[0m19:03:27.596960 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m19:03:27.597356 [debug] [Thread-1 (]: On model.sumup.product_agg: COMMIT
[0m19:03:27.599398 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:03:27.609593 [debug] [Thread-1 (]: Using postgres connection "model.sumup.product_agg"
[0m19:03:27.610102 [debug] [Thread-1 (]: On model.sumup.product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.product_agg"} */
drop view if exists "merveyasa"."dbt_merve"."product_agg__dbt_backup" cascade
[0m19:03:27.612238 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:03:27.614325 [debug] [Thread-1 (]: Timing info for model.sumup.product_agg (execute): 19:03:27.493578 => 19:03:27.614073
[0m19:03:27.614831 [debug] [Thread-1 (]: On model.sumup.product_agg: Close
[0m19:03:27.615816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c06661e6-52e2-4336-b6a0-655d4a79d6e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068bad50>]}
[0m19:03:27.617034 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dbt_merve.product_agg ......................... [[32mCREATE VIEW[0m in 0.14s]
[0m19:03:27.618068 [debug] [Thread-1 (]: Finished running node model.sumup.product_agg
[0m19:03:27.618676 [debug] [Thread-1 (]: Began running node model.sumup.store_transaction_view
[0m19:03:27.619766 [info ] [Thread-1 (]: 2 of 8 START sql view model dbt_merve.store_transaction_view ................... [RUN]
[0m19:03:27.621215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.product_agg, now model.sumup.store_transaction_view)
[0m19:03:27.621719 [debug] [Thread-1 (]: Began compiling node model.sumup.store_transaction_view
[0m19:03:27.625637 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.store_transaction_view"
[0m19:03:27.626931 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_view (compile): 19:03:27.622030 => 19:03:27.626544
[0m19:03:27.627451 [debug] [Thread-1 (]: Began executing node model.sumup.store_transaction_view
[0m19:03:27.640096 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.store_transaction_view"
[0m19:03:27.641182 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m19:03:27.641692 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: BEGIN
[0m19:03:27.642147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:27.652316 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:03:27.653669 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m19:03:27.654310 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */

  create view "merveyasa"."dbt_merve"."store_transaction_view__dbt_tmp"
    
    
  as (
    

WITH store_transactions AS
(
SELECT
    s.store_id,
    s.store_typology,
    s.store_country,
    LOWER(REGEXP_REPLACE(t.product_name, '[^a-zA-Z\s]+', '', 'g')) as product_name,
    (CASE 
        WHEN product_sku ~ E'^\\d+\\.\\d+E\\+\\d+$' 
        THEN LTRIM(TO_CHAR(CAST(product_sku AS DOUBLE PRECISION), '9999999999999999999999999'))
        ELSE product_sku
    END) as product_sku,
    LOWER(REGEXP_REPLACE(t.category_name, '[^a-zA-Z\s]+', '', 'g')) as category_name,
    t.transaction_amount,
    t.transaction_status,
    t.transaction_happened_at,
    d.device_type
FROM
    transactions t
JOIN devices d ON t.device_id = d.device_id
JOIN stores s ON d.store_id = s.store_id
)

select * from store_transactions
  );
[0m19:03:27.660085 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:03:27.664215 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m19:03:27.665048 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */
alter table "merveyasa"."dbt_merve"."store_transaction_view" rename to "store_transaction_view__dbt_backup"
[0m19:03:27.666519 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:03:27.670699 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m19:03:27.671265 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */
alter table "merveyasa"."dbt_merve"."store_transaction_view__dbt_tmp" rename to "store_transaction_view"
[0m19:03:27.672392 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:03:27.675070 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: COMMIT
[0m19:03:27.675625 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m19:03:27.676436 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: COMMIT
[0m19:03:27.677701 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:03:27.681209 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_view"
[0m19:03:27.681763 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_view"} */
drop view if exists "merveyasa"."dbt_merve"."store_transaction_view__dbt_backup" cascade
[0m19:03:27.683824 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:03:27.685891 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_view (execute): 19:03:27.627997 => 19:03:27.685627
[0m19:03:27.686387 [debug] [Thread-1 (]: On model.sumup.store_transaction_view: Close
[0m19:03:27.687478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c06661e6-52e2-4336-b6a0-655d4a79d6e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070cbc90>]}
[0m19:03:27.688419 [info ] [Thread-1 (]: 2 of 8 OK created sql view model dbt_merve.store_transaction_view .............. [[32mCREATE VIEW[0m in 0.07s]
[0m19:03:27.689356 [debug] [Thread-1 (]: Finished running node model.sumup.store_transaction_view
[0m19:03:27.689936 [debug] [Thread-1 (]: Began running node model.sumup.top_ten_products
[0m19:03:27.690951 [info ] [Thread-1 (]: 3 of 8 START sql view model dbt_merve.top_ten_products ......................... [RUN]
[0m19:03:27.692014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.store_transaction_view, now model.sumup.top_ten_products)
[0m19:03:27.692523 [debug] [Thread-1 (]: Began compiling node model.sumup.top_ten_products
[0m19:03:27.696931 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.top_ten_products"
[0m19:03:27.699179 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_products (compile): 19:03:27.693233 => 19:03:27.698681
[0m19:03:27.699873 [debug] [Thread-1 (]: Began executing node model.sumup.top_ten_products
[0m19:03:27.708248 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.top_ten_products"
[0m19:03:27.710036 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m19:03:27.711331 [debug] [Thread-1 (]: On model.sumup.top_ten_products: BEGIN
[0m19:03:27.712173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:27.720115 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:03:27.721396 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m19:03:27.722046 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */

  create view "merveyasa"."dbt_merve"."top_ten_products__dbt_tmp"
    
    
  as (
    

WITH top_ten_products AS (
    SELECT
        product_name,
        product_sku,
        transactions_count,
        total_transaction_amount
    FROM "merveyasa"."dbt_merve"."product_agg"
    ORDER BY
        transactions_count DESC
    LIMIT 10
)

SELECT * FROM top_ten_products
  );
[0m19:03:27.726678 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:03:27.732499 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m19:03:27.733097 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */
alter table "merveyasa"."dbt_merve"."top_ten_products__dbt_tmp" rename to "top_ten_products"
[0m19:03:27.734330 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:03:27.737110 [debug] [Thread-1 (]: On model.sumup.top_ten_products: COMMIT
[0m19:03:27.737727 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m19:03:27.738218 [debug] [Thread-1 (]: On model.sumup.top_ten_products: COMMIT
[0m19:03:27.739648 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:03:27.743530 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m19:03:27.744116 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */
drop view if exists "merveyasa"."dbt_merve"."top_ten_products__dbt_backup" cascade
[0m19:03:27.744916 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:03:27.746796 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_products (execute): 19:03:27.700204 => 19:03:27.746530
[0m19:03:27.747295 [debug] [Thread-1 (]: On model.sumup.top_ten_products: Close
[0m19:03:27.748305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c06661e6-52e2-4336-b6a0-655d4a79d6e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b9950>]}
[0m19:03:27.749234 [info ] [Thread-1 (]: 3 of 8 OK created sql view model dbt_merve.top_ten_products .................... [[32mCREATE VIEW[0m in 0.06s]
[0m19:03:27.750208 [debug] [Thread-1 (]: Finished running node model.sumup.top_ten_products
[0m19:03:27.750980 [debug] [Thread-1 (]: Began running node model.sumup.avg_transaction_amount
[0m19:03:27.752005 [info ] [Thread-1 (]: 4 of 8 START sql incremental model dbt_merve.avg_transaction_amount ............ [RUN]
[0m19:03:27.753087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.top_ten_products, now model.sumup.avg_transaction_amount)
[0m19:03:27.753749 [debug] [Thread-1 (]: Began compiling node model.sumup.avg_transaction_amount
[0m19:03:27.771268 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.avg_transaction_amount"
[0m19:03:27.774762 [debug] [Thread-1 (]: Timing info for model.sumup.avg_transaction_amount (compile): 19:03:27.754109 => 19:03:27.774178
[0m19:03:27.775446 [debug] [Thread-1 (]: Began executing node model.sumup.avg_transaction_amount
[0m19:03:27.858477 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.avg_transaction_amount"
[0m19:03:27.859880 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m19:03:27.860571 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: BEGIN
[0m19:03:27.861163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:27.871326 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:03:27.872302 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m19:03:27.873162 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.avg_transaction_amount"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."avg_transaction_amount__dbt_tmp"
  
  
    as
  
  (
    


    SELECT store_typology, store_country, AVG(transaction_amount) AS average_transaction_amount
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
    GROUP BY store_typology, store_country

  );
  
  
[0m19:03:27.886203 [debug] [Thread-1 (]: SQL status: SELECT 74 in 0.0 seconds
[0m19:03:27.891056 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m19:03:27.892036 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.avg_transaction_amount"} */
alter table "merveyasa"."dbt_merve"."avg_transaction_amount" rename to "avg_transaction_amount__dbt_backup"
[0m19:03:27.896063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:03:27.904214 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m19:03:27.905126 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.avg_transaction_amount"} */
alter table "merveyasa"."dbt_merve"."avg_transaction_amount__dbt_tmp" rename to "avg_transaction_amount"
[0m19:03:27.906970 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:03:27.935226 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: COMMIT
[0m19:03:27.935926 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m19:03:27.936497 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: COMMIT
[0m19:03:27.938958 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:03:27.952640 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m19:03:27.953537 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.avg_transaction_amount"} */
drop table if exists "merveyasa"."dbt_merve"."avg_transaction_amount__dbt_backup" cascade
[0m19:03:27.961750 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:03:27.964735 [debug] [Thread-1 (]: Timing info for model.sumup.avg_transaction_amount (execute): 19:03:27.776073 => 19:03:27.964334
[0m19:03:27.965484 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: Close
[0m19:03:27.966872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c06661e6-52e2-4336-b6a0-655d4a79d6e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ffa490>]}
[0m19:03:27.968029 [info ] [Thread-1 (]: 4 of 8 OK created sql incremental model dbt_merve.avg_transaction_amount ....... [[32mSELECT 74[0m in 0.21s]
[0m19:03:27.969411 [debug] [Thread-1 (]: Finished running node model.sumup.avg_transaction_amount
[0m19:03:27.970364 [debug] [Thread-1 (]: Began running node model.sumup.pct_transaction
[0m19:03:27.971742 [info ] [Thread-1 (]: 5 of 8 START sql view model dbt_merve.pct_transaction .......................... [RUN]
[0m19:03:27.974442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.avg_transaction_amount, now model.sumup.pct_transaction)
[0m19:03:27.975780 [debug] [Thread-1 (]: Began compiling node model.sumup.pct_transaction
[0m19:03:27.983321 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.pct_transaction"
[0m19:03:27.986236 [debug] [Thread-1 (]: Timing info for model.sumup.pct_transaction (compile): 19:03:27.976340 => 19:03:27.985515
[0m19:03:27.987015 [debug] [Thread-1 (]: Began executing node model.sumup.pct_transaction
[0m19:03:28.000655 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.pct_transaction"
[0m19:03:28.002510 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m19:03:28.005845 [debug] [Thread-1 (]: On model.sumup.pct_transaction: BEGIN
[0m19:03:28.006572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:28.017346 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:03:28.018089 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m19:03:28.020050 [debug] [Thread-1 (]: On model.sumup.pct_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.pct_transaction"} */

  create view "merveyasa"."dbt_merve"."pct_transaction__dbt_tmp"
    
    
  as (
    

WITH pct_transaction AS (
    SELECT device_type, COUNT(*) * 100.0 / SUM(COUNT(*)) OVER () AS percentage
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
    GROUP BY device_type
)
SELECT * FROM pct_transaction
ORDER BY device_type
  );
[0m19:03:28.025925 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:03:28.031627 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m19:03:28.032351 [debug] [Thread-1 (]: On model.sumup.pct_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.pct_transaction"} */
alter table "merveyasa"."dbt_merve"."pct_transaction__dbt_tmp" rename to "pct_transaction"
[0m19:03:28.033762 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:03:28.037405 [debug] [Thread-1 (]: On model.sumup.pct_transaction: COMMIT
[0m19:03:28.038104 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m19:03:28.038688 [debug] [Thread-1 (]: On model.sumup.pct_transaction: COMMIT
[0m19:03:28.040125 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:03:28.048353 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m19:03:28.055793 [debug] [Thread-1 (]: On model.sumup.pct_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.pct_transaction"} */
drop view if exists "merveyasa"."dbt_merve"."pct_transaction__dbt_backup" cascade
[0m19:03:28.057012 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:03:28.060354 [debug] [Thread-1 (]: Timing info for model.sumup.pct_transaction (execute): 19:03:27.987495 => 19:03:28.059990
[0m19:03:28.061297 [debug] [Thread-1 (]: On model.sumup.pct_transaction: Close
[0m19:03:28.062711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c06661e6-52e2-4336-b6a0-655d4a79d6e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a36d0>]}
[0m19:03:28.063952 [info ] [Thread-1 (]: 5 of 8 OK created sql view model dbt_merve.pct_transaction ..................... [[32mCREATE VIEW[0m in 0.09s]
[0m19:03:28.065284 [debug] [Thread-1 (]: Finished running node model.sumup.pct_transaction
[0m19:03:28.066134 [debug] [Thread-1 (]: Began running node model.sumup.store_transaction_first
[0m19:03:28.067680 [info ] [Thread-1 (]: 6 of 8 START sql view model dbt_merve.store_transaction_first .................. [RUN]
[0m19:03:28.068975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.pct_transaction, now model.sumup.store_transaction_first)
[0m19:03:28.069633 [debug] [Thread-1 (]: Began compiling node model.sumup.store_transaction_first
[0m19:03:28.113760 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.store_transaction_first"
[0m19:03:28.115505 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_first (compile): 19:03:28.099531 => 19:03:28.115090
[0m19:03:28.116232 [debug] [Thread-1 (]: Began executing node model.sumup.store_transaction_first
[0m19:03:28.124284 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.store_transaction_first"
[0m19:03:28.126201 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m19:03:28.127478 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: BEGIN
[0m19:03:28.128153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:28.137042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:03:28.137906 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m19:03:28.138910 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_first"} */

  create view "merveyasa"."dbt_merve"."store_transaction_first__dbt_tmp"
    
    
  as (
    

WITH numbered_transactions AS (
    SELECT
        store_id,
        transaction_happened_at,
        ROW_NUMBER() OVER (PARTITION BY store_id ORDER BY transaction_happened_at) AS rownumber
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
)
SELECT
    store_id,
    transaction_happened_at
FROM numbered_transactions
WHERE rownumber <= 5
  );
[0m19:03:28.144463 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:03:28.153042 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m19:03:28.154234 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_first"} */
alter table "merveyasa"."dbt_merve"."store_transaction_first__dbt_tmp" rename to "store_transaction_first"
[0m19:03:28.156284 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:03:28.159852 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: COMMIT
[0m19:03:28.160658 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m19:03:28.161419 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: COMMIT
[0m19:03:28.163472 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:03:28.174549 [debug] [Thread-1 (]: Using postgres connection "model.sumup.store_transaction_first"
[0m19:03:28.175441 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.store_transaction_first"} */
drop view if exists "merveyasa"."dbt_merve"."store_transaction_first__dbt_backup" cascade
[0m19:03:28.176736 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:03:28.180315 [debug] [Thread-1 (]: Timing info for model.sumup.store_transaction_first (execute): 19:03:28.116699 => 19:03:28.179891
[0m19:03:28.181463 [debug] [Thread-1 (]: On model.sumup.store_transaction_first: Close
[0m19:03:28.184587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c06661e6-52e2-4336-b6a0-655d4a79d6e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106edaed0>]}
[0m19:03:28.186165 [info ] [Thread-1 (]: 6 of 8 OK created sql view model dbt_merve.store_transaction_first ............. [[32mCREATE VIEW[0m in 0.12s]
[0m19:03:28.188115 [debug] [Thread-1 (]: Finished running node model.sumup.store_transaction_first
[0m19:03:28.189398 [debug] [Thread-1 (]: Began running node model.sumup.top_ten_stores
[0m19:03:28.203760 [info ] [Thread-1 (]: 7 of 8 START sql view model dbt_merve.top_ten_stores ........................... [RUN]
[0m19:03:28.205984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.store_transaction_first, now model.sumup.top_ten_stores)
[0m19:03:28.206861 [debug] [Thread-1 (]: Began compiling node model.sumup.top_ten_stores
[0m19:03:28.246456 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.top_ten_stores"
[0m19:03:28.253363 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_stores (compile): 19:03:28.207383 => 19:03:28.252370
[0m19:03:28.254569 [debug] [Thread-1 (]: Began executing node model.sumup.top_ten_stores
[0m19:03:28.284790 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.top_ten_stores"
[0m19:03:28.286532 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m19:03:28.288777 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: BEGIN
[0m19:03:28.289819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:28.309555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:03:28.310116 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m19:03:28.310599 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */

  create view "merveyasa"."dbt_merve"."top_ten_stores__dbt_tmp"
    
    
  as (
    

WITH top_ten_stores AS (
    SELECT store_id, SUM(transaction_amount) AS total_transaction_amount
    FROM "merveyasa"."dbt_merve"."store_transaction_view"
    GROUP BY store_id
    ORDER BY total_transaction_amount DESC
    LIMIT 10
)
SELECT * FROM top_ten_stores
  );
[0m19:03:28.316257 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:03:28.326570 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m19:03:28.327633 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */
alter table "merveyasa"."dbt_merve"."top_ten_stores__dbt_tmp" rename to "top_ten_stores"
[0m19:03:28.329005 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:03:28.333124 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: COMMIT
[0m19:03:28.334105 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m19:03:28.334814 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: COMMIT
[0m19:03:28.336087 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:03:28.344174 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m19:03:28.344990 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */
drop view if exists "merveyasa"."dbt_merve"."top_ten_stores__dbt_backup" cascade
[0m19:03:28.346062 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:03:28.349398 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_stores (execute): 19:03:28.255970 => 19:03:28.348736
[0m19:03:28.350229 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: Close
[0m19:03:28.352200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c06661e6-52e2-4336-b6a0-655d4a79d6e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10716c550>]}
[0m19:03:28.353347 [info ] [Thread-1 (]: 7 of 8 OK created sql view model dbt_merve.top_ten_stores ...................... [[32mCREATE VIEW[0m in 0.15s]
[0m19:03:28.354747 [debug] [Thread-1 (]: Finished running node model.sumup.top_ten_stores
[0m19:03:28.355699 [debug] [Thread-1 (]: Began running node model.sumup.inc_first_five_transaction
[0m19:03:28.358619 [info ] [Thread-1 (]: 8 of 8 START sql incremental model dbt_merve.inc_first_five_transaction ........ [RUN]
[0m19:03:28.361710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.top_ten_stores, now model.sumup.inc_first_five_transaction)
[0m19:03:28.362531 [debug] [Thread-1 (]: Began compiling node model.sumup.inc_first_five_transaction
[0m19:03:28.371379 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.inc_first_five_transaction"
[0m19:03:28.373740 [debug] [Thread-1 (]: Timing info for model.sumup.inc_first_five_transaction (compile): 19:03:28.363066 => 19:03:28.373195
[0m19:03:28.374711 [debug] [Thread-1 (]: Began executing node model.sumup.inc_first_five_transaction
[0m19:03:28.389357 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.inc_first_five_transaction"
[0m19:03:28.395978 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m19:03:28.398301 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: BEGIN
[0m19:03:28.399107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:28.411020 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:03:28.412191 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m19:03:28.413003 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.inc_first_five_transaction"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."inc_first_five_transaction__dbt_tmp"
  
  
    as
  
  (
    


SELECT
    store_id,
    AVG(time_diff) AS avg_time_diff
FROM (
    SELECT
        store_id,
        transaction_happened_at - LAG(transaction_happened_at, 1) OVER (PARTITION BY store_id ORDER BY transaction_happened_at) AS time_diff
    FROM "merveyasa"."dbt_merve"."store_transaction_first"
) subquery
GROUP BY store_id

  );
  
  
[0m19:03:28.424295 [debug] [Thread-1 (]: SQL status: SELECT 87 in 0.0 seconds
[0m19:03:28.430909 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m19:03:28.431546 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.inc_first_five_transaction"} */
alter table "merveyasa"."dbt_merve"."inc_first_five_transaction" rename to "inc_first_five_transaction__dbt_backup"
[0m19:03:28.432911 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:03:28.438999 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m19:03:28.439864 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.inc_first_five_transaction"} */
alter table "merveyasa"."dbt_merve"."inc_first_five_transaction__dbt_tmp" rename to "inc_first_five_transaction"
[0m19:03:28.441652 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:03:28.447172 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: COMMIT
[0m19:03:28.448118 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m19:03:28.449261 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: COMMIT
[0m19:03:28.450568 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:03:28.456291 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m19:03:28.457125 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.inc_first_five_transaction"} */
drop table if exists "merveyasa"."dbt_merve"."inc_first_five_transaction__dbt_backup" cascade
[0m19:03:28.460381 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:03:28.463244 [debug] [Thread-1 (]: Timing info for model.sumup.inc_first_five_transaction (execute): 19:03:28.375251 => 19:03:28.462843
[0m19:03:28.464035 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: Close
[0m19:03:28.465814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c06661e6-52e2-4336-b6a0-655d4a79d6e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b8650>]}
[0m19:03:28.467507 [info ] [Thread-1 (]: 8 of 8 OK created sql incremental model dbt_merve.inc_first_five_transaction ... [[32mSELECT 87[0m in 0.10s]
[0m19:03:28.469062 [debug] [Thread-1 (]: Finished running node model.sumup.inc_first_five_transaction
[0m19:03:28.473342 [debug] [MainThread]: Using postgres connection "master"
[0m19:03:28.474414 [debug] [MainThread]: On master: BEGIN
[0m19:03:28.475119 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:03:28.484386 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:03:28.484970 [debug] [MainThread]: On master: COMMIT
[0m19:03:28.486039 [debug] [MainThread]: Using postgres connection "master"
[0m19:03:28.486995 [debug] [MainThread]: On master: COMMIT
[0m19:03:28.488105 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:03:28.488815 [debug] [MainThread]: On master: Close
[0m19:03:28.490440 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:03:28.491138 [debug] [MainThread]: Connection 'model.sumup.inc_first_five_transaction' was properly closed.
[0m19:03:28.491676 [info ] [MainThread]: 
[0m19:03:28.492441 [info ] [MainThread]: Finished running 6 view models, 2 incremental models in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m19:03:28.495042 [debug] [MainThread]: Command end result
[0m19:03:28.515174 [info ] [MainThread]: 
[0m19:03:28.516343 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:03:28.517366 [info ] [MainThread]: 
[0m19:03:28.518216 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m19:03:28.519633 [debug] [MainThread]: Command `dbt run` succeeded at 19:03:28.519383 after 1.71 seconds
[0m19:03:28.521220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101e7fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f8c1d0>]}
[0m19:03:28.522164 [debug] [MainThread]: Flushing usage events
[0m12:54:36.837279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b79c150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6a4210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6be210>]}


============================== 12:54:36.852925 | b8c48c9a-bf06-4cbb-b089-e5a11f71ad55 ==============================
[0m12:54:36.852925 [info ] [MainThread]: Running with dbt=1.6.0
[0m12:54:36.853998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:54:37.038510 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ var('database_name') }}: Required var 'database_name' not found in config:
  Vars supplied to <Configuration> = {}
[0m12:54:37.039539 [debug] [MainThread]: Command `dbt run` failed at 12:54:37.039348 after 0.26 seconds
[0m12:54:37.039967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6a52d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9a5390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b730550>]}
[0m12:54:37.040428 [debug] [MainThread]: Flushing usage events
[0m12:56:26.326118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138d6b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138cde90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113966650>]}


============================== 12:56:26.334085 | 61458f47-6085-4687-9422-40981a7789d0 ==============================
[0m12:56:26.334085 [info ] [MainThread]: Running with dbt=1.6.0
[0m12:56:26.335039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:56:26.520722 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ var('database_name') }}: Required var 'database_name' not found in config:
  Vars supplied to <Configuration> = {}
[0m12:56:26.521668 [debug] [MainThread]: Command `dbt run` failed at 12:56:26.521490 after 0.24 seconds
[0m12:56:26.522139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138b8e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e74650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138d44d0>]}
[0m12:56:26.522607 [debug] [MainThread]: Flushing usage events
[0m12:56:42.297988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b29d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b8b390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069724d0>]}


============================== 12:56:42.305571 | 59b2aae3-8ec0-4e04-84fd-bcefd6138ca2 ==============================
[0m12:56:42.305571 [info ] [MainThread]: Running with dbt=1.6.0
[0m12:56:42.306598 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:56:42.387501 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ var('database_name') }}: Required var 'database_name' not found in config:
  Vars supplied to <Configuration> = {}
[0m12:56:42.388481 [debug] [MainThread]: Command `dbt run` failed at 12:56:42.388295 after 0.12 seconds
[0m12:56:42.388966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b83510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065aced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101ec4810>]}
[0m12:56:42.389524 [debug] [MainThread]: Flushing usage events
[0m13:07:11.916704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e14f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e40d450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e712c90>]}


============================== 13:07:11.924708 | 36d81cf8-19cd-4a76-b3a1-34460a9c274e ==============================
[0m13:07:11.924708 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:07:11.925744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'debug': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:07:12.093628 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['sources']: [{'name': 'raw_data', 'database': 'merveyasa', 'tables': [{'name': 'raw_stores', 'identifier': 'stores'}, {'name': 'raw_devices', 'identifier': 'devices'}, {'name': 'raw_transactions', 'identifier': 'transactions'}]}] is not of type 'object'

Error encountered in /Users/merveyasa/Desktop/Folder for sumup/dbt_project.yml
[0m13:07:12.094583 [debug] [MainThread]: Command `dbt run` failed at 13:07:12.094396 after 0.22 seconds
[0m13:07:12.095038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e426010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0a9990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de2f590>]}
[0m13:07:12.095492 [debug] [MainThread]: Flushing usage events
[0m13:09:51.402211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10794f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c36d0>]}


============================== 13:09:51.412513 | 99227311-1a15-479b-93f2-43fd1f99c12a ==============================
[0m13:09:51.412513 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:09:51.413763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:09:51.595966 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['sources']: [{'name': 'raw_data', 'database': 'merveyasa', 'tables': [{'name': 'raw_stores', 'identifier': 'stores'}, {'name': 'raw_devices', 'identifier': 'devices'}, {'name': 'raw_transactions', 'identifier': 'transactions'}]}] is not of type 'object'

Error encountered in /Users/merveyasa/Desktop/Folder for sumup/dbt_project.yml
[0m13:09:51.596933 [debug] [MainThread]: Command `dbt run` failed at 13:09:51.596744 after 0.22 seconds
[0m13:09:51.597366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c1ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107effd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c3610>]}
[0m13:09:51.597844 [debug] [MainThread]: Flushing usage events
[0m13:10:40.945388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a611d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a446d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d60b10>]}


============================== 13:10:40.960312 | 24dda9a3-21fa-4014-a7f4-a8cc472cf0dc ==============================
[0m13:10:40.960312 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:10:40.961266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:10:41.116922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24dda9a3-21fa-4014-a7f4-a8cc472cf0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a450d0>]}
[0m13:10:41.127707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24dda9a3-21fa-4014-a7f4-a8cc472cf0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d7d850>]}
[0m13:10:41.129642 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m13:10:41.173889 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m13:10:41.196299 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:10:41.197259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '24dda9a3-21fa-4014-a7f4-a8cc472cf0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10686a4d0>]}
[0m13:10:42.017883 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'avg_transaction_amount' in the 'models' section of file 'models/schema.yml'
[0m13:10:42.019883 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'inc_first_five_transaction' in the 'models' section of file 'models/schema.yml'
[0m13:10:42.021882 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'pct_transaction' in the 'models' section of file 'models/schema.yml'
[0m13:10:42.023536 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'store_transaction_first' in the 'models' section of file 'models/schema.yml'
[0m13:10:42.026095 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'store_transaction_view' in the 'models' section of file 'models/schema.yml'
[0m13:10:42.136301 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.sumup.fact_product_agg' (models/fact_product_agg.sql) depends on a source named 'raw_data.transactions' which was not found
[0m13:10:42.137248 [debug] [MainThread]: Command `dbt run` failed at 13:10:42.137076 after 1.22 seconds
[0m13:10:42.137766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b6710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107174990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a4f9d0>]}
[0m13:10:42.138370 [debug] [MainThread]: Flushing usage events
[0m13:14:37.828887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ce4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105262650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052322d0>]}


============================== 13:14:37.836604 | 4a78fbfe-cc76-498c-9124-13992430791d ==============================
[0m13:14:37.836604 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:14:37.837571 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:14:38.018374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a78fbfe-cc76-498c-9124-13992430791d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105565010>]}
[0m13:14:38.027647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a78fbfe-cc76-498c-9124-13992430791d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105801090>]}
[0m13:14:38.029452 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m13:14:38.062513 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m13:14:38.095078 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:14:38.095883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4a78fbfe-cc76-498c-9124-13992430791d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055660d0>]}
[0m13:14:39.017260 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.sumup.fact_product_agg' (models/fact_product_agg.sql) depends on a source named 'raw_data.transactions' which was not found
[0m13:14:39.018228 [debug] [MainThread]: Command `dbt run` failed at 13:14:39.018013 after 1.23 seconds
[0m13:14:39.018717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057e1b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052505d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105504110>]}
[0m13:14:39.019170 [debug] [MainThread]: Flushing usage events
[0m13:16:04.595503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cab7cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca88fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cab4950>]}


============================== 13:16:04.603072 | c3aeb452-7c5b-4992-aff0-de6528f77606 ==============================
[0m13:16:04.603072 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:16:04.603827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m13:16:04.717840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3aeb452-7c5b-4992-aff0-de6528f77606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d311a90>]}
[0m13:16:04.727595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3aeb452-7c5b-4992-aff0-de6528f77606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0553d0>]}
[0m13:16:04.728732 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m13:16:04.755160 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m13:16:04.775294 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:16:04.776288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c3aeb452-7c5b-4992-aff0-de6528f77606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d437490>]}
[0m13:16:05.635224 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.sumup.fact_product_agg' (models/fact_product_agg.sql) depends on a source named 'raw_data.raw_transactions' which was not found
[0m13:16:05.636290 [debug] [MainThread]: Command `dbt run` failed at 13:16:05.636124 after 1.07 seconds
[0m13:16:05.636773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce1af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb26010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d04b610>]}
[0m13:16:05.637210 [debug] [MainThread]: Flushing usage events
[0m13:24:06.772198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10809bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be82d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b32110>]}


============================== 13:24:06.782232 | 0bdca085-9d6f-4c7e-a7ce-0980ac6967a5 ==============================
[0m13:24:06.782232 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:24:06.783540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:24:06.793047 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:24:06.793706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0bdca085-9d6f-4c7e-a7ce-0980ac6967a5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108209950>]}
[0m13:24:06.847510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bdca085-9d6f-4c7e-a7ce-0980ac6967a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e2510>]}
[0m13:24:06.871712 [debug] [MainThread]: Command `dbt clean` succeeded at 13:24:06.871526 after 0.14 seconds
[0m13:24:06.872933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e8fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107efbe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103434790>]}
[0m13:24:06.873874 [debug] [MainThread]: Flushing usage events
[0m13:24:21.460421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cbb710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f9fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f34e10>]}


============================== 13:24:21.467046 | a75eaecf-a3da-4b3e-b9db-78cb40ed819e ==============================
[0m13:24:21.467046 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:24:21.468294 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:24:21.479458 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:24:21.480163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a75eaecf-a3da-4b3e-b9db-78cb40ed819e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ca34d0>]}
[0m13:24:21.527743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a75eaecf-a3da-4b3e-b9db-78cb40ed819e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f9e110>]}
[0m13:24:21.529417 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:24:21.530416 [debug] [MainThread]: Command `dbt deps` succeeded at 13:24:21.530185 after 0.09 seconds
[0m13:24:21.530941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111913ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e313ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e313b10>]}
[0m13:24:21.531442 [debug] [MainThread]: Flushing usage events
[0m13:24:37.396674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cd4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fdb650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c805d0>]}


============================== 13:24:37.402073 | ec159417-3e95-4b1a-91f6-7cb286563e06 ==============================
[0m13:24:37.402073 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:24:37.402874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:24:37.525211 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:24:37.525818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ec159417-3e95-4b1a-91f6-7cb286563e06', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109283a50>]}
[0m13:24:37.559253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec159417-3e95-4b1a-91f6-7cb286563e06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109261750>]}
[0m13:24:37.569587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec159417-3e95-4b1a-91f6-7cb286563e06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10952d390>]}
[0m13:24:37.571107 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m13:24:37.604404 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m13:24:37.605510 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:24:37.606050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ec159417-3e95-4b1a-91f6-7cb286563e06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f75290>]}
[0m13:24:38.382925 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.my_project.store_transaction_view
- models.my_project.top_ten_stores
- models.my_project.pct_transaction
- models.my_project.avg_transaction_amount
- models.my_project.top_ten_products
- models.my_project.inc_first_five_transaction
- models.my_project
- models.my_project.store_transaction_first
- sources.raw_data
[0m13:24:38.388753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec159417-3e95-4b1a-91f6-7cb286563e06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109665a10>]}
[0m13:24:38.409683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec159417-3e95-4b1a-91f6-7cb286563e06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096260d0>]}
[0m13:24:38.410513 [info ] [MainThread]: Found 3 models, 6 tests, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m13:24:38.411386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec159417-3e95-4b1a-91f6-7cb286563e06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10967f590>]}
[0m13:24:38.414864 [info ] [MainThread]: 
[0m13:24:38.416207 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:24:38.419598 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m13:24:38.445312 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m13:24:38.446285 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m13:24:38.446969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:38.510652 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m13:24:38.512802 [debug] [ThreadPool]: On list_merveyasa: Close
[0m13:24:38.515684 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m13:24:38.526685 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m13:24:38.527299 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m13:24:38.527784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:24:38.536464 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:24:38.536961 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m13:24:38.537390 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m13:24:38.543659 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m13:24:38.545008 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m13:24:38.545485 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m13:24:38.550278 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:38.550755 [debug] [MainThread]: On master: BEGIN
[0m13:24:38.551054 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:24:38.557210 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:24:38.557587 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:38.557988 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:24:38.567683 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:24:38.568862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec159417-3e95-4b1a-91f6-7cb286563e06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10960a790>]}
[0m13:24:38.569316 [debug] [MainThread]: On master: ROLLBACK
[0m13:24:38.569952 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:38.570352 [debug] [MainThread]: On master: BEGIN
[0m13:24:38.570963 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:24:38.571327 [debug] [MainThread]: On master: COMMIT
[0m13:24:38.571640 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:38.571935 [debug] [MainThread]: On master: COMMIT
[0m13:24:38.572467 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:24:38.572803 [debug] [MainThread]: On master: Close
[0m13:24:38.573616 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:24:38.574029 [info ] [MainThread]: 
[0m13:24:38.577250 [debug] [Thread-1 (]: Began running node model.sumup.raw_devices
[0m13:24:38.577847 [info ] [Thread-1 (]: 1 of 3 START sql incremental model dbt_merve.raw_devices ....................... [RUN]
[0m13:24:38.578975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.raw_devices)
[0m13:24:38.579454 [debug] [Thread-1 (]: Began compiling node model.sumup.raw_devices
[0m13:24:38.589502 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.raw_devices"
[0m13:24:38.591749 [debug] [Thread-1 (]: Timing info for model.sumup.raw_devices (compile): 13:24:38.579771 => 13:24:38.591310
[0m13:24:38.592329 [debug] [Thread-1 (]: Began executing node model.sumup.raw_devices
[0m13:24:38.659112 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.raw_devices"
[0m13:24:38.660261 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_devices"
[0m13:24:38.660660 [debug] [Thread-1 (]: On model.sumup.raw_devices: BEGIN
[0m13:24:38.661024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:38.667029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:24:38.667484 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_devices"
[0m13:24:38.667880 [debug] [Thread-1 (]: On model.sumup.raw_devices: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.raw_devices"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."raw_devices"
  
  
    as
  
  (
    

SELECT 
    metadata_timestamp,
    device_id, 
    device_type, 
    store_id
FROM public.devices
WHERE metadata_timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa"."dbt_merve"."raw_devices")
  );
  
  
[0m13:24:38.669840 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbt_merve.raw_devices" does not exist
LINE 21: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
                                                              ^

[0m13:24:38.670413 [debug] [Thread-1 (]: On model.sumup.raw_devices: ROLLBACK
[0m13:24:38.671271 [debug] [Thread-1 (]: Timing info for model.sumup.raw_devices (execute): 13:24:38.592657 => 13:24:38.671011
[0m13:24:38.671704 [debug] [Thread-1 (]: On model.sumup.raw_devices: Close
[0m13:24:38.690475 [debug] [Thread-1 (]: Database Error in model raw_devices (sources/raw_devices.sql)
  relation "dbt_merve.raw_devices" does not exist
  LINE 21: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
                                                                ^
  compiled Code at target/run/sumup/sources/raw_devices.sql
[0m13:24:38.691103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec159417-3e95-4b1a-91f6-7cb286563e06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096d6e90>]}
[0m13:24:38.691734 [error] [Thread-1 (]: 1 of 3 ERROR creating sql incremental model dbt_merve.raw_devices .............. [[31mERROR[0m in 0.11s]
[0m13:24:38.692445 [debug] [Thread-1 (]: Finished running node model.sumup.raw_devices
[0m13:24:38.692907 [debug] [Thread-1 (]: Began running node model.sumup.raw_stores
[0m13:24:38.693777 [info ] [Thread-1 (]: 2 of 3 START sql incremental model dbt_merve.raw_stores ........................ [RUN]
[0m13:24:38.694681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.raw_devices, now model.sumup.raw_stores)
[0m13:24:38.695172 [debug] [Thread-1 (]: Began compiling node model.sumup.raw_stores
[0m13:24:38.698298 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.raw_stores"
[0m13:24:38.699282 [debug] [Thread-1 (]: Timing info for model.sumup.raw_stores (compile): 13:24:38.695462 => 13:24:38.698956
[0m13:24:38.699734 [debug] [Thread-1 (]: Began executing node model.sumup.raw_stores
[0m13:24:38.706086 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.raw_stores"
[0m13:24:38.707324 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_stores"
[0m13:24:38.708077 [debug] [Thread-1 (]: On model.sumup.raw_stores: BEGIN
[0m13:24:38.708618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:38.716249 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:24:38.716756 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_stores"
[0m13:24:38.717312 [debug] [Thread-1 (]: On model.sumup.raw_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.raw_stores"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."raw_stores"
  
  
    as
  
  (
    

SELECT 
    metadata_timestamp,
    store_id, 
    store_name, 
    store_address, 
    REGEXP_REPLACE(store_city, '[^a-zA-Z\s]', '', 'g') as store_city, 
    store_country, 
    store_created_at, 
    store_typology, 
    customer_id
	FROM public.stores
WHERE metadata_timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa"."dbt_merve"."raw_stores")
  );
  
  
[0m13:24:38.719282 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbt_merve.raw_stores" does not exist
LINE 26: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
                                                              ^

[0m13:24:38.720137 [debug] [Thread-1 (]: On model.sumup.raw_stores: ROLLBACK
[0m13:24:38.721456 [debug] [Thread-1 (]: Timing info for model.sumup.raw_stores (execute): 13:24:38.700149 => 13:24:38.721081
[0m13:24:38.721931 [debug] [Thread-1 (]: On model.sumup.raw_stores: Close
[0m13:24:38.725353 [debug] [Thread-1 (]: Database Error in model raw_stores (sources/raw_stores.sql)
  relation "dbt_merve.raw_stores" does not exist
  LINE 26: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
                                                                ^
  compiled Code at target/run/sumup/sources/raw_stores.sql
[0m13:24:38.725912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec159417-3e95-4b1a-91f6-7cb286563e06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c6ec10>]}
[0m13:24:38.726724 [error] [Thread-1 (]: 2 of 3 ERROR creating sql incremental model dbt_merve.raw_stores ............... [[31mERROR[0m in 0.03s]
[0m13:24:38.727600 [debug] [Thread-1 (]: Finished running node model.sumup.raw_stores
[0m13:24:38.728683 [debug] [Thread-1 (]: Began running node model.sumup.raw_transactions
[0m13:24:38.729747 [info ] [Thread-1 (]: 3 of 3 START sql incremental model dbt_merve.raw_transactions .................. [RUN]
[0m13:24:38.730880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.raw_stores, now model.sumup.raw_transactions)
[0m13:24:38.731409 [debug] [Thread-1 (]: Began compiling node model.sumup.raw_transactions
[0m13:24:38.735725 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.raw_transactions"
[0m13:24:38.737161 [debug] [Thread-1 (]: Timing info for model.sumup.raw_transactions (compile): 13:24:38.731795 => 13:24:38.736668
[0m13:24:38.737697 [debug] [Thread-1 (]: Began executing node model.sumup.raw_transactions
[0m13:24:38.827892 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.raw_transactions"
[0m13:24:38.829482 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_transactions"
[0m13:24:38.830415 [debug] [Thread-1 (]: On model.sumup.raw_transactions: BEGIN
[0m13:24:38.831188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:38.840988 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:24:38.841933 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_transactions"
[0m13:24:38.842968 [debug] [Thread-1 (]: On model.sumup.raw_transactions: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.raw_transactions"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."raw_transactions"
  
  
    as
  
  (
    

SELECT 
    metadata_timestamp,
    transaction_id, 
    device_id, 
    LOWER(REGEXP_REPLACE(product_name, '[^a-zA-Z\s]+', '', 'g')) as product_name, 
    (CASE 
            WHEN product_sku ~ E'^\\d+\\.\\d+E\\+\\d+$' 
            THEN LTRIM(TO_CHAR(CAST(product_sku AS DOUBLE PRECISION), '9999999999999999999999999'))
            ELSE product_sku
        END) as product_sku, 
    LOWER(REGEXP_REPLACE(category_name, '[^a-zA-Z\s]+', '', 'g')) as category_name, 
    transaction_amount, 
    transaction_status, 
    CASE 
        WHEN card_number ~ E'^\\d+\\.\\d+E\\+\\d+$' THEN 
            LTRIM(TO_CHAR(CAST(card_number AS DOUBLE PRECISION), '9999999999999999999'))
        ELSE 
            REPLACE(card_number, ' ', '') 
    END as card_number, 
    cvv, 
    transaction_created_at, 
    transaction_happened_at
	FROM public.transactions
WHERE metadata_timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa"."dbt_merve"."raw_transactions")
  );
  
  
[0m13:24:38.846319 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbt_merve.raw_transactions" does not exist
LINE 38: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
                                                              ^

[0m13:24:38.846889 [debug] [Thread-1 (]: On model.sumup.raw_transactions: ROLLBACK
[0m13:24:38.848035 [debug] [Thread-1 (]: Timing info for model.sumup.raw_transactions (execute): 13:24:38.738037 => 13:24:38.847579
[0m13:24:38.848811 [debug] [Thread-1 (]: On model.sumup.raw_transactions: Close
[0m13:24:38.854749 [debug] [Thread-1 (]: Database Error in model raw_transactions (sources/raw_transactions.sql)
  relation "dbt_merve.raw_transactions" does not exist
  LINE 38: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
                                                                ^
  compiled Code at target/run/sumup/sources/raw_transactions.sql
[0m13:24:38.855708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec159417-3e95-4b1a-91f6-7cb286563e06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cdf2d0>]}
[0m13:24:38.856844 [error] [Thread-1 (]: 3 of 3 ERROR creating sql incremental model dbt_merve.raw_transactions ......... [[31mERROR[0m in 0.13s]
[0m13:24:38.859533 [debug] [Thread-1 (]: Finished running node model.sumup.raw_transactions
[0m13:24:38.863417 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:38.864138 [debug] [MainThread]: On master: BEGIN
[0m13:24:38.865058 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:24:38.878864 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:24:38.879874 [debug] [MainThread]: On master: COMMIT
[0m13:24:38.880642 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:38.881372 [debug] [MainThread]: On master: COMMIT
[0m13:24:38.882079 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:24:38.882768 [debug] [MainThread]: On master: Close
[0m13:24:38.884227 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:38.885087 [debug] [MainThread]: Connection 'model.sumup.raw_transactions' was properly closed.
[0m13:24:38.885607 [info ] [MainThread]: 
[0m13:24:38.886138 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m13:24:38.887864 [debug] [MainThread]: Command end result
[0m13:24:38.929068 [info ] [MainThread]: 
[0m13:24:38.932035 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:24:38.943520 [info ] [MainThread]: 
[0m13:24:38.945848 [error] [MainThread]: [33mDatabase Error in model raw_devices (sources/raw_devices.sql)[0m
[0m13:24:38.948625 [error] [MainThread]:   relation "dbt_merve.raw_devices" does not exist
[0m13:24:38.955107 [error] [MainThread]:   LINE 21: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
[0m13:24:38.957705 [error] [MainThread]:                                                                 ^
[0m13:24:38.960773 [error] [MainThread]:   compiled Code at target/run/sumup/sources/raw_devices.sql
[0m13:24:38.961736 [info ] [MainThread]: 
[0m13:24:38.964739 [error] [MainThread]: [33mDatabase Error in model raw_stores (sources/raw_stores.sql)[0m
[0m13:24:38.967314 [error] [MainThread]:   relation "dbt_merve.raw_stores" does not exist
[0m13:24:38.969091 [error] [MainThread]:   LINE 26: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
[0m13:24:38.969800 [error] [MainThread]:                                                                 ^
[0m13:24:38.970589 [error] [MainThread]:   compiled Code at target/run/sumup/sources/raw_stores.sql
[0m13:24:38.971171 [info ] [MainThread]: 
[0m13:24:38.974486 [error] [MainThread]: [33mDatabase Error in model raw_transactions (sources/raw_transactions.sql)[0m
[0m13:24:38.976143 [error] [MainThread]:   relation "dbt_merve.raw_transactions" does not exist
[0m13:24:38.976896 [error] [MainThread]:   LINE 38: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
[0m13:24:38.978821 [error] [MainThread]:                                                                 ^
[0m13:24:38.979850 [error] [MainThread]:   compiled Code at target/run/sumup/sources/raw_transactions.sql
[0m13:24:38.980589 [info ] [MainThread]: 
[0m13:24:38.982168 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m13:24:38.985324 [debug] [MainThread]: Command `dbt run` failed at 13:24:38.985130 after 1.61 seconds
[0m13:24:38.986026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10968dc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108414790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106747050>]}
[0m13:24:38.986756 [debug] [MainThread]: Flushing usage events
[0m13:27:02.490302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109053d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108d5050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e83f50>]}


============================== 13:27:02.498919 | 32657bbf-71b3-4893-a518-8e4dfd0cf00c ==============================
[0m13:27:02.498919 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:27:02.500010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:27:02.620737 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:27:02.621526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '32657bbf-71b3-4893-a518-8e4dfd0cf00c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110eb5a90>]}
[0m13:27:02.659128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32657bbf-71b3-4893-a518-8e4dfd0cf00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108ee290>]}
[0m13:27:02.671444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32657bbf-71b3-4893-a518-8e4dfd0cf00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111192650>]}
[0m13:27:02.673422 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m13:27:02.711179 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m13:27:02.787308 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:27:02.788136 [debug] [MainThread]: Partial parsing: updated file: sumup://sources/raw_devices.sql
[0m13:27:02.788667 [debug] [MainThread]: Partial parsing: updated file: sumup://sources/raw_stores.sql
[0m13:27:02.789183 [debug] [MainThread]: Partial parsing: updated file: sumup://sources/raw_transactions.sql
[0m13:27:02.846477 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 9 unused configuration paths:
- models.my_project.store_transaction_first
- models.my_project.pct_transaction
- models.my_project
- models.my_project.store_transaction_view
- models.my_project.top_ten_products
- models.my_project.inc_first_five_transaction
- models.my_project.avg_transaction_amount
- models.my_project.top_ten_stores
- sources.raw_data
[0m13:27:02.853989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32657bbf-71b3-4893-a518-8e4dfd0cf00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111828150>]}
[0m13:27:02.875500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32657bbf-71b3-4893-a518-8e4dfd0cf00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111f1e50>]}
[0m13:27:02.876186 [info ] [MainThread]: Found 6 tests, 3 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m13:27:02.877490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32657bbf-71b3-4893-a518-8e4dfd0cf00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da3df50>]}
[0m13:27:02.881202 [info ] [MainThread]: 
[0m13:27:02.882690 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:27:02.884470 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m13:27:02.902679 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m13:27:02.903333 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m13:27:02.903805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:02.955111 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m13:27:02.956988 [debug] [ThreadPool]: On list_merveyasa: Close
[0m13:27:02.959011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m13:27:02.965541 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m13:27:02.965964 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m13:27:02.966336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:02.972444 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:27:02.972859 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m13:27:02.973225 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m13:27:02.977012 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m13:27:02.978270 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m13:27:02.978837 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m13:27:02.983452 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:02.983841 [debug] [MainThread]: On master: BEGIN
[0m13:27:02.984139 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:27:02.990004 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:27:02.990385 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:02.990785 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:27:02.999827 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:27:03.002544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32657bbf-71b3-4893-a518-8e4dfd0cf00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11080d9d0>]}
[0m13:27:03.003636 [debug] [MainThread]: On master: ROLLBACK
[0m13:27:03.004588 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:03.005123 [debug] [MainThread]: On master: BEGIN
[0m13:27:03.005969 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:27:03.006509 [debug] [MainThread]: On master: COMMIT
[0m13:27:03.006964 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:03.007342 [debug] [MainThread]: On master: COMMIT
[0m13:27:03.007847 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:27:03.008251 [debug] [MainThread]: On master: Close
[0m13:27:03.009178 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:27:03.009699 [info ] [MainThread]: 
[0m13:27:03.012814 [debug] [Thread-1 (]: Began running node model.sumup.raw_devices
[0m13:27:03.013391 [info ] [Thread-1 (]: 1 of 3 START sql incremental model dbt_merve.raw_devices ....................... [RUN]
[0m13:27:03.014611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.raw_devices)
[0m13:27:03.015137 [debug] [Thread-1 (]: Began compiling node model.sumup.raw_devices
[0m13:27:03.025705 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.raw_devices"
[0m13:27:03.027884 [debug] [Thread-1 (]: Timing info for model.sumup.raw_devices (compile): 13:27:03.015457 => 13:27:03.027399
[0m13:27:03.028440 [debug] [Thread-1 (]: Began executing node model.sumup.raw_devices
[0m13:27:03.107046 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.raw_devices"
[0m13:27:03.108003 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_devices"
[0m13:27:03.108424 [debug] [Thread-1 (]: On model.sumup.raw_devices: BEGIN
[0m13:27:03.108806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:03.115428 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:27:03.115913 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_devices"
[0m13:27:03.116337 [debug] [Thread-1 (]: On model.sumup.raw_devices: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.raw_devices"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."raw_devices"
  
  
    as
  
  (
    

SELECT 
    metadata_timestamp,
    device_id, 
    device_type, 
    store_id
FROM devices
WHERE metadata_timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa"."dbt_merve"."raw_devices")
  );
  
  
[0m13:27:03.117707 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbt_merve.raw_devices" does not exist
LINE 21: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
                                                              ^

[0m13:27:03.118180 [debug] [Thread-1 (]: On model.sumup.raw_devices: ROLLBACK
[0m13:27:03.119007 [debug] [Thread-1 (]: Timing info for model.sumup.raw_devices (execute): 13:27:03.028773 => 13:27:03.118743
[0m13:27:03.119469 [debug] [Thread-1 (]: On model.sumup.raw_devices: Close
[0m13:27:03.161861 [debug] [Thread-1 (]: Database Error in model raw_devices (sources/raw_devices.sql)
  relation "dbt_merve.raw_devices" does not exist
  LINE 21: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
                                                                ^
  compiled Code at target/run/sumup/sources/raw_devices.sql
[0m13:27:03.163012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32657bbf-71b3-4893-a518-8e4dfd0cf00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11188c290>]}
[0m13:27:03.163985 [error] [Thread-1 (]: 1 of 3 ERROR creating sql incremental model dbt_merve.raw_devices .............. [[31mERROR[0m in 0.15s]
[0m13:27:03.165061 [debug] [Thread-1 (]: Finished running node model.sumup.raw_devices
[0m13:27:03.165646 [debug] [Thread-1 (]: Began running node model.sumup.raw_stores
[0m13:27:03.166655 [info ] [Thread-1 (]: 2 of 3 START sql incremental model dbt_merve.raw_stores ........................ [RUN]
[0m13:27:03.167658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.raw_devices, now model.sumup.raw_stores)
[0m13:27:03.168248 [debug] [Thread-1 (]: Began compiling node model.sumup.raw_stores
[0m13:27:03.171707 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.raw_stores"
[0m13:27:03.172653 [debug] [Thread-1 (]: Timing info for model.sumup.raw_stores (compile): 13:27:03.168603 => 13:27:03.172372
[0m13:27:03.173096 [debug] [Thread-1 (]: Began executing node model.sumup.raw_stores
[0m13:27:03.180929 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.raw_stores"
[0m13:27:03.181752 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_stores"
[0m13:27:03.182141 [debug] [Thread-1 (]: On model.sumup.raw_stores: BEGIN
[0m13:27:03.182486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:03.190549 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:27:03.190995 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_stores"
[0m13:27:03.191372 [debug] [Thread-1 (]: On model.sumup.raw_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.raw_stores"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."raw_stores"
  
  
    as
  
  (
    

SELECT 
    metadata_timestamp,
    store_id, 
    store_name, 
    store_address, 
    REGEXP_REPLACE(store_city, '[^a-zA-Z\s]', '', 'g') as store_city, 
    store_country, 
    store_created_at, 
    store_typology, 
    customer_id
	FROM stores
WHERE metadata_timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa"."dbt_merve"."raw_stores")
  );
  
  
[0m13:27:03.192636 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbt_merve.raw_stores" does not exist
LINE 26: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
                                                              ^

[0m13:27:03.193122 [debug] [Thread-1 (]: On model.sumup.raw_stores: ROLLBACK
[0m13:27:03.194123 [debug] [Thread-1 (]: Timing info for model.sumup.raw_stores (execute): 13:27:03.173371 => 13:27:03.193677
[0m13:27:03.194816 [debug] [Thread-1 (]: On model.sumup.raw_stores: Close
[0m13:27:03.197987 [debug] [Thread-1 (]: Database Error in model raw_stores (sources/raw_stores.sql)
  relation "dbt_merve.raw_stores" does not exist
  LINE 26: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
                                                                ^
  compiled Code at target/run/sumup/sources/raw_stores.sql
[0m13:27:03.198499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32657bbf-71b3-4893-a518-8e4dfd0cf00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108ee950>]}
[0m13:27:03.199065 [error] [Thread-1 (]: 2 of 3 ERROR creating sql incremental model dbt_merve.raw_stores ............... [[31mERROR[0m in 0.03s]
[0m13:27:03.199998 [debug] [Thread-1 (]: Finished running node model.sumup.raw_stores
[0m13:27:03.200659 [debug] [Thread-1 (]: Began running node model.sumup.raw_transactions
[0m13:27:03.202732 [info ] [Thread-1 (]: 3 of 3 START sql incremental model dbt_merve.raw_transactions .................. [RUN]
[0m13:27:03.204015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.raw_stores, now model.sumup.raw_transactions)
[0m13:27:03.204423 [debug] [Thread-1 (]: Began compiling node model.sumup.raw_transactions
[0m13:27:03.207997 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.raw_transactions"
[0m13:27:03.208963 [debug] [Thread-1 (]: Timing info for model.sumup.raw_transactions (compile): 13:27:03.204681 => 13:27:03.208608
[0m13:27:03.209565 [debug] [Thread-1 (]: Began executing node model.sumup.raw_transactions
[0m13:27:03.215517 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.raw_transactions"
[0m13:27:03.216441 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_transactions"
[0m13:27:03.216893 [debug] [Thread-1 (]: On model.sumup.raw_transactions: BEGIN
[0m13:27:03.217325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:03.225333 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:27:03.225950 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_transactions"
[0m13:27:03.226545 [debug] [Thread-1 (]: On model.sumup.raw_transactions: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.raw_transactions"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."raw_transactions"
  
  
    as
  
  (
    

SELECT 
    metadata_timestamp,
    transaction_id, 
    device_id, 
    LOWER(REGEXP_REPLACE(product_name, '[^a-zA-Z\s]+', '', 'g')) as product_name, 
    (CASE 
            WHEN product_sku ~ E'^\\d+\\.\\d+E\\+\\d+$' 
            THEN LTRIM(TO_CHAR(CAST(product_sku AS DOUBLE PRECISION), '9999999999999999999999999'))
            ELSE product_sku
        END) as product_sku, 
    LOWER(REGEXP_REPLACE(category_name, '[^a-zA-Z\s]+', '', 'g')) as category_name, 
    transaction_amount, 
    transaction_status, 
    CASE 
        WHEN card_number ~ E'^\\d+\\.\\d+E\\+\\d+$' THEN 
            LTRIM(TO_CHAR(CAST(card_number AS DOUBLE PRECISION), '9999999999999999999'))
        ELSE 
            REPLACE(card_number, ' ', '') 
    END as card_number, 
    cvv, 
    transaction_created_at, 
    transaction_happened_at
	FROM transactions
WHERE metadata_timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa"."dbt_merve"."raw_transactions")
  );
  
  
[0m13:27:03.228871 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbt_merve.raw_transactions" does not exist
LINE 38: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
                                                              ^

[0m13:27:03.229336 [debug] [Thread-1 (]: On model.sumup.raw_transactions: ROLLBACK
[0m13:27:03.230121 [debug] [Thread-1 (]: Timing info for model.sumup.raw_transactions (execute): 13:27:03.209880 => 13:27:03.229884
[0m13:27:03.230512 [debug] [Thread-1 (]: On model.sumup.raw_transactions: Close
[0m13:27:03.234220 [debug] [Thread-1 (]: Database Error in model raw_transactions (sources/raw_transactions.sql)
  relation "dbt_merve.raw_transactions" does not exist
  LINE 38: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
                                                                ^
  compiled Code at target/run/sumup/sources/raw_transactions.sql
[0m13:27:03.235092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32657bbf-71b3-4893-a518-8e4dfd0cf00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11116f350>]}
[0m13:27:03.236826 [error] [Thread-1 (]: 3 of 3 ERROR creating sql incremental model dbt_merve.raw_transactions ......... [[31mERROR[0m in 0.03s]
[0m13:27:03.237763 [debug] [Thread-1 (]: Finished running node model.sumup.raw_transactions
[0m13:27:03.240028 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:03.240390 [debug] [MainThread]: On master: BEGIN
[0m13:27:03.240689 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:27:03.248130 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:27:03.248539 [debug] [MainThread]: On master: COMMIT
[0m13:27:03.248851 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:03.249148 [debug] [MainThread]: On master: COMMIT
[0m13:27:03.249816 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:27:03.250234 [debug] [MainThread]: On master: Close
[0m13:27:03.251325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:03.252217 [debug] [MainThread]: Connection 'model.sumup.raw_transactions' was properly closed.
[0m13:27:03.252669 [info ] [MainThread]: 
[0m13:27:03.253335 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m13:27:03.254550 [debug] [MainThread]: Command end result
[0m13:27:03.266744 [info ] [MainThread]: 
[0m13:27:03.267701 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:27:03.268361 [info ] [MainThread]: 
[0m13:27:03.269083 [error] [MainThread]: [33mDatabase Error in model raw_devices (sources/raw_devices.sql)[0m
[0m13:27:03.269675 [error] [MainThread]:   relation "dbt_merve.raw_devices" does not exist
[0m13:27:03.270234 [error] [MainThread]:   LINE 21: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
[0m13:27:03.270766 [error] [MainThread]:                                                                 ^
[0m13:27:03.271238 [error] [MainThread]:   compiled Code at target/run/sumup/sources/raw_devices.sql
[0m13:27:03.271722 [info ] [MainThread]: 
[0m13:27:03.273118 [error] [MainThread]: [33mDatabase Error in model raw_stores (sources/raw_stores.sql)[0m
[0m13:27:03.274242 [error] [MainThread]:   relation "dbt_merve.raw_stores" does not exist
[0m13:27:03.275937 [error] [MainThread]:   LINE 26: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
[0m13:27:03.276609 [error] [MainThread]:                                                                 ^
[0m13:27:03.278979 [error] [MainThread]:   compiled Code at target/run/sumup/sources/raw_stores.sql
[0m13:27:03.279450 [info ] [MainThread]: 
[0m13:27:03.279981 [error] [MainThread]: [33mDatabase Error in model raw_transactions (sources/raw_transactions.sql)[0m
[0m13:27:03.280438 [error] [MainThread]:   relation "dbt_merve.raw_transactions" does not exist
[0m13:27:03.280980 [error] [MainThread]:   LINE 38: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
[0m13:27:03.281416 [error] [MainThread]:                                                                 ^
[0m13:27:03.282101 [error] [MainThread]:   compiled Code at target/run/sumup/sources/raw_transactions.sql
[0m13:27:03.282595 [info ] [MainThread]: 
[0m13:27:03.283336 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m13:27:03.284430 [debug] [MainThread]: Command `dbt run` failed at 13:27:03.284251 after 0.84 seconds
[0m13:27:03.285043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c04d710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c04d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d42490>]}
[0m13:27:03.285705 [debug] [MainThread]: Flushing usage events
[0m13:28:48.321751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11144a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111448690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114fb650>]}


============================== 13:28:48.330438 | 4529ae4d-0b5d-476a-ada2-4a0c4a2a1473 ==============================
[0m13:28:48.330438 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:28:48.331479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'debug': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:28:48.463892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4529ae4d-0b5d-476a-ada2-4a0c4a2a1473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a2fa10>]}
[0m13:28:48.472924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4529ae4d-0b5d-476a-ada2-4a0c4a2a1473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11170f990>]}
[0m13:28:48.474711 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m13:28:48.518030 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m13:28:48.540071 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:28:48.541017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4529ae4d-0b5d-476a-ada2-4a0c4a2a1473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ef2cd0>]}
[0m13:28:49.411494 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.sumup.fact_product_agg' (models/fact_product_agg.sql) depends on a source named 'raw_data.raw_transactions' which was not found
[0m13:28:49.412462 [debug] [MainThread]: Command `dbt run` failed at 13:28:49.412285 after 1.12 seconds
[0m13:28:49.412932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a21410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11170f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114fb5d0>]}
[0m13:28:49.413353 [debug] [MainThread]: Flushing usage events
[0m13:35:03.813981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc1b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df16e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d996650>]}


============================== 13:35:03.823988 | 418e9910-20aa-485c-90eb-96f3e1a8d927 ==============================
[0m13:35:03.823988 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:35:03.825227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:35:03.934537 [error] [MainThread]: Encountered an error:
Runtime Error
  source-paths and model-paths cannot both be defined. The `source-paths` config has been deprecated in favor of `model-paths`. Please update your `dbt_project.yml` configuration to reflect this change.

Error encountered in /Users/merveyasa/Desktop/Folder for sumup/dbt_project.yml
[0m13:35:03.935632 [debug] [MainThread]: Command `dbt run` failed at 13:35:03.935434 after 0.16 seconds
[0m13:35:03.936094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcaa550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9a6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9a7390>]}
[0m13:35:03.936553 [debug] [MainThread]: Flushing usage events
[0m13:35:17.659604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10def8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e16e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e16c550>]}


============================== 13:35:17.665731 | 490c619d-e2f7-465b-b0dc-21cfa86b5a10 ==============================
[0m13:35:17.665731 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:35:17.666767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'debug': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:35:17.679609 [error] [MainThread]: Encountered an error:
Runtime Error
  source-paths and model-paths cannot both be defined. The `source-paths` config has been deprecated in favor of `model-paths`. Please update your `dbt_project.yml` configuration to reflect this change.

Error encountered in /Users/merveyasa/Desktop/Folder for sumup/dbt_project.yml
[0m13:35:17.680822 [debug] [MainThread]: Command `dbt clean` failed at 13:35:17.680578 after 0.04 seconds
[0m13:35:17.681506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e49fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e15ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e200f50>]}
[0m13:35:17.682599 [debug] [MainThread]: Flushing usage events
[0m13:39:08.828005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11077c150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a5fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110836b10>]}


============================== 13:39:08.835873 | 89624523-d954-41a4-b5eb-25ed0f1a20e5 ==============================
[0m13:39:08.835873 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:39:08.836773 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:39:08.954391 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['sources']: [{'name': 'raw_data', 'database': 'merveyasa', 'schema': 'public', 'tables': [{'name': 'raw_stores', 'identifier': 'raw_stores'}, {'name': 'raw_devices', 'identifier': 'raw_devices'}, {'name': 'raw_transactions', 'identifier': 'raw_transactions'}]}] is not of type 'object'

Error encountered in /Users/merveyasa/Desktop/Folder for sumup/dbt_project.yml
[0m13:39:08.955447 [debug] [MainThread]: Command `dbt run` failed at 13:39:08.955246 after 0.17 seconds
[0m13:39:08.955909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103fd750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a5fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11077fe50>]}
[0m13:39:08.956377 [debug] [MainThread]: Flushing usage events
[0m13:40:17.790772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc92d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc65790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffdc650>]}


============================== 13:40:17.800306 | d1e60441-32bf-4e01-87fb-b0c2d9d00e15 ==============================
[0m13:40:17.800306 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:40:17.802049 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m13:40:17.983384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1e60441-32bf-4e01-87fb-b0c2d9d00e15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102eb2d0>]}
[0m13:40:17.994387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1e60441-32bf-4e01-87fb-b0c2d9d00e15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3a5610>]}
[0m13:40:17.995531 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m13:40:18.039913 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m13:40:18.077186 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:40:18.078036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd1e60441-32bf-4e01-87fb-b0c2d9d00e15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106d3150>]}
[0m13:40:18.962564 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.sumup.fact_product_agg' (models/fact_product_agg.sql) depends on a source named 'raw_data.raw_transactions' which was not found
[0m13:40:18.963665 [debug] [MainThread]: Command `dbt run` failed at 13:40:18.963466 after 1.21 seconds
[0m13:40:18.964143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6af610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102f4c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11006a410>]}
[0m13:40:18.964583 [debug] [MainThread]: Flushing usage events
[0m13:46:22.583504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e96f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bd8650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bf7250>]}


============================== 13:46:22.591341 | f614518e-d383-4a43-8afd-7ab2949ac7d2 ==============================
[0m13:46:22.591341 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:46:22.592276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:46:22.720073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f614518e-d383-4a43-8afd-7ab2949ac7d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a496650>]}
[0m13:46:22.729189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f614518e-d383-4a43-8afd-7ab2949ac7d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a05ef10>]}
[0m13:46:22.730296 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m13:46:22.765510 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m13:46:22.789213 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:46:22.789986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f614518e-d383-4a43-8afd-7ab2949ac7d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ec2fd0>]}
[0m13:46:23.661052 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.sumup.dim_inc_first_five_transaction' (models/dim_inc_first_five_transaction.sql) depends on a node named 'store_transaction_first' which was not found
[0m13:46:23.662005 [debug] [MainThread]: Command `dbt run` failed at 13:46:23.661826 after 1.12 seconds
[0m13:46:23.662459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cbc190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1a6f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a575c50>]}
[0m13:46:23.662903 [debug] [MainThread]: Flushing usage events
[0m13:46:49.215214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10517d710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10500e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f79210>]}


============================== 13:46:49.220435 | e52b583c-af0c-42cc-802c-2cb615cdb5b1 ==============================
[0m13:46:49.220435 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:46:49.221220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:46:49.313715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e52b583c-af0c-42cc-802c-2cb615cdb5b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105221ad0>]}
[0m13:46:49.322436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e52b583c-af0c-42cc-802c-2cb615cdb5b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057fe890>]}
[0m13:46:49.323126 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m13:46:49.358271 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m13:46:49.369890 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:46:49.371080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e52b583c-af0c-42cc-802c-2cb615cdb5b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052209d0>]}
[0m13:46:50.283770 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 8 unused configuration paths:
- models.my_project.store_transaction_first
- models.my_project.store_transaction_view
- models.my_project.top_ten_products
- models.my_project.pct_transaction
- models.my_project.top_ten_stores
- models.my_project.avg_transaction_amount
- models.my_project
- models.my_project.inc_first_five_transaction
[0m13:46:50.295952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e52b583c-af0c-42cc-802c-2cb615cdb5b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa6cd0>]}
[0m13:46:50.336978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e52b583c-af0c-42cc-802c-2cb615cdb5b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eafd10>]}
[0m13:46:50.337744 [info ] [MainThread]: Found 8 models, 35 tests, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m13:46:50.338537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e52b583c-af0c-42cc-802c-2cb615cdb5b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105558190>]}
[0m13:46:50.342015 [info ] [MainThread]: 
[0m13:46:50.343165 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:46:50.346096 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m13:46:50.366493 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m13:46:50.367075 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m13:46:50.367504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:50.431851 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m13:46:50.433580 [debug] [ThreadPool]: On list_merveyasa: Close
[0m13:46:50.435844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m13:46:50.442137 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m13:46:50.442544 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m13:46:50.442868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:50.449715 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:46:50.450229 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m13:46:50.450690 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m13:46:50.454592 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m13:46:50.455904 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m13:46:50.456387 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m13:46:50.461305 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:50.461718 [debug] [MainThread]: On master: BEGIN
[0m13:46:50.462045 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:46:50.467582 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:46:50.468031 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:50.468499 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:46:50.477978 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:46:50.479247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e52b583c-af0c-42cc-802c-2cb615cdb5b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10581bc50>]}
[0m13:46:50.479761 [debug] [MainThread]: On master: ROLLBACK
[0m13:46:50.480238 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:50.480580 [debug] [MainThread]: On master: BEGIN
[0m13:46:50.481111 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:46:50.481460 [debug] [MainThread]: On master: COMMIT
[0m13:46:50.481796 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:50.482121 [debug] [MainThread]: On master: COMMIT
[0m13:46:50.482543 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:46:50.482888 [debug] [MainThread]: On master: Close
[0m13:46:50.483631 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:46:50.484042 [info ] [MainThread]: 
[0m13:46:50.487059 [debug] [Thread-1 (]: Began running node model.sumup.fact_product_agg
[0m13:46:50.487674 [info ] [Thread-1 (]: 1 of 8 START sql view model dbt_merve.fact_product_agg ......................... [RUN]
[0m13:46:50.488474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.fact_product_agg)
[0m13:46:50.488922 [debug] [Thread-1 (]: Began compiling node model.sumup.fact_product_agg
[0m13:46:50.499575 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.fact_product_agg"
[0m13:46:50.500979 [debug] [Thread-1 (]: Timing info for model.sumup.fact_product_agg (compile): 13:46:50.489246 => 13:46:50.500559
[0m13:46:50.501555 [debug] [Thread-1 (]: Began executing node model.sumup.fact_product_agg
[0m13:46:50.549655 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.fact_product_agg"
[0m13:46:50.551011 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_product_agg"
[0m13:46:50.551527 [debug] [Thread-1 (]: On model.sumup.fact_product_agg: BEGIN
[0m13:46:50.551939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:50.558535 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:46:50.559048 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_product_agg"
[0m13:46:50.559513 [debug] [Thread-1 (]: On model.sumup.fact_product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.fact_product_agg"} */

  create view "merveyasa"."dbt_merve"."fact_product_agg__dbt_tmp"
    
    
  as (
    

WITH products_aggregated AS
(
    SELECT
        product_name,
        product_sku,
        COUNT(*) AS transactions_count,
        SUM(transaction_amount) AS total_transaction_amount
    FROM
        "merveyasa"."public"."raw_transactions"
    WHERE
        transaction_status = 'accepted' 
    GROUP BY
        product_name, product_sku
)
select * from products_aggregated
  );
[0m13:46:50.560554 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.raw_transactions" does not exist
LINE 17:         "merveyasa"."public"."raw_transactions"
                 ^

[0m13:46:50.561026 [debug] [Thread-1 (]: On model.sumup.fact_product_agg: ROLLBACK
[0m13:46:50.561947 [debug] [Thread-1 (]: Timing info for model.sumup.fact_product_agg (execute): 13:46:50.501913 => 13:46:50.561543
[0m13:46:50.562446 [debug] [Thread-1 (]: On model.sumup.fact_product_agg: Close
[0m13:46:50.580565 [debug] [Thread-1 (]: Database Error in model fact_product_agg (models/fact_product_agg.sql)
  relation "public.raw_transactions" does not exist
  LINE 17:         "merveyasa"."public"."raw_transactions"
                   ^
  compiled Code at target/run/sumup/models/fact_product_agg.sql
[0m13:46:50.581197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e52b583c-af0c-42cc-802c-2cb615cdb5b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10584ffd0>]}
[0m13:46:50.581834 [error] [Thread-1 (]: 1 of 8 ERROR creating sql view model dbt_merve.fact_product_agg ................ [[31mERROR[0m in 0.09s]
[0m13:46:50.582554 [debug] [Thread-1 (]: Finished running node model.sumup.fact_product_agg
[0m13:46:50.583037 [debug] [Thread-1 (]: Began running node model.sumup.fact_store_transaction_view
[0m13:46:50.583890 [info ] [Thread-1 (]: 2 of 8 START sql view model dbt_merve.fact_store_transaction_view .............. [RUN]
[0m13:46:50.584836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.fact_product_agg, now model.sumup.fact_store_transaction_view)
[0m13:46:50.585452 [debug] [Thread-1 (]: Began compiling node model.sumup.fact_store_transaction_view
[0m13:46:50.589230 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.fact_store_transaction_view"
[0m13:46:50.590272 [debug] [Thread-1 (]: Timing info for model.sumup.fact_store_transaction_view (compile): 13:46:50.585746 => 13:46:50.589907
[0m13:46:50.590727 [debug] [Thread-1 (]: Began executing node model.sumup.fact_store_transaction_view
[0m13:46:50.597317 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.fact_store_transaction_view"
[0m13:46:50.598213 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_store_transaction_view"
[0m13:46:50.598625 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_view: BEGIN
[0m13:46:50.599006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:50.606938 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:46:50.607435 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_store_transaction_view"
[0m13:46:50.607869 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.fact_store_transaction_view"} */

  create view "merveyasa"."dbt_merve"."fact_store_transaction_view__dbt_tmp"
    
    
  as (
    

WITH store_transactions AS
(
    SELECT
        t.metadata_timestamp,
        s.store_id,
        s.store_typology,
        s.store_country,
        t.product_name,
        t.product_sku,
        t.category_name,
        t.transaction_amount,
        t.transaction_status,
        t.transaction_happened_at,
        d.device_type
    FROM
        "merveyasa"."public"."raw_transactions" t
    JOIN "merveyasa"."public"."raw_devices" d ON t.device_id = d.device_id
    JOIN "merveyasa"."public"."raw_stores" s ON d.store_id = s.store_id
)

select * from store_transactions
  );
[0m13:46:50.608792 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.raw_transactions" does not exist
LINE 24:         "merveyasa"."public"."raw_transactions" t
                 ^

[0m13:46:50.609228 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_view: ROLLBACK
[0m13:46:50.610093 [debug] [Thread-1 (]: Timing info for model.sumup.fact_store_transaction_view (execute): 13:46:50.591009 => 13:46:50.609797
[0m13:46:50.610551 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_view: Close
[0m13:46:50.613727 [debug] [Thread-1 (]: Database Error in model fact_store_transaction_view (models/fact_store_transaction_view.sql)
  relation "public.raw_transactions" does not exist
  LINE 24:         "merveyasa"."public"."raw_transactions" t
                   ^
  compiled Code at target/run/sumup/models/fact_store_transaction_view.sql
[0m13:46:50.614384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e52b583c-af0c-42cc-802c-2cb615cdb5b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058d7ad0>]}
[0m13:46:50.615032 [error] [Thread-1 (]: 2 of 8 ERROR creating sql view model dbt_merve.fact_store_transaction_view ..... [[31mERROR[0m in 0.03s]
[0m13:46:50.615746 [debug] [Thread-1 (]: Finished running node model.sumup.fact_store_transaction_view
[0m13:46:50.616281 [debug] [Thread-1 (]: Began running node model.sumup.dim_top_ten_products
[0m13:46:50.617116 [info ] [Thread-1 (]: 3 of 8 SKIP relation dbt_merve.dim_top_ten_products ............................ [[33mSKIP[0m]
[0m13:46:50.617785 [debug] [Thread-1 (]: Finished running node model.sumup.dim_top_ten_products
[0m13:46:50.619047 [debug] [Thread-1 (]: Began running node model.sumup.dim_avg_transaction_amount
[0m13:46:50.619605 [info ] [Thread-1 (]: 4 of 8 SKIP relation dbt_merve.dim_avg_transaction_amount ...................... [[33mSKIP[0m]
[0m13:46:50.620479 [debug] [Thread-1 (]: Finished running node model.sumup.dim_avg_transaction_amount
[0m13:46:50.621686 [debug] [Thread-1 (]: Began running node model.sumup.dim_pct_transaction
[0m13:46:50.622332 [info ] [Thread-1 (]: 5 of 8 SKIP relation dbt_merve.dim_pct_transaction ............................. [[33mSKIP[0m]
[0m13:46:50.622973 [debug] [Thread-1 (]: Finished running node model.sumup.dim_pct_transaction
[0m13:46:50.623440 [debug] [Thread-1 (]: Began running node model.sumup.dim_top_ten_stores
[0m13:46:50.624266 [info ] [Thread-1 (]: 6 of 8 SKIP relation dbt_merve.dim_top_ten_stores .............................. [[33mSKIP[0m]
[0m13:46:50.624884 [debug] [Thread-1 (]: Finished running node model.sumup.dim_top_ten_stores
[0m13:46:50.625704 [debug] [Thread-1 (]: Began running node model.sumup.fact_store_transaction_first
[0m13:46:50.626304 [info ] [Thread-1 (]: 7 of 8 SKIP relation dbt_merve.fact_store_transaction_first .................... [[33mSKIP[0m]
[0m13:46:50.626881 [debug] [Thread-1 (]: Finished running node model.sumup.fact_store_transaction_first
[0m13:46:50.629448 [debug] [Thread-1 (]: Began running node model.sumup.dim_inc_first_five_transaction
[0m13:46:50.630339 [info ] [Thread-1 (]: 8 of 8 SKIP relation dbt_merve.dim_inc_first_five_transaction .................. [[33mSKIP[0m]
[0m13:46:50.630890 [debug] [Thread-1 (]: Finished running node model.sumup.dim_inc_first_five_transaction
[0m13:46:50.633298 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:50.633724 [debug] [MainThread]: On master: BEGIN
[0m13:46:50.634115 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:46:50.641572 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:46:50.642027 [debug] [MainThread]: On master: COMMIT
[0m13:46:50.642372 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:50.642702 [debug] [MainThread]: On master: COMMIT
[0m13:46:50.643163 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:46:50.643527 [debug] [MainThread]: On master: Close
[0m13:46:50.644403 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:50.644939 [debug] [MainThread]: Connection 'model.sumup.fact_store_transaction_view' was properly closed.
[0m13:46:50.645358 [info ] [MainThread]: 
[0m13:46:50.645824 [info ] [MainThread]: Finished running 6 view models, 2 incremental models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m13:46:50.647126 [debug] [MainThread]: Command end result
[0m13:46:50.659455 [info ] [MainThread]: 
[0m13:46:50.660076 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m13:46:50.660436 [info ] [MainThread]: 
[0m13:46:50.660780 [error] [MainThread]: [33mDatabase Error in model fact_product_agg (models/fact_product_agg.sql)[0m
[0m13:46:50.661120 [error] [MainThread]:   relation "public.raw_transactions" does not exist
[0m13:46:50.661449 [error] [MainThread]:   LINE 17:         "merveyasa"."public"."raw_transactions"
[0m13:46:50.661771 [error] [MainThread]:                    ^
[0m13:46:50.662092 [error] [MainThread]:   compiled Code at target/run/sumup/models/fact_product_agg.sql
[0m13:46:50.662419 [info ] [MainThread]: 
[0m13:46:50.662914 [error] [MainThread]: [33mDatabase Error in model fact_store_transaction_view (models/fact_store_transaction_view.sql)[0m
[0m13:46:50.663669 [error] [MainThread]:   relation "public.raw_transactions" does not exist
[0m13:46:50.664054 [error] [MainThread]:   LINE 24:         "merveyasa"."public"."raw_transactions" t
[0m13:46:50.664392 [error] [MainThread]:                    ^
[0m13:46:50.664763 [error] [MainThread]:   compiled Code at target/run/sumup/models/fact_store_transaction_view.sql
[0m13:46:50.665147 [info ] [MainThread]: 
[0m13:46:50.665544 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=6 TOTAL=8
[0m13:46:50.666541 [debug] [MainThread]: Command `dbt run` failed at 13:46:50.666395 after 1.47 seconds
[0m13:46:50.667016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105221b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105530390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105531810>]}
[0m13:46:50.667699 [debug] [MainThread]: Flushing usage events
[0m13:51:17.474883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097537d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a6f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a6fc50>]}


============================== 13:51:17.492661 | c0567cd1-408f-4e08-8cfd-2658de292528 ==============================
[0m13:51:17.492661 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:51:17.494029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m13:51:17.684037 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['sources']: [{'name': 'raw_data', 'database': 'merveyasa', 'schema': 'dbt_merve', 'tables': [{'name': 'raw_stores', 'identifier': 'raw_stores'}, {'name': 'raw_devices', 'identifier': 'raw_devices'}, {'name': 'raw_transactions', 'identifier': 'raw_transactions'}]}] is not of type 'object'

Error encountered in /Users/merveyasa/Desktop/Folder for sumup/dbt_project.yml
[0m13:51:17.685977 [debug] [MainThread]: Command `dbt run` failed at 13:51:17.684915 after 0.26 seconds
[0m13:51:17.686791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094a6390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a65d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109854690>]}
[0m13:51:17.687459 [debug] [MainThread]: Flushing usage events
[0m13:52:51.573688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc97410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2918d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bffb6d0>]}


============================== 13:52:51.579828 | ca439882-fe65-44dd-a41a-a2e527b08868 ==============================
[0m13:52:51.579828 [info ] [MainThread]: Running with dbt=1.6.0
[0m13:52:51.580707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:52:51.670122 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['sources']: [{'name': 'sources', 'database': 'merveyasa', 'schema': 'dbt_merve', 'tables': [{'name': 'raw_stores', 'identifier': 'raw_stores'}, {'name': 'raw_devices', 'identifier': 'raw_devices'}, {'name': 'raw_transactions', 'identifier': 'raw_transactions'}]}] is not of type 'object'

Error encountered in /Users/merveyasa/Desktop/Folder for sumup/dbt_project.yml
[0m13:52:51.671052 [debug] [MainThread]: Command `dbt run` failed at 13:52:51.670888 after 0.12 seconds
[0m13:52:51.671495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c597f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5a5f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba5b610>]}
[0m13:52:51.671972 [debug] [MainThread]: Flushing usage events
[0m14:06:10.726843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111169510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e99dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111456f50>]}


============================== 14:06:10.737866 | e3f65a6f-b638-4c3b-a49b-a8d764dc6f60 ==============================
[0m14:06:10.737866 [info ] [MainThread]: Running with dbt=1.6.0
[0m14:06:10.738843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:10.922545 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['sources']: [{'name': 'raw_data', 'database': 'merveyasa', 'schema': 'public', 'tables': [{'name': 'raw_stores', 'identifier': 'raw_stores'}, {'name': 'raw_devices', 'identifier': 'raw_devices'}, {'name': 'raw_transactions', 'identifier': 'raw_transactions'}]}] is not of type 'object'

Error encountered in /Users/merveyasa/Desktop/Folder for sumup/dbt_project.yml
[0m14:06:10.923780 [debug] [MainThread]: Command `dbt run` failed at 14:06:10.923528 after 0.23 seconds
[0m14:06:10.924290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11144db90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ec8150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ec9a50>]}
[0m14:06:10.924735 [debug] [MainThread]: Flushing usage events
[0m14:08:24.714130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea47250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed9b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea47650>]}


============================== 14:08:24.721723 | 1f3719c7-7c76-43ce-907e-908ff02d516a ==============================
[0m14:08:24.721723 [info ] [MainThread]: Running with dbt=1.6.0
[0m14:08:24.722672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:08:24.976196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f3719c7-7c76-43ce-907e-908ff02d516a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efd7f10>]}
[0m14:08:24.985147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f3719c7-7c76-43ce-907e-908ff02d516a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecc7c50>]}
[0m14:08:24.986232 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m14:08:25.026971 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m14:08:25.063061 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:08:25.063801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1f3719c7-7c76-43ce-907e-908ff02d516a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3ff3d0>]}
[0m14:08:25.923985 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.sumup.fact_product_agg' (models/fact_product_agg.sql) depends on a source named 'raw_data.raw_transactions' which was not found
[0m14:08:25.924953 [debug] [MainThread]: Command `dbt run` failed at 14:08:25.924777 after 1.25 seconds
[0m14:08:25.925422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f421c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecde010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecdcc10>]}
[0m14:08:25.925838 [debug] [MainThread]: Flushing usage events
[0m14:09:35.713474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee3e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb35a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee47f50>]}


============================== 14:09:35.719094 | afe6b251-5387-4834-b923-e0f5a56dd4b7 ==============================
[0m14:09:35.719094 [info ] [MainThread]: Running with dbt=1.6.0
[0m14:09:35.719863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m14:09:35.798178 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['sources']: [{'name': 'raw_data', 'database': 'merveyasa', 'schema': 'public', 'tables': [{'name': 'raw_stores', 'identifier': 'raw_stores'}, {'name': 'raw_devices', 'identifier': 'raw_devices'}, {'name': 'raw_transactions', 'identifier': 'raw_transactions'}]}] is not of type 'object'

Error encountered in /Users/merveyasa/Desktop/Folder for sumup/dbt_project.yml
[0m14:09:35.799096 [debug] [MainThread]: Command `dbt run` failed at 14:09:35.798945 after 0.11 seconds
[0m14:09:35.799501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb240d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb500d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e88da50>]}
[0m14:09:35.799931 [debug] [MainThread]: Flushing usage events
[0m14:11:20.614356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fb8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140524d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142f2c10>]}


============================== 14:11:20.623911 | 5f27acda-e794-4b2b-8047-a909aa4b2cd9 ==============================
[0m14:11:20.623911 [info ] [MainThread]: Running with dbt=1.6.0
[0m14:11:20.625078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'version_check': 'True', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:11:20.751899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f27acda-e794-4b2b-8047-a909aa4b2cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11485d810>]}
[0m14:11:20.760934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f27acda-e794-4b2b-8047-a909aa4b2cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140528d0>]}
[0m14:11:20.762391 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m14:11:20.796242 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m14:11:20.827215 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:11:20.827920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5f27acda-e794-4b2b-8047-a909aa4b2cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114997810>]}
[0m14:11:21.681518 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.sumup.fact_product_agg' (models/fact_product_agg.sql) depends on a source named 'raw_data.transactions' which was not found
[0m14:11:21.682519 [debug] [MainThread]: Command `dbt run` failed at 14:11:21.682332 after 1.10 seconds
[0m14:11:21.682993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114434850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114570450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11486bfd0>]}
[0m14:11:21.683426 [debug] [MainThread]: Flushing usage events
[0m14:11:44.199235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e023710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107187d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a1b410>]}


============================== 14:11:44.204780 | f0508ad1-4dd9-4fc4-98b0-20799e60a696 ==============================
[0m14:11:44.204780 [info ] [MainThread]: Running with dbt=1.6.0
[0m14:11:44.205639 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'version_check': 'True', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:11:44.298063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0508ad1-4dd9-4fc4-98b0-20799e60a696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a23a90>]}
[0m14:11:44.306781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0508ad1-4dd9-4fc4-98b0-20799e60a696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a42f10>]}
[0m14:11:44.307484 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m14:11:44.333677 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m14:11:44.349971 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:11:44.350654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f0508ad1-4dd9-4fc4-98b0-20799e60a696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe6c4d0>]}
[0m14:11:45.130537 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.sumup.fact_product_agg' (models/fact_product_agg.sql) depends on a source named 'raw_data.raw_transactions' which was not found
[0m14:11:45.131511 [debug] [MainThread]: Command `dbt run` failed at 14:11:45.131356 after 0.95 seconds
[0m14:11:45.131967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11072d7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104f69d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d8bfd0>]}
[0m14:11:45.132391 [debug] [MainThread]: Flushing usage events
[0m14:14:26.236430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ecc150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b04b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ec59d0>]}


============================== 14:14:26.251183 | 32eec732-3f63-46b0-9bf3-d9dcdf3d16ce ==============================
[0m14:14:26.251183 [info ] [MainThread]: Running with dbt=1.6.0
[0m14:14:26.252059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m14:14:26.438729 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['sources']: [{'name': 'raw_data', 'database': 'merveyasa', 'schema': 'dbt_merve', 'tables': [{'name': 'raw_stores', 'identifier': 'raw_stores'}, {'name': 'raw_devices', 'identifier': 'raw_devices'}, {'name': 'raw_transactions', 'identifier': 'raw_transactions'}]}] is not of type 'object'

Error encountered in /Users/merveyasa/Desktop/Folder for sumup/dbt_project.yml
[0m14:14:26.439725 [debug] [MainThread]: Command `dbt run` failed at 14:14:26.439529 after 0.24 seconds
[0m14:14:26.440178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0e61d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0dcd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b59290>]}
[0m14:14:26.440646 [debug] [MainThread]: Flushing usage events
[0m14:14:55.492893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f52110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10650be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10650ac90>]}


============================== 14:14:55.500136 | b0715573-93e4-4c20-b502-7d095445b13f ==============================
[0m14:14:55.500136 [info ] [MainThread]: Running with dbt=1.6.0
[0m14:14:55.501017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m raw_devices', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:14:55.588401 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['sources']: [{'name': 'raw_data', 'database': 'merveyasa', 'schema': 'dbt_merve', 'tables': [{'name': 'raw_stores', 'identifier': 'raw_stores'}, {'name': 'raw_devices', 'identifier': 'raw_devices'}, {'name': 'raw_transactions', 'identifier': 'raw_transactions'}]}] is not of type 'object'

Error encountered in /Users/merveyasa/Desktop/Folder for sumup/dbt_project.yml
[0m14:14:55.589349 [debug] [MainThread]: Command `dbt run` failed at 14:14:55.589191 after 0.12 seconds
[0m14:14:55.589772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106515b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f49e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106291890>]}
[0m14:14:55.590211 [debug] [MainThread]: Flushing usage events
[0m14:15:21.035115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba8fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba8e650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10baa4750>]}


============================== 14:15:21.043780 | effe3e5f-81a9-4592-ac71-dd6a22c28554 ==============================
[0m14:15:21.043780 [info ] [MainThread]: Running with dbt=1.6.0
[0m14:15:21.044874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m raw_devices', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:15:21.232100 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['sources']: [{'name': 'raw_data', 'database': 'merveyasa', 'schema': 'dbt_merve', 'tables': [{'name': 'raw_stores', 'identifier': 'raw_stores'}, {'name': 'raw_devices', 'identifier': 'raw_devices'}, {'name': 'raw_transactions', 'identifier': 'raw_transactions'}]}] is not of type 'object'

Error encountered in /Users/merveyasa/Desktop/Folder for sumup/dbt_project.yml
[0m14:15:21.233083 [debug] [MainThread]: Command `dbt run` failed at 14:15:21.232912 after 0.22 seconds
[0m14:15:21.233537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba8e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107055590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdc0310>]}
[0m14:15:21.234015 [debug] [MainThread]: Flushing usage events
[0m14:16:36.734430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107666310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076498d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076772d0>]}


============================== 14:16:36.740862 | 97275bbb-bf81-40e2-93e8-65c9c584fc9f ==============================
[0m14:16:36.740862 [info ] [MainThread]: Running with dbt=1.6.0
[0m14:16:36.741861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'version_check': 'True', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m raw_devices', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:16:36.831818 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['sources']: [{'name': 'raw_data', 'database': 'merveyasa', 'schema': 'public', 'tables': [{'name': 'raw_stores', 'identifier': 'raw_stores'}, {'name': 'raw_devices', 'identifier': 'raw_devices'}, {'name': 'raw_transactions', 'identifier': 'raw_transactions'}]}] is not of type 'object'

Error encountered in /Users/merveyasa/Desktop/Folder for sumup/dbt_project.yml
[0m14:16:36.832773 [debug] [MainThread]: Command `dbt run` failed at 14:16:36.832605 after 0.12 seconds
[0m14:16:36.833244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107983490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107980590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103624490>]}
[0m14:16:36.833720 [debug] [MainThread]: Flushing usage events
[0m15:46:29.385995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae50210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae6ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090db190>]}


============================== 15:46:29.395149 | b456d4f1-8613-445a-a2d8-1e79c83b1129 ==============================
[0m15:46:29.395149 [info ] [MainThread]: Running with dbt=1.6.0
[0m15:46:29.396425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:46:29.512367 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['sources']: [{'name': 'raw_data', 'database': 'merveyasa', 'schema': 'public', 'tables': [{'name': 'stores', 'identifier': 'stores'}, {'name': 'devices', 'identifier': 'devices'}, {'name': 'transactions', 'identifier': 'transactions'}]}] is not of type 'object'

Error encountered in /Users/merveyasa/Desktop/Folder for sumup/dbt_project.yml
[0m15:46:29.513724 [debug] [MainThread]: Command `dbt run` failed at 15:46:29.513129 after 0.18 seconds
[0m15:46:29.514248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abb0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abb3690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae76110>]}
[0m15:46:29.514737 [debug] [MainThread]: Flushing usage events
[0m15:54:57.981597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107127410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e54790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107141950>]}


============================== 15:54:57.990234 | 3528bf2b-eb6f-4694-8538-6d0332be45ce ==============================
[0m15:54:57.990234 [info ] [MainThread]: Running with dbt=1.6.0
[0m15:54:57.991134 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:54:58.153002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3528bf2b-eb6f-4694-8538-6d0332be45ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107142690>]}
[0m15:54:58.163738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3528bf2b-eb6f-4694-8538-6d0332be45ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e75250>]}
[0m15:54:58.164948 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m15:54:58.205415 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m15:54:58.227594 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:54:58.228709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3528bf2b-eb6f-4694-8538-6d0332be45ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e77b90>]}
[0m15:54:59.021843 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_avg_transaction_amount' in the 'models' section of file 'models/result_tables/schema.yml'
[0m15:54:59.023660 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_inc_first_five_transaction' in the 'models' section of file 'models/result_tables/schema.yml'
[0m15:54:59.025576 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_pct_transaction' in the 'models' section of file 'models/result_tables/schema.yml'
[0m15:54:59.027495 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_top_ten_products' in the 'models' section of file 'models/result_tables/schema.yml'
[0m15:54:59.029504 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_top_ten_stores' in the 'models' section of file 'models/result_tables/schema.yml'
[0m15:54:59.244332 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.sumup.raw_stores' (models/raw_data/raw_stores.sql) depends on a source named 'public.stores' which was not found
[0m15:54:59.245464 [debug] [MainThread]: Command `dbt run` failed at 15:54:59.245231 after 1.30 seconds
[0m15:54:59.246319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107427d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107894a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078962d0>]}
[0m15:54:59.246953 [debug] [MainThread]: Flushing usage events
[0m15:55:53.395017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ecf510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149c6d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114be6810>]}


============================== 15:55:53.414928 | 847c77df-d4b4-4359-8e3f-72754527b04b ==============================
[0m15:55:53.414928 [info ] [MainThread]: Running with dbt=1.6.0
[0m15:55:53.416309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:55:53.687910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '847c77df-d4b4-4359-8e3f-72754527b04b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149b2690>]}
[0m15:55:53.702646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '847c77df-d4b4-4359-8e3f-72754527b04b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114bbc210>]}
[0m15:55:53.704147 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m15:55:53.775322 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m15:55:53.821703 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:55:53.822352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '847c77df-d4b4-4359-8e3f-72754527b04b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114855b10>]}
[0m15:55:55.118064 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.sumup.raw_stores' (models/raw_data/raw_stores.sql) depends on a source named 'public.stores' which was not found
[0m15:55:55.119135 [debug] [MainThread]: Command `dbt run` failed at 15:55:55.118951 after 1.78 seconds
[0m15:55:55.119656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ecf290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ca1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11533ca50>]}
[0m15:55:55.120172 [debug] [MainThread]: Flushing usage events
[0m16:00:36.224459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de9da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1606d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dec11d0>]}


============================== 16:00:36.232211 | 5500c622-cac4-4adc-a2e2-478d707eca37 ==============================
[0m16:00:36.232211 [info ] [MainThread]: Running with dbt=1.6.0
[0m16:00:36.233199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'debug': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m16:00:36.363375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5500c622-cac4-4adc-a2e2-478d707eca37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e16bf90>]}
[0m16:00:36.372404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5500c622-cac4-4adc-a2e2-478d707eca37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10deefd50>]}
[0m16:00:36.374049 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m16:00:36.408947 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m16:00:36.431773 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:00:36.432475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5500c622-cac4-4adc-a2e2-478d707eca37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e481ad0>]}
[0m16:00:37.413318 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.sumup.fact_store_transaction_view' (models/fact/fact_store_transaction_view.sql) depends on a source named 'raw_data.raw_transactions' which was not found
[0m16:00:37.414626 [debug] [MainThread]: Command `dbt run` failed at 16:00:37.414360 after 1.23 seconds
[0m16:00:37.415326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10def8710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e473c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109780a90>]}
[0m16:00:37.415998 [debug] [MainThread]: Flushing usage events
[0m16:01:57.264873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc5f390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc73ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc73210>]}


============================== 16:01:57.274998 | 83842a41-ad35-46be-bb9d-2b51cd8f346c ==============================
[0m16:01:57.274998 [info ] [MainThread]: Running with dbt=1.6.0
[0m16:01:57.276113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:01:57.424064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83842a41-ad35-46be-bb9d-2b51cd8f346c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6b1fd0>]}
[0m16:01:57.433551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83842a41-ad35-46be-bb9d-2b51cd8f346c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c746e10>]}
[0m16:01:57.435202 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m16:01:57.474078 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m16:01:57.503974 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:01:57.505033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '83842a41-ad35-46be-bb9d-2b51cd8f346c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6c8d90>]}
[0m16:01:58.476173 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.sumup.fact_store_transaction_view' (models/fact/fact_store_transaction_view.sql) depends on a source named 'raw_data.raw_transactions' which was not found
[0m16:01:58.477437 [debug] [MainThread]: Command `dbt run` failed at 16:01:58.477209 after 1.25 seconds
[0m16:01:58.478139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc692d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf5d4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf5d890>]}
[0m16:01:58.478812 [debug] [MainThread]: Flushing usage events
[0m16:02:51.613183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fac8790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110063410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fab3ad0>]}


============================== 16:02:51.618502 | 64d6934e-878f-4a90-8cb2-16a33a70cff3 ==============================
[0m16:02:51.618502 [info ] [MainThread]: Running with dbt=1.6.0
[0m16:02:51.619282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:02:51.708563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64d6934e-878f-4a90-8cb2-16a33a70cff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fde4f90>]}
[0m16:02:51.717295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64d6934e-878f-4a90-8cb2-16a33a70cff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11006ff50>]}
[0m16:02:51.717976 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m16:02:51.742345 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m16:02:51.760445 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:02:51.761462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '64d6934e-878f-4a90-8cb2-16a33a70cff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110492c50>]}
[0m16:02:52.725846 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 14 unused configuration paths:
- models.my_project.raw_data.raw_transactions
- models.my_project.result_tables.inc_first_five_transaction
- models.my_project.raw_data.raw_stores
- models.my_project.result_tables.avg_transaction_amount
- models.my_project.result_tables.pct_transaction
- models.my_project.result_tables.top_ten_stores
- models.my_project.raw_data.raw_devices
- models.my_project.fact.fact_store_transaction_view
- models.my_project.fact.fact_store_transaction_first
- models.my_project.result_tables
- models.my_project.fact.fact_product_agg
- models.my_project.fact
- models.my_project.result_tables.top_ten_products
- models.my_project.raw_data
[0m16:02:52.733769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64d6934e-878f-4a90-8cb2-16a33a70cff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110459b50>]}
[0m16:02:52.782131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64d6934e-878f-4a90-8cb2-16a33a70cff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a0f550>]}
[0m16:02:52.782862 [info ] [MainThread]: Found 11 models, 34 tests, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m16:02:52.783341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64d6934e-878f-4a90-8cb2-16a33a70cff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11041c590>]}
[0m16:02:52.785941 [info ] [MainThread]: 
[0m16:02:52.787050 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:02:52.789984 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m16:02:52.804383 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m16:02:52.804951 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m16:02:52.805447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:52.898901 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:02:52.900713 [debug] [ThreadPool]: On list_merveyasa: Close
[0m16:02:52.903193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m16:02:52.910057 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m16:02:52.910471 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m16:02:52.910798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:02:52.917836 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:02:52.918343 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m16:02:52.918809 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m16:02:52.922886 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:02:52.924214 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m16:02:52.924697 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m16:02:52.929637 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:52.930046 [debug] [MainThread]: On master: BEGIN
[0m16:02:52.930371 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:02:52.936531 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:02:52.936937 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:52.937376 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:02:52.947156 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:02:52.948430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64d6934e-878f-4a90-8cb2-16a33a70cff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103aea90>]}
[0m16:02:52.948940 [debug] [MainThread]: On master: ROLLBACK
[0m16:02:52.949421 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:52.949760 [debug] [MainThread]: On master: BEGIN
[0m16:02:52.950373 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:02:52.950740 [debug] [MainThread]: On master: COMMIT
[0m16:02:52.951081 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:52.951407 [debug] [MainThread]: On master: COMMIT
[0m16:02:52.951838 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:02:52.952185 [debug] [MainThread]: On master: Close
[0m16:02:52.952997 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:02:52.953426 [info ] [MainThread]: 
[0m16:02:52.956489 [debug] [Thread-1 (]: Began running node model.sumup.raw_devices
[0m16:02:52.957092 [info ] [Thread-1 (]: 1 of 11 START sql incremental model dbt_merve.raw_devices ...................... [RUN]
[0m16:02:52.957878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.raw_devices)
[0m16:02:52.958329 [debug] [Thread-1 (]: Began compiling node model.sumup.raw_devices
[0m16:02:52.969029 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.raw_devices"
[0m16:02:52.970252 [debug] [Thread-1 (]: Timing info for model.sumup.raw_devices (compile): 16:02:52.958630 => 16:02:52.969960
[0m16:02:52.970741 [debug] [Thread-1 (]: Began executing node model.sumup.raw_devices
[0m16:02:53.045363 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.raw_devices"
[0m16:02:53.046506 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_devices"
[0m16:02:53.046979 [debug] [Thread-1 (]: On model.sumup.raw_devices: BEGIN
[0m16:02:53.047360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:53.053373 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:02:53.053850 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_devices"
[0m16:02:53.054271 [debug] [Thread-1 (]: On model.sumup.raw_devices: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.raw_devices"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."raw_devices"
  
  
    as
  
  (
    

SELECT 
    metadata_timestamp,
    device_id, 
    device_type, 
    store_id
FROM "merveyasa"."public"."devices"
WHERE metadata_timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa"."dbt_merve"."raw_devices")
  );
  
  
[0m16:02:53.055508 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbt_merve.raw_devices" does not exist
LINE 21: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
                                                              ^

[0m16:02:53.055959 [debug] [Thread-1 (]: On model.sumup.raw_devices: ROLLBACK
[0m16:02:53.056849 [debug] [Thread-1 (]: Timing info for model.sumup.raw_devices (execute): 16:02:52.971098 => 16:02:53.056546
[0m16:02:53.057348 [debug] [Thread-1 (]: On model.sumup.raw_devices: Close
[0m16:02:53.105891 [debug] [Thread-1 (]: Database Error in model raw_devices (models/raw_data/raw_devices.sql)
  relation "dbt_merve.raw_devices" does not exist
  LINE 21: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
                                                                ^
  compiled Code at target/run/sumup/models/raw_data/raw_devices.sql
[0m16:02:53.107188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64d6934e-878f-4a90-8cb2-16a33a70cff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110482910>]}
[0m16:02:53.108254 [error] [Thread-1 (]: 1 of 11 ERROR creating sql incremental model dbt_merve.raw_devices ............. [[31mERROR[0m in 0.15s]
[0m16:02:53.109355 [debug] [Thread-1 (]: Finished running node model.sumup.raw_devices
[0m16:02:53.110058 [debug] [Thread-1 (]: Began running node model.sumup.raw_stores
[0m16:02:53.111066 [info ] [Thread-1 (]: 2 of 11 START sql incremental model dbt_merve.raw_stores ....................... [RUN]
[0m16:02:53.112090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.raw_devices, now model.sumup.raw_stores)
[0m16:02:53.112665 [debug] [Thread-1 (]: Began compiling node model.sumup.raw_stores
[0m16:02:53.116318 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.raw_stores"
[0m16:02:53.117548 [debug] [Thread-1 (]: Timing info for model.sumup.raw_stores (compile): 16:02:53.113033 => 16:02:53.117261
[0m16:02:53.117999 [debug] [Thread-1 (]: Began executing node model.sumup.raw_stores
[0m16:02:53.127002 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.raw_stores"
[0m16:02:53.128322 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_stores"
[0m16:02:53.128732 [debug] [Thread-1 (]: On model.sumup.raw_stores: BEGIN
[0m16:02:53.129084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:53.135314 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:02:53.135748 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_stores"
[0m16:02:53.136135 [debug] [Thread-1 (]: On model.sumup.raw_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.raw_stores"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."raw_stores"
  
  
    as
  
  (
    

SELECT 
    metadata_timestamp,
    store_id, 
    store_name, 
    store_address, 
    REGEXP_REPLACE(store_city, '[^a-zA-Z\s]', '', 'g') as store_city, 
    store_country, 
    store_created_at, 
    store_typology, 
    customer_id
	FROM "merveyasa"."public"."stores"
WHERE metadata_timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa"."dbt_merve"."raw_stores")
  );
  
  
[0m16:02:53.137391 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbt_merve.raw_stores" does not exist
LINE 26: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
                                                              ^

[0m16:02:53.137851 [debug] [Thread-1 (]: On model.sumup.raw_stores: ROLLBACK
[0m16:02:53.138813 [debug] [Thread-1 (]: Timing info for model.sumup.raw_stores (execute): 16:02:53.118286 => 16:02:53.138429
[0m16:02:53.139723 [debug] [Thread-1 (]: On model.sumup.raw_stores: Close
[0m16:02:53.144868 [debug] [Thread-1 (]: Database Error in model raw_stores (models/raw_data/raw_stores.sql)
  relation "dbt_merve.raw_stores" does not exist
  LINE 26: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
                                                                ^
  compiled Code at target/run/sumup/models/raw_data/raw_stores.sql
[0m16:02:53.145428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64d6934e-878f-4a90-8cb2-16a33a70cff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110480490>]}
[0m16:02:53.146015 [error] [Thread-1 (]: 2 of 11 ERROR creating sql incremental model dbt_merve.raw_stores .............. [[31mERROR[0m in 0.03s]
[0m16:02:53.146827 [debug] [Thread-1 (]: Finished running node model.sumup.raw_stores
[0m16:02:53.147329 [debug] [Thread-1 (]: Began running node model.sumup.raw_transactions
[0m16:02:53.148230 [info ] [Thread-1 (]: 3 of 11 START sql incremental model dbt_merve.raw_transactions ................. [RUN]
[0m16:02:53.149472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.raw_stores, now model.sumup.raw_transactions)
[0m16:02:53.149883 [debug] [Thread-1 (]: Began compiling node model.sumup.raw_transactions
[0m16:02:53.153572 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.raw_transactions"
[0m16:02:53.154770 [debug] [Thread-1 (]: Timing info for model.sumup.raw_transactions (compile): 16:02:53.150142 => 16:02:53.154331
[0m16:02:53.155345 [debug] [Thread-1 (]: Began executing node model.sumup.raw_transactions
[0m16:02:53.161827 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.raw_transactions"
[0m16:02:53.163569 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_transactions"
[0m16:02:53.164253 [debug] [Thread-1 (]: On model.sumup.raw_transactions: BEGIN
[0m16:02:53.165143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:53.173028 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:02:53.173524 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_transactions"
[0m16:02:53.173948 [debug] [Thread-1 (]: On model.sumup.raw_transactions: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.raw_transactions"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."raw_transactions"
  
  
    as
  
  (
    

SELECT 
    metadata_timestamp,
    transaction_id, 
    device_id, 
    LOWER(REGEXP_REPLACE(product_name, '[^a-zA-Z\s]+', '', 'g')) as product_name, 
    (CASE 
            WHEN product_sku ~ E'^\\d+\\.\\d+E\\+\\d+$' 
            THEN LTRIM(TO_CHAR(CAST(product_sku AS DOUBLE PRECISION), '9999999999999999999999999'))
            ELSE product_sku
        END) as product_sku, 
    LOWER(REGEXP_REPLACE(category_name, '[^a-zA-Z\s]+', '', 'g')) as category_name, 
    transaction_amount, 
    transaction_status, 
    CASE 
        WHEN card_number ~ E'^\\d+\\.\\d+E\\+\\d+$' THEN 
            LTRIM(TO_CHAR(CAST(card_number AS DOUBLE PRECISION), '9999999999999999999'))
        ELSE 
            REPLACE(card_number, ' ', '') 
    END as card_number, 
    cvv, 
    transaction_created_at, 
    transaction_happened_at
	FROM "merveyasa"."public"."transactions"
WHERE metadata_timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa"."dbt_merve"."raw_transactions")
  );
  
  
[0m16:02:53.175974 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dbt_merve.raw_transactions" does not exist
LINE 38: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
                                                              ^

[0m16:02:53.176478 [debug] [Thread-1 (]: On model.sumup.raw_transactions: ROLLBACK
[0m16:02:53.178148 [debug] [Thread-1 (]: Timing info for model.sumup.raw_transactions (execute): 16:02:53.155878 => 16:02:53.177781
[0m16:02:53.178963 [debug] [Thread-1 (]: On model.sumup.raw_transactions: Close
[0m16:02:53.182001 [debug] [Thread-1 (]: Database Error in model raw_transactions (models/raw_data/raw_transactions.sql)
  relation "dbt_merve.raw_transactions" does not exist
  LINE 38: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
                                                                ^
  compiled Code at target/run/sumup/models/raw_data/raw_transactions.sql
[0m16:02:53.182619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64d6934e-878f-4a90-8cb2-16a33a70cff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104e3850>]}
[0m16:02:53.183203 [error] [Thread-1 (]: 3 of 11 ERROR creating sql incremental model dbt_merve.raw_transactions ........ [[31mERROR[0m in 0.03s]
[0m16:02:53.184071 [debug] [Thread-1 (]: Finished running node model.sumup.raw_transactions
[0m16:02:53.186092 [debug] [Thread-1 (]: Began running node model.sumup.fact_product_agg
[0m16:02:53.186573 [info ] [Thread-1 (]: 4 of 11 SKIP relation dbt_merve.fact_product_agg ............................... [[33mSKIP[0m]
[0m16:02:53.187307 [debug] [Thread-1 (]: Finished running node model.sumup.fact_product_agg
[0m16:02:53.187840 [debug] [Thread-1 (]: Began running node model.sumup.fact_store_transaction_view
[0m16:02:53.189127 [info ] [Thread-1 (]: 5 of 11 SKIP relation dbt_merve.fact_store_transaction_view .................... [[33mSKIP[0m]
[0m16:02:53.190328 [debug] [Thread-1 (]: Finished running node model.sumup.fact_store_transaction_view
[0m16:02:53.191161 [debug] [Thread-1 (]: Began running node model.sumup.top_ten_products
[0m16:02:53.193080 [info ] [Thread-1 (]: 6 of 11 SKIP relation dbt_merve.top_ten_products ............................... [[33mSKIP[0m]
[0m16:02:53.193973 [debug] [Thread-1 (]: Finished running node model.sumup.top_ten_products
[0m16:02:53.194552 [debug] [Thread-1 (]: Began running node model.sumup.avg_transaction_amount
[0m16:02:53.197883 [info ] [Thread-1 (]: 7 of 11 SKIP relation dbt_merve.avg_transaction_amount ......................... [[33mSKIP[0m]
[0m16:02:53.199578 [debug] [Thread-1 (]: Finished running node model.sumup.avg_transaction_amount
[0m16:02:53.200584 [debug] [Thread-1 (]: Began running node model.sumup.fact_store_transaction_first
[0m16:02:53.201585 [info ] [Thread-1 (]: 8 of 11 SKIP relation dbt_merve.fact_store_transaction_first ................... [[33mSKIP[0m]
[0m16:02:53.202624 [debug] [Thread-1 (]: Finished running node model.sumup.fact_store_transaction_first
[0m16:02:53.203203 [debug] [Thread-1 (]: Began running node model.sumup.pct_transaction
[0m16:02:53.204287 [info ] [Thread-1 (]: 9 of 11 SKIP relation dbt_merve.pct_transaction ................................ [[33mSKIP[0m]
[0m16:02:53.206917 [debug] [Thread-1 (]: Finished running node model.sumup.pct_transaction
[0m16:02:53.207755 [debug] [Thread-1 (]: Began running node model.sumup.top_ten_stores
[0m16:02:53.209682 [info ] [Thread-1 (]: 10 of 11 SKIP relation dbt_merve.top_ten_stores ................................ [[33mSKIP[0m]
[0m16:02:53.211057 [debug] [Thread-1 (]: Finished running node model.sumup.top_ten_stores
[0m16:02:53.211634 [debug] [Thread-1 (]: Began running node model.sumup.inc_first_five_transaction
[0m16:02:53.212589 [info ] [Thread-1 (]: 11 of 11 SKIP relation dbt_merve.inc_first_five_transaction .................... [[33mSKIP[0m]
[0m16:02:53.213660 [debug] [Thread-1 (]: Finished running node model.sumup.inc_first_five_transaction
[0m16:02:53.221870 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:53.222638 [debug] [MainThread]: On master: BEGIN
[0m16:02:53.223204 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:02:53.237053 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:02:53.237868 [debug] [MainThread]: On master: COMMIT
[0m16:02:53.238388 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:53.238949 [debug] [MainThread]: On master: COMMIT
[0m16:02:53.239760 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:02:53.240679 [debug] [MainThread]: On master: Close
[0m16:02:53.242052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:53.242650 [debug] [MainThread]: Connection 'model.sumup.raw_transactions' was properly closed.
[0m16:02:53.243243 [info ] [MainThread]: 
[0m16:02:53.243877 [info ] [MainThread]: Finished running 9 incremental models, 2 table models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m16:02:53.246564 [debug] [MainThread]: Command end result
[0m16:02:53.273492 [info ] [MainThread]: 
[0m16:02:53.275205 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m16:02:53.276703 [info ] [MainThread]: 
[0m16:02:53.277674 [error] [MainThread]: [33mDatabase Error in model raw_devices (models/raw_data/raw_devices.sql)[0m
[0m16:02:53.278815 [error] [MainThread]:   relation "dbt_merve.raw_devices" does not exist
[0m16:02:53.280613 [error] [MainThread]:   LINE 21: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
[0m16:02:53.282926 [error] [MainThread]:                                                                 ^
[0m16:02:53.283762 [error] [MainThread]:   compiled Code at target/run/sumup/models/raw_data/raw_devices.sql
[0m16:02:53.284532 [info ] [MainThread]: 
[0m16:02:53.285564 [error] [MainThread]: [33mDatabase Error in model raw_stores (models/raw_data/raw_stores.sql)[0m
[0m16:02:53.286489 [error] [MainThread]:   relation "dbt_merve.raw_stores" does not exist
[0m16:02:53.288012 [error] [MainThread]:   LINE 26: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
[0m16:02:53.288789 [error] [MainThread]:                                                                 ^
[0m16:02:53.290651 [error] [MainThread]:   compiled Code at target/run/sumup/models/raw_data/raw_stores.sql
[0m16:02:53.291832 [info ] [MainThread]: 
[0m16:02:53.292666 [error] [MainThread]: [33mDatabase Error in model raw_transactions (models/raw_data/raw_transactions.sql)[0m
[0m16:02:53.293296 [error] [MainThread]:   relation "dbt_merve.raw_transactions" does not exist
[0m16:02:53.294000 [error] [MainThread]:   LINE 38: ..._timestamp > (SELECT max(metadata_timestamp) FROM "merveyasa...
[0m16:02:53.295556 [error] [MainThread]:                                                                 ^
[0m16:02:53.298257 [error] [MainThread]:   compiled Code at target/run/sumup/models/raw_data/raw_transactions.sql
[0m16:02:53.300630 [info ] [MainThread]: 
[0m16:02:53.301834 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=8 TOTAL=11
[0m16:02:53.303593 [debug] [MainThread]: Command `dbt run` failed at 16:02:53.302935 after 1.71 seconds
[0m16:02:53.304635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9e5810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3cc550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3cc650>]}
[0m16:02:53.307486 [debug] [MainThread]: Flushing usage events
[0m16:10:46.171843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10772ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077424d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f7210>]}


============================== 16:10:46.179383 | b5da59ff-0e61-4d16-a7f6-a4a20a6d485e ==============================
[0m16:10:46.179383 [info ] [MainThread]: Running with dbt=1.6.0
[0m16:10:46.180247 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:10:46.400849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5da59ff-0e61-4d16-a7f6-a4a20a6d485e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ad850>]}
[0m16:10:46.410973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5da59ff-0e61-4d16-a7f6-a4a20a6d485e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ad950>]}
[0m16:10:46.412214 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m16:10:46.445828 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m16:10:46.539146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m16:10:46.540305 [debug] [MainThread]: Partial parsing: updated file: sumup://models/raw_data/raw_transactions.sql
[0m16:10:46.540836 [debug] [MainThread]: Partial parsing: updated file: sumup://models/raw_data/raw_devices.sql
[0m16:10:46.541321 [debug] [MainThread]: Partial parsing: updated file: sumup://models/raw_data/raw_stores.sql
[0m16:10:46.653622 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 14 unused configuration paths:
- models.my_project.fact
- models.my_project.result_tables.inc_first_five_transaction
- models.my_project.raw_data.raw_devices
- models.my_project.raw_data.raw_stores
- models.my_project.result_tables.pct_transaction
- models.my_project.result_tables
- models.my_project.result_tables.top_ten_products
- models.my_project.fact.fact_product_agg
- models.my_project.result_tables.top_ten_stores
- models.my_project.result_tables.avg_transaction_amount
- models.my_project.fact.fact_store_transaction_view
- models.my_project.raw_data
- models.my_project.fact.fact_store_transaction_first
- models.my_project.raw_data.raw_transactions
[0m16:10:46.660544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5da59ff-0e61-4d16-a7f6-a4a20a6d485e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10811de90>]}
[0m16:10:46.687763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5da59ff-0e61-4d16-a7f6-a4a20a6d485e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10802ed10>]}
[0m16:10:46.688785 [info ] [MainThread]: Found 11 models, 34 tests, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m16:10:46.689907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5da59ff-0e61-4d16-a7f6-a4a20a6d485e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079deb10>]}
[0m16:10:46.694602 [info ] [MainThread]: 
[0m16:10:46.697317 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:10:46.700472 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m16:10:46.718185 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m16:10:46.718773 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m16:10:46.719388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:46.831705 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:10:46.834140 [debug] [ThreadPool]: On list_merveyasa: Close
[0m16:10:46.836425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m16:10:46.842642 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m16:10:46.843089 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m16:10:46.843516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:46.857046 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:10:46.858001 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m16:10:46.858861 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m16:10:46.866678 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:10:46.868320 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m16:10:46.868907 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m16:10:46.874845 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:46.875322 [debug] [MainThread]: On master: BEGIN
[0m16:10:46.875704 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:10:46.882369 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:10:46.882899 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:46.883427 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:10:46.894475 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:10:46.895904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5da59ff-0e61-4d16-a7f6-a4a20a6d485e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ff6ad0>]}
[0m16:10:46.896513 [debug] [MainThread]: On master: ROLLBACK
[0m16:10:46.897103 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:46.897500 [debug] [MainThread]: On master: BEGIN
[0m16:10:46.898125 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:10:46.898549 [debug] [MainThread]: On master: COMMIT
[0m16:10:46.898938 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:46.899310 [debug] [MainThread]: On master: COMMIT
[0m16:10:46.899802 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:10:46.900185 [debug] [MainThread]: On master: Close
[0m16:10:46.901043 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:10:46.901504 [info ] [MainThread]: 
[0m16:10:46.904881 [debug] [Thread-1 (]: Began running node model.sumup.raw_devices
[0m16:10:46.905541 [info ] [Thread-1 (]: 1 of 11 START sql incremental model dbt_merve.raw_devices ...................... [RUN]
[0m16:10:46.906580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.raw_devices)
[0m16:10:46.907188 [debug] [Thread-1 (]: Began compiling node model.sumup.raw_devices
[0m16:10:46.920404 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.raw_devices"
[0m16:10:46.921664 [debug] [Thread-1 (]: Timing info for model.sumup.raw_devices (compile): 16:10:46.907593 => 16:10:46.921260
[0m16:10:46.922344 [debug] [Thread-1 (]: Began executing node model.sumup.raw_devices
[0m16:10:46.997565 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.raw_devices"
[0m16:10:47.000346 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_devices"
[0m16:10:47.001034 [debug] [Thread-1 (]: On model.sumup.raw_devices: BEGIN
[0m16:10:47.001467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:47.008089 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:10:47.008612 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_devices"
[0m16:10:47.009077 [debug] [Thread-1 (]: On model.sumup.raw_devices: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.raw_devices"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."raw_devices"
  
  
    as
  
  (
    

WITH code AS (
    SELECT 
    metadata_timestamp,
    device_id, 
    device_type, 
    store_id
FROM "merveyasa"."public"."devices"
)


  SELECT * FROM code

  );
  
  
[0m16:10:47.016880 [debug] [Thread-1 (]: SQL status: SELECT 200 in 0.0 seconds
[0m16:10:47.037778 [debug] [Thread-1 (]: On model.sumup.raw_devices: COMMIT
[0m16:10:47.038371 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_devices"
[0m16:10:47.038795 [debug] [Thread-1 (]: On model.sumup.raw_devices: COMMIT
[0m16:10:47.040099 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:10:47.047012 [debug] [Thread-1 (]: Timing info for model.sumup.raw_devices (execute): 16:10:46.923055 => 16:10:47.046471
[0m16:10:47.048059 [debug] [Thread-1 (]: On model.sumup.raw_devices: Close
[0m16:10:47.050336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5da59ff-0e61-4d16-a7f6-a4a20a6d485e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a68f50>]}
[0m16:10:47.051625 [info ] [Thread-1 (]: 1 of 11 OK created sql incremental model dbt_merve.raw_devices ................. [[32mSELECT 200[0m in 0.14s]
[0m16:10:47.052682 [debug] [Thread-1 (]: Finished running node model.sumup.raw_devices
[0m16:10:47.053280 [debug] [Thread-1 (]: Began running node model.sumup.raw_stores
[0m16:10:47.054266 [info ] [Thread-1 (]: 2 of 11 START sql incremental model dbt_merve.raw_stores ....................... [RUN]
[0m16:10:47.055390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.raw_devices, now model.sumup.raw_stores)
[0m16:10:47.055970 [debug] [Thread-1 (]: Began compiling node model.sumup.raw_stores
[0m16:10:47.060706 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.raw_stores"
[0m16:10:47.062093 [debug] [Thread-1 (]: Timing info for model.sumup.raw_stores (compile): 16:10:47.056310 => 16:10:47.061725
[0m16:10:47.062775 [debug] [Thread-1 (]: Began executing node model.sumup.raw_stores
[0m16:10:47.070903 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.raw_stores"
[0m16:10:47.072066 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_stores"
[0m16:10:47.072770 [debug] [Thread-1 (]: On model.sumup.raw_stores: BEGIN
[0m16:10:47.073621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:47.088696 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:10:47.089948 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_stores"
[0m16:10:47.090606 [debug] [Thread-1 (]: On model.sumup.raw_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.raw_stores"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."raw_stores"
  
  
    as
  
  (
    

WITH code as (
    SELECT 
    metadata_timestamp,
    store_id, 
    store_name, 
    store_address, 
    REGEXP_REPLACE(store_city, '[^a-zA-Z\s]', '', 'g') as store_city, 
    store_country, 
    store_created_at, 
    store_typology, 
    customer_id
	FROM "merveyasa"."public"."stores"
)


  SELECT * FROM code

  );
  
  
[0m16:10:47.100650 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m16:10:47.104743 [debug] [Thread-1 (]: On model.sumup.raw_stores: COMMIT
[0m16:10:47.105556 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_stores"
[0m16:10:47.106504 [debug] [Thread-1 (]: On model.sumup.raw_stores: COMMIT
[0m16:10:47.108622 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:10:47.110270 [debug] [Thread-1 (]: Timing info for model.sumup.raw_stores (execute): 16:10:47.063206 => 16:10:47.109981
[0m16:10:47.110743 [debug] [Thread-1 (]: On model.sumup.raw_stores: Close
[0m16:10:47.111804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5da59ff-0e61-4d16-a7f6-a4a20a6d485e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d85d0>]}
[0m16:10:47.112684 [info ] [Thread-1 (]: 2 of 11 OK created sql incremental model dbt_merve.raw_stores .................. [[32mSELECT 100[0m in 0.06s]
[0m16:10:47.113875 [debug] [Thread-1 (]: Finished running node model.sumup.raw_stores
[0m16:10:47.114679 [debug] [Thread-1 (]: Began running node model.sumup.raw_transactions
[0m16:10:47.115676 [info ] [Thread-1 (]: 3 of 11 START sql incremental model dbt_merve.raw_transactions ................. [RUN]
[0m16:10:47.116539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.raw_stores, now model.sumup.raw_transactions)
[0m16:10:47.116975 [debug] [Thread-1 (]: Began compiling node model.sumup.raw_transactions
[0m16:10:47.121699 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.raw_transactions"
[0m16:10:47.122980 [debug] [Thread-1 (]: Timing info for model.sumup.raw_transactions (compile): 16:10:47.117376 => 16:10:47.122671
[0m16:10:47.123477 [debug] [Thread-1 (]: Began executing node model.sumup.raw_transactions
[0m16:10:47.129307 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.raw_transactions"
[0m16:10:47.130358 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_transactions"
[0m16:10:47.131048 [debug] [Thread-1 (]: On model.sumup.raw_transactions: BEGIN
[0m16:10:47.131776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:47.139862 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:10:47.140371 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_transactions"
[0m16:10:47.140838 [debug] [Thread-1 (]: On model.sumup.raw_transactions: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.raw_transactions"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."raw_transactions"
  
  
    as
  
  (
    

WITH code as 
(
    SELECT 
    metadata_timestamp,
    transaction_id, 
    device_id, 
    LOWER(REGEXP_REPLACE(product_name, '[^a-zA-Z\s]+', '', 'g')) as product_name, 
    (CASE 
            WHEN product_sku ~ E'^\\d+\\.\\d+E\\+\\d+$' 
            THEN LTRIM(TO_CHAR(CAST(product_sku AS DOUBLE PRECISION), '9999999999999999999999999'))
            ELSE product_sku
        END) as product_sku, 
    LOWER(REGEXP_REPLACE(category_name, '[^a-zA-Z\s]+', '', 'g')) as category_name, 
    transaction_amount, 
    transaction_status, 
    CASE 
        WHEN card_number ~ E'^\\d+\\.\\d+E\\+\\d+$' THEN 
            LTRIM(TO_CHAR(CAST(card_number AS DOUBLE PRECISION), '9999999999999999999'))
        ELSE 
            REPLACE(card_number, ' ', '') 
    END as card_number, 
    cvv, 
    transaction_created_at, 
    transaction_happened_at
	FROM "merveyasa"."public"."transactions"

)


  SELECT * FROM code

  );
  
  
[0m16:10:47.163412 [debug] [Thread-1 (]: SQL status: SELECT 1500 in 0.0 seconds
[0m16:10:47.167721 [debug] [Thread-1 (]: On model.sumup.raw_transactions: COMMIT
[0m16:10:47.168562 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_transactions"
[0m16:10:47.169363 [debug] [Thread-1 (]: On model.sumup.raw_transactions: COMMIT
[0m16:10:47.171372 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:10:47.173866 [debug] [Thread-1 (]: Timing info for model.sumup.raw_transactions (execute): 16:10:47.123828 => 16:10:47.173360
[0m16:10:47.174734 [debug] [Thread-1 (]: On model.sumup.raw_transactions: Close
[0m16:10:47.176414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5da59ff-0e61-4d16-a7f6-a4a20a6d485e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108745b90>]}
[0m16:10:47.177232 [info ] [Thread-1 (]: 3 of 11 OK created sql incremental model dbt_merve.raw_transactions ............ [[32mSELECT 1500[0m in 0.06s]
[0m16:10:47.178495 [debug] [Thread-1 (]: Finished running node model.sumup.raw_transactions
[0m16:10:47.181045 [debug] [Thread-1 (]: Began running node model.sumup.fact_product_agg
[0m16:10:47.182071 [info ] [Thread-1 (]: 4 of 11 START sql incremental model dbt_merve.fact_product_agg ................. [RUN]
[0m16:10:47.183263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.raw_transactions, now model.sumup.fact_product_agg)
[0m16:10:47.183898 [debug] [Thread-1 (]: Began compiling node model.sumup.fact_product_agg
[0m16:10:47.190941 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.fact_product_agg"
[0m16:10:47.195452 [debug] [Thread-1 (]: Timing info for model.sumup.fact_product_agg (compile): 16:10:47.184261 => 16:10:47.194889
[0m16:10:47.196310 [debug] [Thread-1 (]: Began executing node model.sumup.fact_product_agg
[0m16:10:47.207729 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.fact_product_agg"
[0m16:10:47.209769 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_product_agg"
[0m16:10:47.210725 [debug] [Thread-1 (]: On model.sumup.fact_product_agg: BEGIN
[0m16:10:47.211521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:47.230599 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:10:47.231664 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_product_agg"
[0m16:10:47.232693 [debug] [Thread-1 (]: On model.sumup.fact_product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.fact_product_agg"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."fact_product_agg"
  
  
    as
  
  (
    


    SELECT
        product_name,
        product_sku,
        COUNT(*) AS transactions_count,
        SUM(transaction_amount) AS total_transaction_amount,
        MAX(metadata_timestamp) AS metadata_timestamp 
    FROM
        "merveyasa"."dbt_merve"."raw_transactions"
    WHERE
        transaction_status = 'accepted'
    GROUP BY
        product_name, product_sku

  );
  
  
[0m16:10:47.248128 [debug] [Thread-1 (]: SQL status: SELECT 407 in 0.0 seconds
[0m16:10:47.250987 [debug] [Thread-1 (]: On model.sumup.fact_product_agg: COMMIT
[0m16:10:47.251543 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_product_agg"
[0m16:10:47.252220 [debug] [Thread-1 (]: On model.sumup.fact_product_agg: COMMIT
[0m16:10:47.254132 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:10:47.256525 [debug] [Thread-1 (]: Timing info for model.sumup.fact_product_agg (execute): 16:10:47.196992 => 16:10:47.255743
[0m16:10:47.257464 [debug] [Thread-1 (]: On model.sumup.fact_product_agg: Close
[0m16:10:47.259577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5da59ff-0e61-4d16-a7f6-a4a20a6d485e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108783f10>]}
[0m16:10:47.260500 [info ] [Thread-1 (]: 4 of 11 OK created sql incremental model dbt_merve.fact_product_agg ............ [[32mSELECT 407[0m in 0.08s]
[0m16:10:47.261738 [debug] [Thread-1 (]: Finished running node model.sumup.fact_product_agg
[0m16:10:47.262406 [debug] [Thread-1 (]: Began running node model.sumup.fact_store_transaction_view
[0m16:10:47.262983 [info ] [Thread-1 (]: 5 of 11 START sql incremental model dbt_merve.fact_store_transaction_view ...... [RUN]
[0m16:10:47.265219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.fact_product_agg, now model.sumup.fact_store_transaction_view)
[0m16:10:47.267077 [debug] [Thread-1 (]: Began compiling node model.sumup.fact_store_transaction_view
[0m16:10:47.278845 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.fact_store_transaction_view"
[0m16:10:47.280180 [debug] [Thread-1 (]: Timing info for model.sumup.fact_store_transaction_view (compile): 16:10:47.267873 => 16:10:47.279723
[0m16:10:47.280700 [debug] [Thread-1 (]: Began executing node model.sumup.fact_store_transaction_view
[0m16:10:47.294880 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.fact_store_transaction_view"
[0m16:10:47.296716 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_store_transaction_view"
[0m16:10:47.297602 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_view: BEGIN
[0m16:10:47.298440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:47.309409 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:10:47.311652 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_store_transaction_view"
[0m16:10:47.312697 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.fact_store_transaction_view"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."fact_store_transaction_view"
  
  
    as
  
  (
    



    WITH store_transactions AS
    (
        SELECT
            t.metadata_timestamp,
            s.store_id,
            s.store_typology,
            s.store_country,
            t.product_name,
            t.product_sku,
            t.category_name,
            t.transaction_amount,
            t.transaction_status,
            t.transaction_happened_at,
            d.device_type
        FROM
            "merveyasa"."dbt_merve"."raw_transactions" t
        JOIN "merveyasa"."dbt_merve"."raw_devices" d ON t.device_id = d.device_id
        JOIN "merveyasa"."dbt_merve"."raw_stores" s ON d.store_id = s.store_id
    )
    select * from store_transactions

  );
  
  
[0m16:10:47.329229 [debug] [Thread-1 (]: SQL status: SELECT 1500 in 0.0 seconds
[0m16:10:47.333983 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_view: COMMIT
[0m16:10:47.334837 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_store_transaction_view"
[0m16:10:47.335625 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_view: COMMIT
[0m16:10:47.337487 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:10:47.339602 [debug] [Thread-1 (]: Timing info for model.sumup.fact_store_transaction_view (execute): 16:10:47.281039 => 16:10:47.339161
[0m16:10:47.340457 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_view: Close
[0m16:10:47.342316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5da59ff-0e61-4d16-a7f6-a4a20a6d485e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108792f90>]}
[0m16:10:47.343583 [info ] [Thread-1 (]: 5 of 11 OK created sql incremental model dbt_merve.fact_store_transaction_view . [[32mSELECT 1500[0m in 0.08s]
[0m16:10:47.345128 [debug] [Thread-1 (]: Finished running node model.sumup.fact_store_transaction_view
[0m16:10:47.346093 [debug] [Thread-1 (]: Began running node model.sumup.top_ten_products
[0m16:10:47.348475 [info ] [Thread-1 (]: 6 of 11 START sql table model dbt_merve.top_ten_products ....................... [RUN]
[0m16:10:47.350833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.fact_store_transaction_view, now model.sumup.top_ten_products)
[0m16:10:47.352131 [debug] [Thread-1 (]: Began compiling node model.sumup.top_ten_products
[0m16:10:47.369032 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.top_ten_products"
[0m16:10:47.377571 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_products (compile): 16:10:47.352886 => 16:10:47.376635
[0m16:10:47.389227 [debug] [Thread-1 (]: Began executing node model.sumup.top_ten_products
[0m16:10:47.498889 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.top_ten_products"
[0m16:10:47.500444 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m16:10:47.501112 [debug] [Thread-1 (]: On model.sumup.top_ten_products: BEGIN
[0m16:10:47.501690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:47.515054 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:10:47.515832 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m16:10:47.516531 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */

  
    

  create  table "merveyasa"."dbt_merve"."top_ten_products__dbt_tmp"
  
  
    as
  
  (
    

WITH top_ten_products AS (
    SELECT
        product_name,
        product_sku,
        transactions_count,
        total_transaction_amount
    FROM "merveyasa"."dbt_merve"."fact_product_agg"
    ORDER BY
        transactions_count DESC
    LIMIT 10
)

SELECT * FROM top_ten_products
  );
  
[0m16:10:47.523496 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m16:10:47.535833 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m16:10:47.536531 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */
alter table "merveyasa"."dbt_merve"."top_ten_products__dbt_tmp" rename to "top_ten_products"
[0m16:10:47.538121 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:10:47.541100 [debug] [Thread-1 (]: On model.sumup.top_ten_products: COMMIT
[0m16:10:47.541552 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m16:10:47.541951 [debug] [Thread-1 (]: On model.sumup.top_ten_products: COMMIT
[0m16:10:47.543104 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:10:47.558704 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m16:10:47.559537 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */
drop table if exists "merveyasa"."dbt_merve"."top_ten_products__dbt_backup" cascade
[0m16:10:47.560994 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:10:47.564440 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_products (execute): 16:10:47.392600 => 16:10:47.563941
[0m16:10:47.565221 [debug] [Thread-1 (]: On model.sumup.top_ten_products: Close
[0m16:10:47.566586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5da59ff-0e61-4d16-a7f6-a4a20a6d485e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10800e250>]}
[0m16:10:47.567603 [info ] [Thread-1 (]: 6 of 11 OK created sql table model dbt_merve.top_ten_products .................. [[32mSELECT 10[0m in 0.22s]
[0m16:10:47.568988 [debug] [Thread-1 (]: Finished running node model.sumup.top_ten_products
[0m16:10:47.569818 [debug] [Thread-1 (]: Began running node model.sumup.avg_transaction_amount
[0m16:10:47.571263 [info ] [Thread-1 (]: 7 of 11 START sql incremental model dbt_merve.avg_transaction_amount ........... [RUN]
[0m16:10:47.572722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.top_ten_products, now model.sumup.avg_transaction_amount)
[0m16:10:47.573567 [debug] [Thread-1 (]: Began compiling node model.sumup.avg_transaction_amount
[0m16:10:47.583398 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.avg_transaction_amount"
[0m16:10:47.584758 [debug] [Thread-1 (]: Timing info for model.sumup.avg_transaction_amount (compile): 16:10:47.574018 => 16:10:47.584451
[0m16:10:47.585250 [debug] [Thread-1 (]: Began executing node model.sumup.avg_transaction_amount
[0m16:10:47.592237 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.avg_transaction_amount"
[0m16:10:47.593460 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m16:10:47.595219 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: BEGIN
[0m16:10:47.596417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:47.605585 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:10:47.606886 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m16:10:47.608559 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.avg_transaction_amount"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."avg_transaction_amount"
  
  
    as
  
  (
    


SELECT store_typology, store_country, AVG(transaction_amount) AS average_transaction_amount
FROM "merveyasa"."dbt_merve"."fact_store_transaction_view"
GROUP BY store_typology, store_country

  );
  
  
[0m16:10:47.623986 [debug] [Thread-1 (]: SQL status: SELECT 74 in 0.0 seconds
[0m16:10:47.628853 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: COMMIT
[0m16:10:47.629768 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m16:10:47.630588 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: COMMIT
[0m16:10:47.631982 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:10:47.633304 [debug] [Thread-1 (]: Timing info for model.sumup.avg_transaction_amount (execute): 16:10:47.585572 => 16:10:47.633026
[0m16:10:47.633839 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: Close
[0m16:10:47.635494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5da59ff-0e61-4d16-a7f6-a4a20a6d485e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ff7410>]}
[0m16:10:47.636639 [info ] [Thread-1 (]: 7 of 11 OK created sql incremental model dbt_merve.avg_transaction_amount ...... [[32mSELECT 74[0m in 0.06s]
[0m16:10:47.637978 [debug] [Thread-1 (]: Finished running node model.sumup.avg_transaction_amount
[0m16:10:47.638755 [debug] [Thread-1 (]: Began running node model.sumup.fact_store_transaction_first
[0m16:10:47.640028 [info ] [Thread-1 (]: 8 of 11 START sql incremental model dbt_merve.fact_store_transaction_first ..... [RUN]
[0m16:10:47.642567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.avg_transaction_amount, now model.sumup.fact_store_transaction_first)
[0m16:10:47.645400 [debug] [Thread-1 (]: Began compiling node model.sumup.fact_store_transaction_first
[0m16:10:47.655464 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.fact_store_transaction_first"
[0m16:10:47.690978 [debug] [Thread-1 (]: Timing info for model.sumup.fact_store_transaction_first (compile): 16:10:47.645978 => 16:10:47.690410
[0m16:10:47.693809 [debug] [Thread-1 (]: Began executing node model.sumup.fact_store_transaction_first
[0m16:10:47.702019 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.fact_store_transaction_first"
[0m16:10:47.703625 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_store_transaction_first"
[0m16:10:47.704907 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_first: BEGIN
[0m16:10:47.707143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:47.718635 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:10:47.719393 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_store_transaction_first"
[0m16:10:47.720379 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.fact_store_transaction_first"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."fact_store_transaction_first"
  
  
    as
  
  (
    


WITH numbered_transactions AS (
    SELECT
        store_id,
        transaction_happened_at,
        ROW_NUMBER() OVER (PARTITION BY store_id ORDER BY transaction_happened_at) AS rownumber
    FROM "merveyasa"."dbt_merve"."fact_store_transaction_view"
)
SELECT
    store_id,
    transaction_happened_at
FROM numbered_transactions
WHERE rownumber <= 5

  );
  
  
[0m16:10:47.731880 [debug] [Thread-1 (]: SQL status: SELECT 423 in 0.0 seconds
[0m16:10:47.735869 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_first: COMMIT
[0m16:10:47.736610 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_store_transaction_first"
[0m16:10:47.737400 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_first: COMMIT
[0m16:10:47.738604 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:10:47.741118 [debug] [Thread-1 (]: Timing info for model.sumup.fact_store_transaction_first (execute): 16:10:47.694345 => 16:10:47.740521
[0m16:10:47.742065 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_first: Close
[0m16:10:47.744037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5da59ff-0e61-4d16-a7f6-a4a20a6d485e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10811de50>]}
[0m16:10:47.745380 [info ] [Thread-1 (]: 8 of 11 OK created sql incremental model dbt_merve.fact_store_transaction_first  [[32mSELECT 423[0m in 0.10s]
[0m16:10:47.746532 [debug] [Thread-1 (]: Finished running node model.sumup.fact_store_transaction_first
[0m16:10:47.747330 [debug] [Thread-1 (]: Began running node model.sumup.pct_transaction
[0m16:10:47.748783 [info ] [Thread-1 (]: 9 of 11 START sql incremental model dbt_merve.pct_transaction .................. [RUN]
[0m16:10:47.750545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.fact_store_transaction_first, now model.sumup.pct_transaction)
[0m16:10:47.752073 [debug] [Thread-1 (]: Began compiling node model.sumup.pct_transaction
[0m16:10:47.761462 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.pct_transaction"
[0m16:10:47.762829 [debug] [Thread-1 (]: Timing info for model.sumup.pct_transaction (compile): 16:10:47.752575 => 16:10:47.762435
[0m16:10:47.766617 [debug] [Thread-1 (]: Began executing node model.sumup.pct_transaction
[0m16:10:47.788263 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.pct_transaction"
[0m16:10:47.790044 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m16:10:47.790719 [debug] [Thread-1 (]: On model.sumup.pct_transaction: BEGIN
[0m16:10:47.793094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:47.810612 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:10:47.812734 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m16:10:47.814449 [debug] [Thread-1 (]: On model.sumup.pct_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.pct_transaction"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."pct_transaction"
  
  
    as
  
  (
    


WITH pct_transaction AS 
(
    SELECT device_type, COUNT(*) * 100.0 / SUM(COUNT(*)) OVER () AS percentage
    FROM "merveyasa"."dbt_merve"."fact_store_transaction_view"
    GROUP BY device_type
)
SELECT * FROM pct_transaction
ORDER BY device_type

  );
  
  
[0m16:10:47.823367 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.0 seconds
[0m16:10:47.828328 [debug] [Thread-1 (]: On model.sumup.pct_transaction: COMMIT
[0m16:10:47.829250 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m16:10:47.829889 [debug] [Thread-1 (]: On model.sumup.pct_transaction: COMMIT
[0m16:10:47.831459 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:10:47.833296 [debug] [Thread-1 (]: Timing info for model.sumup.pct_transaction (execute): 16:10:47.767373 => 16:10:47.832884
[0m16:10:47.834309 [debug] [Thread-1 (]: On model.sumup.pct_transaction: Close
[0m16:10:47.837751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5da59ff-0e61-4d16-a7f6-a4a20a6d485e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d1790>]}
[0m16:10:47.838822 [info ] [Thread-1 (]: 9 of 11 OK created sql incremental model dbt_merve.pct_transaction ............. [[32mSELECT 5[0m in 0.09s]
[0m16:10:47.870084 [debug] [Thread-1 (]: Finished running node model.sumup.pct_transaction
[0m16:10:47.873056 [debug] [Thread-1 (]: Began running node model.sumup.top_ten_stores
[0m16:10:47.877907 [info ] [Thread-1 (]: 10 of 11 START sql table model dbt_merve.top_ten_stores ........................ [RUN]
[0m16:10:47.879692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.pct_transaction, now model.sumup.top_ten_stores)
[0m16:10:47.880881 [debug] [Thread-1 (]: Began compiling node model.sumup.top_ten_stores
[0m16:10:47.887892 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.top_ten_stores"
[0m16:10:47.889576 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_stores (compile): 16:10:47.881399 => 16:10:47.888815
[0m16:10:47.890374 [debug] [Thread-1 (]: Began executing node model.sumup.top_ten_stores
[0m16:10:47.901965 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.top_ten_stores"
[0m16:10:47.903229 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m16:10:47.904135 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: BEGIN
[0m16:10:47.904869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:47.916518 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:10:47.917276 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m16:10:47.917952 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */

  
    

  create  table "merveyasa"."dbt_merve"."top_ten_stores__dbt_tmp"
  
  
    as
  
  (
    

WITH top_ten_stores AS 
(
    SELECT store_id, SUM(transaction_amount) AS total_transaction_amount
    FROM "merveyasa"."dbt_merve"."fact_store_transaction_view"
    GROUP BY store_id
    ORDER BY total_transaction_amount DESC
    LIMIT 10
)
SELECT * FROM top_ten_stores
  );
  
[0m16:10:47.942569 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m16:10:47.954337 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m16:10:47.955228 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */
alter table "merveyasa"."dbt_merve"."top_ten_stores__dbt_tmp" rename to "top_ten_stores"
[0m16:10:47.957071 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:10:47.962914 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: COMMIT
[0m16:10:47.963774 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m16:10:47.964662 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: COMMIT
[0m16:10:47.966125 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:10:47.973942 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m16:10:47.974819 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */
drop table if exists "merveyasa"."dbt_merve"."top_ten_stores__dbt_backup" cascade
[0m16:10:47.975986 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:10:47.980594 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_stores (execute): 16:10:47.891483 => 16:10:47.979087
[0m16:10:47.981454 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: Close
[0m16:10:47.982928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5da59ff-0e61-4d16-a7f6-a4a20a6d485e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d3390>]}
[0m16:10:47.983966 [info ] [Thread-1 (]: 10 of 11 OK created sql table model dbt_merve.top_ten_stores ................... [[32mSELECT 10[0m in 0.10s]
[0m16:10:47.985273 [debug] [Thread-1 (]: Finished running node model.sumup.top_ten_stores
[0m16:10:47.986175 [debug] [Thread-1 (]: Began running node model.sumup.inc_first_five_transaction
[0m16:10:47.987769 [info ] [Thread-1 (]: 11 of 11 START sql incremental model dbt_merve.inc_first_five_transaction ...... [RUN]
[0m16:10:47.989098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.top_ten_stores, now model.sumup.inc_first_five_transaction)
[0m16:10:47.991677 [debug] [Thread-1 (]: Began compiling node model.sumup.inc_first_five_transaction
[0m16:10:48.005307 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.inc_first_five_transaction"
[0m16:10:48.007432 [debug] [Thread-1 (]: Timing info for model.sumup.inc_first_five_transaction (compile): 16:10:47.993124 => 16:10:48.006868
[0m16:10:48.008375 [debug] [Thread-1 (]: Began executing node model.sumup.inc_first_five_transaction
[0m16:10:48.020316 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.inc_first_five_transaction"
[0m16:10:48.021584 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m16:10:48.022243 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: BEGIN
[0m16:10:48.023291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:48.034360 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:10:48.034971 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m16:10:48.035501 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.inc_first_five_transaction"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."inc_first_five_transaction"
  
  
    as
  
  (
    


SELECT
    store_id,
    AVG(time_diff) AS avg_time_diff
FROM (
    SELECT
        store_id,
        transaction_happened_at - LAG(transaction_happened_at, 1) OVER (PARTITION BY store_id ORDER BY transaction_happened_at) AS time_diff
    FROM "merveyasa"."dbt_merve"."fact_store_transaction_first"
) aa
GROUP BY store_id

  );
  
  
[0m16:10:48.042540 [debug] [Thread-1 (]: SQL status: SELECT 87 in 0.0 seconds
[0m16:10:48.045127 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: COMMIT
[0m16:10:48.045633 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m16:10:48.046088 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: COMMIT
[0m16:10:48.047339 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:10:48.049506 [debug] [Thread-1 (]: Timing info for model.sumup.inc_first_five_transaction (execute): 16:10:48.008739 => 16:10:48.049089
[0m16:10:48.050812 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: Close
[0m16:10:48.052387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5da59ff-0e61-4d16-a7f6-a4a20a6d485e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d2990>]}
[0m16:10:48.053580 [info ] [Thread-1 (]: 11 of 11 OK created sql incremental model dbt_merve.inc_first_five_transaction . [[32mSELECT 87[0m in 0.06s]
[0m16:10:48.060937 [debug] [Thread-1 (]: Finished running node model.sumup.inc_first_five_transaction
[0m16:10:48.065083 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:48.065767 [debug] [MainThread]: On master: BEGIN
[0m16:10:48.066629 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:10:48.077930 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:10:48.078774 [debug] [MainThread]: On master: COMMIT
[0m16:10:48.079473 [debug] [MainThread]: Using postgres connection "master"
[0m16:10:48.080376 [debug] [MainThread]: On master: COMMIT
[0m16:10:48.081265 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:10:48.086296 [debug] [MainThread]: On master: Close
[0m16:10:48.087741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:48.088317 [debug] [MainThread]: Connection 'model.sumup.inc_first_five_transaction' was properly closed.
[0m16:10:48.089035 [info ] [MainThread]: 
[0m16:10:48.090050 [info ] [MainThread]: Finished running 9 incremental models, 2 table models in 0 hours 0 minutes and 1.39 seconds (1.39s).
[0m16:10:48.093221 [debug] [MainThread]: Command end result
[0m16:10:48.113544 [info ] [MainThread]: 
[0m16:10:48.114159 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:10:48.114829 [info ] [MainThread]: 
[0m16:10:48.115636 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m16:10:48.117173 [debug] [MainThread]: Command `dbt run` succeeded at 16:10:48.116836 after 2.00 seconds
[0m16:10:48.117933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fa3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103037bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10765dd50>]}
[0m16:10:48.118595 [debug] [MainThread]: Flushing usage events
[0m17:29:49.535780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d348b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5bd490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d329ad0>]}


============================== 17:29:49.545084 | 26f00473-c642-4f98-aa2b-a4663342d7e5 ==============================
[0m17:29:49.545084 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:29:49.546958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m17:29:49.785025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26f00473-c642-4f98-aa2b-a4663342d7e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d314490>]}
[0m17:29:49.793981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26f00473-c642-4f98-aa2b-a4663342d7e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d32add0>]}
[0m17:29:49.795120 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:29:49.835319 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:29:49.858780 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:29:49.859704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '26f00473-c642-4f98-aa2b-a4663342d7e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd06b90>]}
[0m17:29:49.891575 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading sumup: raw_data/schema.yml - Runtime Error
    Syntax error near line 29
    ------------------------------
    26 |         tests:
    27 |           - unique
    28 |           - not_null
    29 |             severity: 'error'
    30 |       - name: store_name
    31 |         description: "Name of the store"
    32 |       - name: store_address
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 29, column 21
[0m17:29:49.892618 [debug] [MainThread]: Command `dbt run` failed at 17:29:49.892431 after 0.41 seconds
[0m17:29:49.893096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6c2f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8cba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8c9850>]}
[0m17:29:49.893530 [debug] [MainThread]: Flushing usage events
[0m17:32:13.584347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4f5d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba93410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba9fe90>]}


============================== 17:32:13.593855 | 551ad5a6-1770-4e9b-be80-e777ee7b5720 ==============================
[0m17:32:13.593855 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:32:13.595013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:32:13.765483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '551ad5a6-1770-4e9b-be80-e777ee7b5720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4f5290>]}
[0m17:32:13.776301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '551ad5a6-1770-4e9b-be80-e777ee7b5720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4d5a10>]}
[0m17:32:13.778023 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:32:13.821568 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:32:13.846950 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:32:13.847689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '551ad5a6-1770-4e9b-be80-e777ee7b5720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5096d0>]}
[0m17:32:13.869034 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading sumup: raw_data/schema.yml - Runtime Error
    Syntax error near line 116
    ------------------------------
    113|         description: "Timestamp for when the transaction was created"
    114|         tests:
    115|           -not_null
    116|           - sql: 
    117|               ref: 'date_test'
    118|               severity: 'warn'
    119|       - name: transaction_happened_at
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 116, column 16
[0m17:32:13.870160 [debug] [MainThread]: Command `dbt run` failed at 17:32:13.869930 after 0.33 seconds
[0m17:32:13.870744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bef4b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bef4690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bef4610>]}
[0m17:32:13.871272 [debug] [MainThread]: Flushing usage events
[0m17:36:48.071194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d2c210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11129eb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fd0d50>]}


============================== 17:36:48.081479 | 7998b915-a46b-4405-bb34-fe139362bdc6 ==============================
[0m17:36:48.081479 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:36:48.082710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:36:48.246405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7998b915-a46b-4405-bb34-fe139362bdc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fa2ad0>]}
[0m17:36:48.255741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7998b915-a46b-4405-bb34-fe139362bdc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111096350>]}
[0m17:36:48.256870 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:36:48.285680 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:36:48.308204 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:36:48.309340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7998b915-a46b-4405-bb34-fe139362bdc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fba0d0>]}
[0m17:36:48.335725 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading sumup: raw_data/schema.yml - Runtime Error
    Syntax error near line 116
    ------------------------------
    113|         description: "Timestamp for when the transaction was created"
    114|         tests:
    115|           -not_null
    116|           - sql: 
    117|               ref: {{ ref('date_test') }}
    118|               severity: 'warn'
    119|       - name: transaction_happened_at
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 116, column 16
[0m17:36:48.337006 [debug] [MainThread]: Command `dbt run` failed at 17:36:48.336527 after 0.31 seconds
[0m17:36:48.337541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11129f690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11129fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11129d390>]}
[0m17:36:48.337981 [debug] [MainThread]: Flushing usage events
[0m17:37:33.318526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105abac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab9d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e26650>]}


============================== 17:37:33.324180 | df95e018-4b76-4ec1-8427-463e38419310 ==============================
[0m17:37:33.324180 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:37:33.324979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:37:33.423445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df95e018-4b76-4ec1-8427-463e38419310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b1eb10>]}
[0m17:37:33.432008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df95e018-4b76-4ec1-8427-463e38419310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e20f90>]}
[0m17:37:33.432688 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:37:33.456966 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:37:33.474862 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:37:33.475560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'df95e018-4b76-4ec1-8427-463e38419310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106566710>]}
[0m17:37:33.483760 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading sumup: raw_data/schema.yml - Runtime Error
    Syntax error near line 116
    ------------------------------
    113|         description: "Timestamp for when the transaction was created"
    114|         tests:
    115|           -not_null
    116|           - sql: 
    117|               ref: {{ ref('tests/date_test.sql') }}
    118|               severity: 'warn'
    119|       - name: transaction_happened_at
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 116, column 16
[0m17:37:33.484628 [debug] [MainThread]: Command `dbt run` failed at 17:37:33.484471 after 0.19 seconds
[0m17:37:33.485098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1ba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1013a8810>]}
[0m17:37:33.485518 [debug] [MainThread]: Flushing usage events
[0m17:42:30.876659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e6f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091166d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10912b650>]}


============================== 17:42:30.887441 | 7c46da1e-8eb4-4d85-a7d1-c6b5612d80bf ==============================
[0m17:42:30.887441 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:42:30.888666 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:42:30.943077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c46da1e-8eb4-4d85-a7d1-c6b5612d80bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109116350>]}
[0m17:42:30.946807 [debug] [MainThread]: Set downloads directory='/var/folders/nb/m2gjmfnj7d9dfs7jmp2k7gpm0000gn/T/dbt-downloads-wohaupuz'
[0m17:42:30.947720 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:42:31.264565 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:42:31.269049 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:42:31.433736 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:42:31.444083 [error] [MainThread]: Encountered an error:
Could not find a matching compatible version for package dbt-labs/dbt_utils
  Requested range: =0.6.0, =0.6.0
  Compatible versions: ['0.0.1', '0.1.0', '0.1.1', '0.1.2', '0.1.3', '0.1.4', '0.1.5', '0.1.6', '0.1.7', '0.1.8', '0.1.9', '0.1.10', '0.1.11', '0.1.12', '0.1.13', '0.1.14', '0.1.15', '0.1.16', '0.1.17', '0.1.18', '0.1.19', '0.1.20', '0.1.21', '0.1.22', '0.1.23', '0.1.24', '0.1.25', '0.2.0', '0.2.1', '0.2.2', '0.2.3', '0.2.4', '0.2.5', '0.3.0', '0.4.0', '0.4.1', '0.5.0', '0.8.0', '0.8.1', '0.8.2', '0.8.3', '0.8.4', '0.8.5', '0.8.6', '0.9.0', '0.9.1', '0.9.2', '0.9.5', '0.9.6', '1.0.0', '1.1.0', '1.1.1']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'
[0m17:42:31.445378 [debug] [MainThread]: Command `dbt deps` failed at 17:42:31.445031 after 0.61 seconds
[0m17:42:31.446151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e88e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109425310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109144410>]}
[0m17:42:31.446780 [debug] [MainThread]: Flushing usage events
[0m17:42:57.385968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d75db90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4c9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4c8fd0>]}


============================== 17:42:57.392323 | 4127c474-6f91-4789-843c-6375de4ce432 ==============================
[0m17:42:57.392323 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:42:57.393607 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'warn_error': 'None', 'version_check': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt --no-version-check deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:42:57.448957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4127c474-6f91-4789-843c-6375de4ce432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5ce6d0>]}
[0m17:42:57.452641 [debug] [MainThread]: Set downloads directory='/var/folders/nb/m2gjmfnj7d9dfs7jmp2k7gpm0000gn/T/dbt-downloads-bkczs96k'
[0m17:42:57.453716 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:42:57.672371 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:42:57.676668 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:42:57.865978 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:42:57.878083 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:42:58.487553 [info ] [MainThread]: Installed from version 0.6.0
[0m17:42:58.488196 [info ] [MainThread]: Updated version available: 1.1.1
[0m17:42:58.488783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4127c474-6f91-4789-843c-6375de4ce432', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2f7ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da5fd50>]}
[0m17:42:58.489280 [info ] [MainThread]: 
[0m17:42:58.489693 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m17:42:58.491309 [debug] [MainThread]: Command `dbt deps` succeeded at 17:42:58.491021 after 1.13 seconds
[0m17:42:58.492074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4ac1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee3950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1673d0>]}
[0m17:42:58.492931 [debug] [MainThread]: Flushing usage events
[0m17:44:08.169317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103056d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110306810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105a0810>]}


============================== 17:44:08.180972 | a04ad0bd-1e1b-4a20-82cb-70de43ac2891 ==============================
[0m17:44:08.180972 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:44:08.182774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m17:44:08.359409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a04ad0bd-1e1b-4a20-82cb-70de43ac2891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108cf7d0>]}
[0m17:44:08.371422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a04ad0bd-1e1b-4a20-82cb-70de43ac2891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110642a10>]}
[0m17:44:08.372771 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:44:08.425045 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =1.6.0
      Required version of dbt for 'dbt_utils': ['>=0.18.0', '<0.19.0']
    Check for a different version of the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/merveyasa/Desktop/Folder for sumup/dbt_packages/dbt_utils/dbt_project.yml

Error encountered in /Users/merveyasa/Desktop/Folder for sumup/dbt_packages/dbt_utils
[0m17:44:08.426478 [debug] [MainThread]: Command `dbt run` failed at 17:44:08.426219 after 0.30 seconds
[0m17:44:08.428906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108bc690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105cbf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffb7390>]}
[0m17:44:08.429969 [debug] [MainThread]: Flushing usage events
[0m17:48:57.332375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fed6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff0e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fff8650>]}


============================== 17:48:57.343109 | 2c6d62f2-0c6c-4f2e-b30a-57075eefde66 ==============================
[0m17:48:57.343109 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:48:57.344963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:48:57.477190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c6d62f2-0c6c-4f2e-b30a-57075eefde66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff2ce90>]}
[0m17:48:57.486780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c6d62f2-0c6c-4f2e-b30a-57075eefde66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100b5c10>]}
[0m17:48:57.487602 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:48:57.520978 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =1.6.0
      Required version of dbt for 'dbt_utils': ['>=0.18.0', '<0.19.0']
    Check for a different version of the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/merveyasa/Desktop/Folder for sumup/dbt_packages/dbt_utils/dbt_project.yml

Error encountered in /Users/merveyasa/Desktop/Folder for sumup/dbt_packages/dbt_utils
[0m17:48:57.522769 [debug] [MainThread]: Command `dbt run` failed at 17:48:57.522497 after 0.22 seconds
[0m17:48:57.523492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6b3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc25e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5a7bd0>]}
[0m17:48:57.524069 [debug] [MainThread]: Flushing usage events
[0m18:07:42.921486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c23b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c247b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf16250>]}


============================== 18:07:42.930846 | 3e9c093a-d3fe-4e9c-9440-41d82852d9af ==============================
[0m18:07:42.930846 [info ] [MainThread]: Running with dbt=1.6.0
[0m18:07:42.931778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:07:43.454986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e9c093a-d3fe-4e9c-9440-41d82852d9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf36e50>]}
[0m18:07:43.482307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e9c093a-d3fe-4e9c-9440-41d82852d9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcdc210>]}
[0m18:07:43.486605 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m18:07:43.597580 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =1.6.0
      Required version of dbt for 'dbt_utils': ['>=0.18.0', '<0.19.0']
    Check for a different version of the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /Users/merveyasa/Desktop/Folder for sumup/dbt_packages/dbt_utils/dbt_project.yml

Error encountered in /Users/merveyasa/Desktop/Folder for sumup/dbt_packages/dbt_utils
[0m18:07:43.600793 [debug] [MainThread]: Command `dbt run` failed at 18:07:43.600004 after 0.72 seconds
[0m18:07:43.601716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc68950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2443d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e03d90>]}
[0m18:07:43.602579 [debug] [MainThread]: Flushing usage events
[0m18:08:33.221016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103159d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffd3390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffd3fd0>]}


============================== 18:08:33.228493 | c77f1201-f04a-4b18-be72-7b2db41a7c23 ==============================
[0m18:08:33.228493 [info ] [MainThread]: Running with dbt=1.6.0
[0m18:08:33.229595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'version_check': 'False', 'warn_error': 'None', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh --no-version-check', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:08:33.379151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c77f1201-f04a-4b18-be72-7b2db41a7c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110609990>]}
[0m18:08:33.388826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c77f1201-f04a-4b18-be72-7b2db41a7c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105e0c50>]}
[0m18:08:33.389961 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m18:08:33.435185 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m18:08:33.466217 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m18:08:33.466865 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:08:33.467350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c77f1201-f04a-4b18-be72-7b2db41a7c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11099bc50>]}
[0m18:08:33.480373 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading sumup: raw_data/schema.yml - Runtime Error
    Syntax error near line 116
    ------------------------------
    113|         description: "Timestamp for when the transaction was created"
    114|         tests:
    115|           -not_null
    116|           - dbt_utils.expression_is_true:
    117|             expression: "transaction_created_at <= transaction_happened_at"
    118|             severity: 'warn'
    119|       - name: transaction_happened_at
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 116, column 41
[0m18:08:33.481407 [debug] [MainThread]: Command `dbt run` failed at 18:08:33.481226 after 0.29 seconds
[0m18:08:33.481989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100730d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b15fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ec9550>]}
[0m18:08:33.483037 [debug] [MainThread]: Flushing usage events
[0m18:17:23.247967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d7c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d7da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df4790>]}


============================== 18:17:23.257262 | 16c21ce9-0542-441b-bfe0-4a26a8087a95 ==============================
[0m18:17:23.257262 [info ] [MainThread]: Running with dbt=1.6.0
[0m18:17:23.258210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:17:23.326764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16c21ce9-0542-441b-bfe0-4a26a8087a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108084e10>]}
[0m18:17:23.328535 [debug] [MainThread]: Set downloads directory='/var/folders/nb/m2gjmfnj7d9dfs7jmp2k7gpm0000gn/T/dbt-downloads-m8keqay7'
[0m18:17:23.329396 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:17:23.623671 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:17:23.624722 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:17:23.804023 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:17:23.815556 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:17:24.714882 [info ] [MainThread]: Installed from version 1.1.1
[0m18:17:24.715805 [info ] [MainThread]: Up to date!
[0m18:17:24.716508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '16c21ce9-0542-441b-bfe0-4a26a8087a95', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b30bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108084a90>]}
[0m18:17:24.718413 [debug] [MainThread]: Command `dbt deps` succeeded at 18:17:24.718074 after 1.51 seconds
[0m18:17:24.719152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10798cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c32cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a3b810>]}
[0m18:17:24.719916 [debug] [MainThread]: Flushing usage events
[0m18:17:41.250330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab8c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae90cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae41450>]}


============================== 18:17:41.268072 | 92e59f21-8f24-4bd9-9557-94bef8e40acf ==============================
[0m18:17:41.268072 [info ] [MainThread]: Running with dbt=1.6.0
[0m18:17:41.269327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:17:41.507070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92e59f21-8f24-4bd9-9557-94bef8e40acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab5ead0>]}
[0m18:17:41.519392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92e59f21-8f24-4bd9-9557-94bef8e40acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b15fb90>]}
[0m18:17:41.521066 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m18:17:41.584723 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m18:17:41.624294 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m18:17:41.625152 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:17:41.625872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '92e59f21-8f24-4bd9-9557-94bef8e40acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5abb50>]}
[0m18:17:41.645319 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading sumup: raw_data/schema.yml - Runtime Error
    Syntax error near line 116
    ------------------------------
    113|         description: "Timestamp for when the transaction was created"
    114|         tests:
    115|           -not_null
    116|           - dbt_utils.expression_is_true:
    117|             expression: "transaction_created_at <= transaction_happened_at"
    118|             severity: 'warn'
    119|       - name: transaction_happened_at
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 116, column 41
[0m18:17:41.647114 [debug] [MainThread]: Command `dbt run` failed at 18:17:41.646799 after 0.44 seconds
[0m18:17:41.648295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bad89d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bad8890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bad8990>]}
[0m18:17:41.649194 [debug] [MainThread]: Flushing usage events
[0m18:20:15.715466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b581d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090bfbd0>]}


============================== 18:20:15.725370 | 7c480e47-03a4-4cc8-ac34-e213472e921d ==============================
[0m18:20:15.725370 [info ] [MainThread]: Running with dbt=1.6.0
[0m18:20:15.726423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:20:15.983718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c480e47-03a4-4cc8-ac34-e213472e921d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090b3750>]}
[0m18:20:15.993817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c480e47-03a4-4cc8-ac34-e213472e921d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109377910>]}
[0m18:20:15.994968 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m18:20:16.087062 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m18:20:16.127777 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m18:20:16.128467 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:20:16.129046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7c480e47-03a4-4cc8-ac34-e213472e921d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090b3f90>]}
[0m18:20:17.415626 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/raw_data/schema.yml:
  	test definition dictionary must have exactly one key, got [('not_null', None), ('severity', 'error')] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m18:20:17.416539 [debug] [MainThread]: Command `dbt run` failed at 18:20:17.416377 after 1.75 seconds
[0m18:20:17.416989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090b9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094de850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108db3350>]}
[0m18:20:17.417405 [debug] [MainThread]: Flushing usage events
[0m18:22:01.741099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120381d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114177610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140e7290>]}


============================== 18:22:01.749815 | 04b42bb6-b6a4-4cdf-aa2b-99fcca3c9f36 ==============================
[0m18:22:01.749815 [info ] [MainThread]: Running with dbt=1.6.0
[0m18:22:01.750872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:22:01.884720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04b42bb6-b6a4-4cdf-aa2b-99fcca3c9f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143d9cd0>]}
[0m18:22:01.893987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04b42bb6-b6a4-4cdf-aa2b-99fcca3c9f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143cfed0>]}
[0m18:22:01.895542 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m18:22:01.937337 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m18:22:01.963367 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m18:22:01.964131 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:22:01.964635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '04b42bb6-b6a4-4cdf-aa2b-99fcca3c9f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115018590>]}
[0m18:22:03.242666 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/raw_data/schema.yml:
  	test definition dictionary must have exactly one key, got [('dbt_utils.expression_is_true', None), ('expression', 'transaction_created_at <= transaction_happened_at'), ('severity', 'warn')] instead (3 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m18:22:03.243638 [debug] [MainThread]: Command `dbt run` failed at 18:22:03.243451 after 1.55 seconds
[0m18:22:03.244090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11401c710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115018b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115079a50>]}
[0m18:22:03.244522 [debug] [MainThread]: Flushing usage events
[0m18:23:29.884423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae13e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae12b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b408cd0>]}


============================== 18:23:29.895127 | 9bdef677-b5aa-461e-8b2c-d65c7d07ddb0 ==============================
[0m18:23:29.895127 [info ] [MainThread]: Running with dbt=1.6.0
[0m18:23:29.896411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m18:23:30.052857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bdef677-b5aa-461e-8b2c-d65c7d07ddb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae211d0>]}
[0m18:23:30.070013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bdef677-b5aa-461e-8b2c-d65c7d07ddb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b428410>]}
[0m18:23:30.071467 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m18:23:30.112336 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m18:23:30.134763 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m18:23:30.135618 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:23:30.136287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9bdef677-b5aa-461e-8b2c-d65c7d07ddb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b843e90>]}
[0m18:23:30.155343 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading sumup: raw_data/schema.yml - Runtime Error
    Syntax error near line 118
    ------------------------------
    115|           - not_null
    116|           - dbt_utils.expression_is_true:
    117|             expression: "transaction_created_at <= transaction_happened_at"
    118|               severity: 'warn'
    119|       - name: transaction_happened_at
    120|         description: "Timestamp for when the transaction actually happened"
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 116, column 13
    did not find expected key
      in "<unicode string>", line 118, column 15
[0m18:23:30.156672 [debug] [MainThread]: Command `dbt run` failed at 18:23:30.156437 after 0.31 seconds
[0m18:23:30.157309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0ca950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd70610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd705d0>]}
[0m18:23:30.157860 [debug] [MainThread]: Flushing usage events
[0m18:24:21.285513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144ba390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114531550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144882d0>]}


============================== 18:24:21.294129 | ff30848f-c886-4857-adba-5f9dbe6be933 ==============================
[0m18:24:21.294129 [info ] [MainThread]: Running with dbt=1.6.0
[0m18:24:21.295077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/merveyasa/Desktop/Folder for sumup/logs', 'version_check': 'True', 'profiles_dir': '/Users/merveyasa/Desktop/Folder for sumup', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:24:21.435677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff30848f-c886-4857-adba-5f9dbe6be933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11478bc90>]}
[0m18:24:21.445334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff30848f-c886-4857-adba-5f9dbe6be933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144b8450>]}
[0m18:24:21.446610 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m18:24:21.494429 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m18:24:21.533888 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m18:24:21.534938 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:24:21.535692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ff30848f-c886-4857-adba-5f9dbe6be933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ef0210>]}
[0m18:24:22.966583 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 14 unused configuration paths:
- models.my_project.fact.fact_store_transaction_view
- models.my_project.result_tables.avg_transaction_amount
- models.my_project.result_tables.pct_transaction
- models.my_project.result_tables.inc_first_five_transaction
- models.my_project.result_tables.top_ten_stores
- models.my_project.raw_data.raw_stores
- models.my_project.raw_data.raw_transactions
- models.my_project.raw_data
- models.my_project.result_tables
- models.my_project.fact
- models.my_project.fact.fact_product_agg
- models.my_project.result_tables.top_ten_products
- models.my_project.raw_data.raw_devices
- models.my_project.fact.fact_store_transaction_first
[0m18:24:22.973798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff30848f-c886-4857-adba-5f9dbe6be933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f4bbd0>]}
[0m18:24:23.006551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff30848f-c886-4857-adba-5f9dbe6be933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155dfd10>]}
[0m18:24:23.007274 [info ] [MainThread]: Found 11 models, 50 tests, 3 sources, 0 exposures, 0 metrics, 463 macros, 0 groups, 0 semantic models
[0m18:24:23.007928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff30848f-c886-4857-adba-5f9dbe6be933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147b7890>]}
[0m18:24:23.011461 [info ] [MainThread]: 
[0m18:24:23.014634 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:24:23.016706 [debug] [ThreadPool]: Acquiring new postgres connection 'list_merveyasa'
[0m18:24:23.030448 [debug] [ThreadPool]: Using postgres connection "list_merveyasa"
[0m18:24:23.031059 [debug] [ThreadPool]: On list_merveyasa: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa"} */

    select distinct nspname from pg_namespace
  
[0m18:24:23.031548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:23.128018 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:24:23.129726 [debug] [ThreadPool]: On list_merveyasa: Close
[0m18:24:23.132134 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_merveyasa, now list_merveyasa_dbt_merve)
[0m18:24:23.138813 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m18:24:23.139236 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: BEGIN
[0m18:24:23.139559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:23.146373 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:24:23.146880 [debug] [ThreadPool]: Using postgres connection "list_merveyasa_dbt_merve"
[0m18:24:23.147349 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "list_merveyasa_dbt_merve"} */
select
      'merveyasa' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_merve'
    union all
    select
      'merveyasa' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dbt_merve'
  
[0m18:24:23.153012 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m18:24:23.154568 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: ROLLBACK
[0m18:24:23.155040 [debug] [ThreadPool]: On list_merveyasa_dbt_merve: Close
[0m18:24:23.162259 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:23.162672 [debug] [MainThread]: On master: BEGIN
[0m18:24:23.162996 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:24:23.168975 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:24:23.169382 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:23.169814 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:24:23.190186 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:24:23.191445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff30848f-c886-4857-adba-5f9dbe6be933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115530a50>]}
[0m18:24:23.191959 [debug] [MainThread]: On master: ROLLBACK
[0m18:24:23.192543 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:23.192905 [debug] [MainThread]: On master: BEGIN
[0m18:24:23.193610 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:24:23.193981 [debug] [MainThread]: On master: COMMIT
[0m18:24:23.194364 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:23.194704 [debug] [MainThread]: On master: COMMIT
[0m18:24:23.195157 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:24:23.195512 [debug] [MainThread]: On master: Close
[0m18:24:23.196301 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:24:23.196741 [info ] [MainThread]: 
[0m18:24:23.200946 [debug] [Thread-1 (]: Began running node model.sumup.raw_devices
[0m18:24:23.201542 [info ] [Thread-1 (]: 1 of 11 START sql incremental model dbt_merve.raw_devices ...................... [RUN]
[0m18:24:23.202400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_merveyasa_dbt_merve, now model.sumup.raw_devices)
[0m18:24:23.202899 [debug] [Thread-1 (]: Began compiling node model.sumup.raw_devices
[0m18:24:23.210249 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.raw_devices"
[0m18:24:23.219666 [debug] [Thread-1 (]: Timing info for model.sumup.raw_devices (compile): 18:24:23.203203 => 18:24:23.218957
[0m18:24:23.220707 [debug] [Thread-1 (]: Began executing node model.sumup.raw_devices
[0m18:24:23.287332 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.raw_devices"
[0m18:24:23.289135 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_devices"
[0m18:24:23.289758 [debug] [Thread-1 (]: On model.sumup.raw_devices: BEGIN
[0m18:24:23.290155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:23.296807 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:24:23.297435 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_devices"
[0m18:24:23.297999 [debug] [Thread-1 (]: On model.sumup.raw_devices: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.raw_devices"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."raw_devices__dbt_tmp"
  
  
    as
  
  (
    

WITH code AS (
    SELECT 
    metadata_timestamp,
    device_id, 
    device_type, 
    store_id
FROM "merveyasa"."public"."devices"
)


  SELECT * FROM code

  );
  
  
[0m18:24:23.311233 [debug] [Thread-1 (]: SQL status: SELECT 200 in 0.0 seconds
[0m18:24:23.319493 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_devices"
[0m18:24:23.319988 [debug] [Thread-1 (]: On model.sumup.raw_devices: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.raw_devices"} */
alter table "merveyasa"."dbt_merve"."raw_devices" rename to "raw_devices__dbt_backup"
[0m18:24:23.321370 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:24:23.324756 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_devices"
[0m18:24:23.325176 [debug] [Thread-1 (]: On model.sumup.raw_devices: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.raw_devices"} */
alter table "merveyasa"."dbt_merve"."raw_devices__dbt_tmp" rename to "raw_devices"
[0m18:24:23.326175 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:24:23.348554 [debug] [Thread-1 (]: On model.sumup.raw_devices: COMMIT
[0m18:24:23.349066 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_devices"
[0m18:24:23.349441 [debug] [Thread-1 (]: On model.sumup.raw_devices: COMMIT
[0m18:24:23.351325 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:24:23.360226 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_devices"
[0m18:24:23.360687 [debug] [Thread-1 (]: On model.sumup.raw_devices: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.raw_devices"} */
drop table if exists "merveyasa"."dbt_merve"."raw_devices__dbt_backup" cascade
[0m18:24:23.368836 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:24:23.370913 [debug] [Thread-1 (]: Timing info for model.sumup.raw_devices (execute): 18:24:23.221359 => 18:24:23.370642
[0m18:24:23.371434 [debug] [Thread-1 (]: On model.sumup.raw_devices: Close
[0m18:24:23.372494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff30848f-c886-4857-adba-5f9dbe6be933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115506250>]}
[0m18:24:23.373404 [info ] [Thread-1 (]: 1 of 11 OK created sql incremental model dbt_merve.raw_devices ................. [[32mSELECT 200[0m in 0.17s]
[0m18:24:23.374270 [debug] [Thread-1 (]: Finished running node model.sumup.raw_devices
[0m18:24:23.374847 [debug] [Thread-1 (]: Began running node model.sumup.raw_stores
[0m18:24:23.375817 [info ] [Thread-1 (]: 2 of 11 START sql incremental model dbt_merve.raw_stores ....................... [RUN]
[0m18:24:23.376876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.raw_devices, now model.sumup.raw_stores)
[0m18:24:23.377551 [debug] [Thread-1 (]: Began compiling node model.sumup.raw_stores
[0m18:24:23.384293 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.raw_stores"
[0m18:24:23.386171 [debug] [Thread-1 (]: Timing info for model.sumup.raw_stores (compile): 18:24:23.377901 => 18:24:23.385719
[0m18:24:23.386973 [debug] [Thread-1 (]: Began executing node model.sumup.raw_stores
[0m18:24:23.393958 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.raw_stores"
[0m18:24:23.395060 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_stores"
[0m18:24:23.395962 [debug] [Thread-1 (]: On model.sumup.raw_stores: BEGIN
[0m18:24:23.397206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:23.408754 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:24:23.409384 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_stores"
[0m18:24:23.409909 [debug] [Thread-1 (]: On model.sumup.raw_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.raw_stores"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."raw_stores__dbt_tmp"
  
  
    as
  
  (
    

WITH code as (
    SELECT 
    metadata_timestamp,
    store_id, 
    store_name, 
    store_address, 
    REGEXP_REPLACE(store_city, '[^a-zA-Z\s]', '', 'g') as store_city, 
    store_country, 
    store_created_at, 
    store_typology, 
    customer_id
	FROM "merveyasa"."public"."stores"
)


  SELECT * FROM code

  );
  
  
[0m18:24:23.422486 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m18:24:23.429018 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_stores"
[0m18:24:23.429713 [debug] [Thread-1 (]: On model.sumup.raw_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.raw_stores"} */
alter table "merveyasa"."dbt_merve"."raw_stores" rename to "raw_stores__dbt_backup"
[0m18:24:23.430700 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:24:23.434758 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_stores"
[0m18:24:23.435285 [debug] [Thread-1 (]: On model.sumup.raw_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.raw_stores"} */
alter table "merveyasa"."dbt_merve"."raw_stores__dbt_tmp" rename to "raw_stores"
[0m18:24:23.436360 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:24:23.439446 [debug] [Thread-1 (]: On model.sumup.raw_stores: COMMIT
[0m18:24:23.439953 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_stores"
[0m18:24:23.440403 [debug] [Thread-1 (]: On model.sumup.raw_stores: COMMIT
[0m18:24:23.442700 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:24:23.446634 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_stores"
[0m18:24:23.447176 [debug] [Thread-1 (]: On model.sumup.raw_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.raw_stores"} */
drop table if exists "merveyasa"."dbt_merve"."raw_stores__dbt_backup" cascade
[0m18:24:23.451324 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:24:23.453290 [debug] [Thread-1 (]: Timing info for model.sumup.raw_stores (execute): 18:24:23.387343 => 18:24:23.453028
[0m18:24:23.453783 [debug] [Thread-1 (]: On model.sumup.raw_stores: Close
[0m18:24:23.454765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff30848f-c886-4857-adba-5f9dbe6be933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5f9e50>]}
[0m18:24:23.455552 [info ] [Thread-1 (]: 2 of 11 OK created sql incremental model dbt_merve.raw_stores .................. [[32mSELECT 100[0m in 0.08s]
[0m18:24:23.456502 [debug] [Thread-1 (]: Finished running node model.sumup.raw_stores
[0m18:24:23.457083 [debug] [Thread-1 (]: Began running node model.sumup.raw_transactions
[0m18:24:23.458036 [info ] [Thread-1 (]: 3 of 11 START sql incremental model dbt_merve.raw_transactions ................. [RUN]
[0m18:24:23.459035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.raw_stores, now model.sumup.raw_transactions)
[0m18:24:23.459546 [debug] [Thread-1 (]: Began compiling node model.sumup.raw_transactions
[0m18:24:23.465632 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.raw_transactions"
[0m18:24:23.468760 [debug] [Thread-1 (]: Timing info for model.sumup.raw_transactions (compile): 18:24:23.459965 => 18:24:23.468175
[0m18:24:23.469696 [debug] [Thread-1 (]: Began executing node model.sumup.raw_transactions
[0m18:24:23.483314 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.raw_transactions"
[0m18:24:23.484982 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_transactions"
[0m18:24:23.485575 [debug] [Thread-1 (]: On model.sumup.raw_transactions: BEGIN
[0m18:24:23.486080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:23.494236 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:24:23.495309 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_transactions"
[0m18:24:23.496941 [debug] [Thread-1 (]: On model.sumup.raw_transactions: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.raw_transactions"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."raw_transactions__dbt_tmp"
  
  
    as
  
  (
    

WITH code as 
(
    SELECT 
    metadata_timestamp,
    transaction_id, 
    device_id, 
    LOWER(REGEXP_REPLACE(product_name, '[^a-zA-Z\s]+', '', 'g')) as product_name, 
    (CASE 
            WHEN product_sku ~ E'^\\d+\\.\\d+E\\+\\d+$' 
            THEN LTRIM(TO_CHAR(CAST(product_sku AS DOUBLE PRECISION), '9999999999999999999999999'))
            ELSE product_sku
        END) as product_sku, 
    LOWER(REGEXP_REPLACE(category_name, '[^a-zA-Z\s]+', '', 'g')) as category_name, 
    transaction_amount, 
    transaction_status, 
    CASE 
        WHEN card_number ~ E'^\\d+\\.\\d+E\\+\\d+$' THEN 
            LTRIM(TO_CHAR(CAST(card_number AS DOUBLE PRECISION), '9999999999999999999'))
        ELSE 
            REPLACE(card_number, ' ', '') 
    END as card_number, 
    cvv, 
    transaction_created_at, 
    transaction_happened_at
	FROM "merveyasa"."public"."transactions"

)


  SELECT * FROM code

  );
  
  
[0m18:24:23.526753 [debug] [Thread-1 (]: SQL status: SELECT 1500 in 0.0 seconds
[0m18:24:23.531669 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_transactions"
[0m18:24:23.533246 [debug] [Thread-1 (]: On model.sumup.raw_transactions: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.raw_transactions"} */
alter table "merveyasa"."dbt_merve"."raw_transactions" rename to "raw_transactions__dbt_backup"
[0m18:24:23.540021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:24:23.545765 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_transactions"
[0m18:24:23.546852 [debug] [Thread-1 (]: On model.sumup.raw_transactions: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.raw_transactions"} */
alter table "merveyasa"."dbt_merve"."raw_transactions__dbt_tmp" rename to "raw_transactions"
[0m18:24:23.556159 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:24:23.565065 [debug] [Thread-1 (]: On model.sumup.raw_transactions: COMMIT
[0m18:24:23.566407 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_transactions"
[0m18:24:23.567602 [debug] [Thread-1 (]: On model.sumup.raw_transactions: COMMIT
[0m18:24:23.569329 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:24:23.574788 [debug] [Thread-1 (]: Using postgres connection "model.sumup.raw_transactions"
[0m18:24:23.575314 [debug] [Thread-1 (]: On model.sumup.raw_transactions: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.raw_transactions"} */
drop table if exists "merveyasa"."dbt_merve"."raw_transactions__dbt_backup" cascade
[0m18:24:23.581035 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:24:23.582906 [debug] [Thread-1 (]: Timing info for model.sumup.raw_transactions (execute): 18:24:23.470339 => 18:24:23.582667
[0m18:24:23.583438 [debug] [Thread-1 (]: On model.sumup.raw_transactions: Close
[0m18:24:23.584670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff30848f-c886-4857-adba-5f9dbe6be933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b98490>]}
[0m18:24:23.585815 [info ] [Thread-1 (]: 3 of 11 OK created sql incremental model dbt_merve.raw_transactions ............ [[32mSELECT 1500[0m in 0.13s]
[0m18:24:23.586921 [debug] [Thread-1 (]: Finished running node model.sumup.raw_transactions
[0m18:24:23.589381 [debug] [Thread-1 (]: Began running node model.sumup.fact_product_agg
[0m18:24:23.590565 [info ] [Thread-1 (]: 4 of 11 START sql incremental model dbt_merve.fact_product_agg ................. [RUN]
[0m18:24:23.592140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.raw_transactions, now model.sumup.fact_product_agg)
[0m18:24:23.592852 [debug] [Thread-1 (]: Began compiling node model.sumup.fact_product_agg
[0m18:24:23.636018 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.fact_product_agg"
[0m18:24:23.637491 [debug] [Thread-1 (]: Timing info for model.sumup.fact_product_agg (compile): 18:24:23.593241 => 18:24:23.637076
[0m18:24:23.638541 [debug] [Thread-1 (]: Began executing node model.sumup.fact_product_agg
[0m18:24:23.678346 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.fact_product_agg"
[0m18:24:23.680665 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_product_agg"
[0m18:24:23.682650 [debug] [Thread-1 (]: On model.sumup.fact_product_agg: BEGIN
[0m18:24:23.683686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:23.692890 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:24:23.693754 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_product_agg"
[0m18:24:23.694824 [debug] [Thread-1 (]: On model.sumup.fact_product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.fact_product_agg"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."fact_product_agg__dbt_tmp"
  
  
    as
  
  (
    


SELECT
    product_name,
    product_sku,
    COUNT(*) AS transactions_count,
    SUM(transaction_amount) AS total_transaction_amount
FROM
    "merveyasa"."dbt_merve"."raw_transactions"
WHERE
    transaction_status = 'accepted'
GROUP BY
    product_name, product_sku

  );
  
  
[0m18:24:23.715329 [debug] [Thread-1 (]: SQL status: SELECT 407 in 0.0 seconds
[0m18:24:23.722953 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_product_agg"
[0m18:24:23.723769 [debug] [Thread-1 (]: On model.sumup.fact_product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.fact_product_agg"} */
alter table "merveyasa"."dbt_merve"."fact_product_agg" rename to "fact_product_agg__dbt_backup"
[0m18:24:23.726067 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:24:23.733077 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_product_agg"
[0m18:24:23.733913 [debug] [Thread-1 (]: On model.sumup.fact_product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.fact_product_agg"} */
alter table "merveyasa"."dbt_merve"."fact_product_agg__dbt_tmp" rename to "fact_product_agg"
[0m18:24:23.735715 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:24:23.740430 [debug] [Thread-1 (]: On model.sumup.fact_product_agg: COMMIT
[0m18:24:23.741223 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_product_agg"
[0m18:24:23.741933 [debug] [Thread-1 (]: On model.sumup.fact_product_agg: COMMIT
[0m18:24:23.743364 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:24:23.750295 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_product_agg"
[0m18:24:23.751087 [debug] [Thread-1 (]: On model.sumup.fact_product_agg: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.fact_product_agg"} */
drop table if exists "merveyasa"."dbt_merve"."fact_product_agg__dbt_backup" cascade
[0m18:24:23.755421 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:24:23.760441 [debug] [Thread-1 (]: Timing info for model.sumup.fact_product_agg (execute): 18:24:23.639286 => 18:24:23.760043
[0m18:24:23.761152 [debug] [Thread-1 (]: On model.sumup.fact_product_agg: Close
[0m18:24:23.762647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff30848f-c886-4857-adba-5f9dbe6be933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155fd350>]}
[0m18:24:23.763987 [info ] [Thread-1 (]: 4 of 11 OK created sql incremental model dbt_merve.fact_product_agg ............ [[32mSELECT 407[0m in 0.17s]
[0m18:24:23.765426 [debug] [Thread-1 (]: Finished running node model.sumup.fact_product_agg
[0m18:24:23.766555 [debug] [Thread-1 (]: Began running node model.sumup.fact_store_transaction_view
[0m18:24:23.769506 [info ] [Thread-1 (]: 5 of 11 START sql incremental model dbt_merve.fact_store_transaction_view ...... [RUN]
[0m18:24:23.782265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.fact_product_agg, now model.sumup.fact_store_transaction_view)
[0m18:24:23.783032 [debug] [Thread-1 (]: Began compiling node model.sumup.fact_store_transaction_view
[0m18:24:23.792465 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.fact_store_transaction_view"
[0m18:24:23.793540 [debug] [Thread-1 (]: Timing info for model.sumup.fact_store_transaction_view (compile): 18:24:23.783496 => 18:24:23.793272
[0m18:24:23.793964 [debug] [Thread-1 (]: Began executing node model.sumup.fact_store_transaction_view
[0m18:24:23.831896 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.fact_store_transaction_view"
[0m18:24:23.832987 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_store_transaction_view"
[0m18:24:23.833519 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_view: BEGIN
[0m18:24:23.833971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:23.842687 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:24:23.843509 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_store_transaction_view"
[0m18:24:23.844426 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.fact_store_transaction_view"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."fact_store_transaction_view__dbt_tmp"
  
  
    as
  
  (
    



    WITH store_transactions AS
    (
        SELECT
            t.metadata_timestamp,
            s.store_id,
            s.store_typology,
            s.store_country,
            t.product_name,
            t.product_sku,
            t.category_name,
            t.transaction_amount,
            t.transaction_status,
            t.transaction_happened_at,
            d.device_type
        FROM
            "merveyasa"."dbt_merve"."raw_transactions" t
        JOIN "merveyasa"."dbt_merve"."raw_devices" d ON t.device_id = d.device_id
        JOIN "merveyasa"."dbt_merve"."raw_stores" s ON d.store_id = s.store_id
    )
    select * from store_transactions

  );
  
  
[0m18:24:23.871714 [debug] [Thread-1 (]: SQL status: SELECT 1500 in 0.0 seconds
[0m18:24:23.893766 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_store_transaction_view"
[0m18:24:23.894506 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.fact_store_transaction_view"} */
alter table "merveyasa"."dbt_merve"."fact_store_transaction_view" rename to "fact_store_transaction_view__dbt_backup"
[0m18:24:23.895784 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:24:23.903116 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_store_transaction_view"
[0m18:24:23.905204 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.fact_store_transaction_view"} */
alter table "merveyasa"."dbt_merve"."fact_store_transaction_view__dbt_tmp" rename to "fact_store_transaction_view"
[0m18:24:23.906890 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:24:23.911758 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_view: COMMIT
[0m18:24:23.912785 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_store_transaction_view"
[0m18:24:23.913917 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_view: COMMIT
[0m18:24:23.915982 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:24:23.924252 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_store_transaction_view"
[0m18:24:23.925369 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_view: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.fact_store_transaction_view"} */
drop table if exists "merveyasa"."dbt_merve"."fact_store_transaction_view__dbt_backup" cascade
[0m18:24:23.933455 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:24:23.936462 [debug] [Thread-1 (]: Timing info for model.sumup.fact_store_transaction_view (execute): 18:24:23.794238 => 18:24:23.936060
[0m18:24:23.937201 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_view: Close
[0m18:24:23.938642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff30848f-c886-4857-adba-5f9dbe6be933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11563c410>]}
[0m18:24:23.939851 [info ] [Thread-1 (]: 5 of 11 OK created sql incremental model dbt_merve.fact_store_transaction_view . [[32mSELECT 1500[0m in 0.16s]
[0m18:24:23.941099 [debug] [Thread-1 (]: Finished running node model.sumup.fact_store_transaction_view
[0m18:24:23.941773 [debug] [Thread-1 (]: Began running node model.sumup.top_ten_products
[0m18:24:23.942995 [info ] [Thread-1 (]: 6 of 11 START sql table model dbt_merve.top_ten_products ....................... [RUN]
[0m18:24:23.944276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.fact_store_transaction_view, now model.sumup.top_ten_products)
[0m18:24:23.944974 [debug] [Thread-1 (]: Began compiling node model.sumup.top_ten_products
[0m18:24:23.952895 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.top_ten_products"
[0m18:24:23.954408 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_products (compile): 18:24:23.945420 => 18:24:23.953846
[0m18:24:23.955325 [debug] [Thread-1 (]: Began executing node model.sumup.top_ten_products
[0m18:24:23.991159 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.top_ten_products"
[0m18:24:23.993056 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m18:24:23.994142 [debug] [Thread-1 (]: On model.sumup.top_ten_products: BEGIN
[0m18:24:23.994834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:24.012889 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:24:24.013725 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m18:24:24.014504 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */

  
    

  create  table "merveyasa"."dbt_merve"."top_ten_products__dbt_tmp"
  
  
    as
  
  (
    

WITH top_ten_products AS (
    SELECT
        product_name,
        product_sku,
        transactions_count,
        total_transaction_amount
    FROM "merveyasa"."dbt_merve"."fact_product_agg"
    ORDER BY
        transactions_count DESC
    LIMIT 10
)

SELECT * FROM top_ten_products
  );
  
[0m18:24:24.021212 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m18:24:24.027205 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m18:24:24.028056 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */
alter table "merveyasa"."dbt_merve"."top_ten_products" rename to "top_ten_products__dbt_backup"
[0m18:24:24.029952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:24:24.035800 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m18:24:24.036490 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */
alter table "merveyasa"."dbt_merve"."top_ten_products__dbt_tmp" rename to "top_ten_products"
[0m18:24:24.037591 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:24:24.040830 [debug] [Thread-1 (]: On model.sumup.top_ten_products: COMMIT
[0m18:24:24.041369 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m18:24:24.041814 [debug] [Thread-1 (]: On model.sumup.top_ten_products: COMMIT
[0m18:24:24.043380 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:24:24.047802 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_products"
[0m18:24:24.048566 [debug] [Thread-1 (]: On model.sumup.top_ten_products: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_products"} */
drop table if exists "merveyasa"."dbt_merve"."top_ten_products__dbt_backup" cascade
[0m18:24:24.053320 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:24:24.069411 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_products (execute): 18:24:23.955882 => 18:24:24.069028
[0m18:24:24.070342 [debug] [Thread-1 (]: On model.sumup.top_ten_products: Close
[0m18:24:24.073857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff30848f-c886-4857-adba-5f9dbe6be933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155f6790>]}
[0m18:24:24.075511 [info ] [Thread-1 (]: 6 of 11 OK created sql table model dbt_merve.top_ten_products .................. [[32mSELECT 10[0m in 0.13s]
[0m18:24:24.076939 [debug] [Thread-1 (]: Finished running node model.sumup.top_ten_products
[0m18:24:24.077972 [debug] [Thread-1 (]: Began running node model.sumup.avg_transaction_amount
[0m18:24:24.080042 [info ] [Thread-1 (]: 7 of 11 START sql incremental model dbt_merve.avg_transaction_amount ........... [RUN]
[0m18:24:24.081502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.top_ten_products, now model.sumup.avg_transaction_amount)
[0m18:24:24.105203 [debug] [Thread-1 (]: Began compiling node model.sumup.avg_transaction_amount
[0m18:24:24.115290 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.avg_transaction_amount"
[0m18:24:24.117237 [debug] [Thread-1 (]: Timing info for model.sumup.avg_transaction_amount (compile): 18:24:24.105689 => 18:24:24.116774
[0m18:24:24.117943 [debug] [Thread-1 (]: Began executing node model.sumup.avg_transaction_amount
[0m18:24:24.128207 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.avg_transaction_amount"
[0m18:24:24.129637 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m18:24:24.130360 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: BEGIN
[0m18:24:24.131054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:24.141724 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:24:24.142485 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m18:24:24.143181 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.avg_transaction_amount"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."avg_transaction_amount__dbt_tmp"
  
  
    as
  
  (
    


SELECT store_typology, store_country, AVG(transaction_amount) AS average_transaction_amount
FROM "merveyasa"."dbt_merve"."fact_store_transaction_view"
GROUP BY store_typology, store_country

  );
  
  
[0m18:24:24.149829 [debug] [Thread-1 (]: SQL status: SELECT 74 in 0.0 seconds
[0m18:24:24.155566 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m18:24:24.156459 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.avg_transaction_amount"} */
alter table "merveyasa"."dbt_merve"."avg_transaction_amount" rename to "avg_transaction_amount__dbt_backup"
[0m18:24:24.157715 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:24:24.166046 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m18:24:24.166755 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.avg_transaction_amount"} */
alter table "merveyasa"."dbt_merve"."avg_transaction_amount__dbt_tmp" rename to "avg_transaction_amount"
[0m18:24:24.168044 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:24:24.172207 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: COMMIT
[0m18:24:24.172905 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m18:24:24.173556 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: COMMIT
[0m18:24:24.174800 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:24:24.179600 [debug] [Thread-1 (]: Using postgres connection "model.sumup.avg_transaction_amount"
[0m18:24:24.180040 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.avg_transaction_amount"} */
drop table if exists "merveyasa"."dbt_merve"."avg_transaction_amount__dbt_backup" cascade
[0m18:24:24.182682 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:24:24.184296 [debug] [Thread-1 (]: Timing info for model.sumup.avg_transaction_amount (execute): 18:24:24.118389 => 18:24:24.184061
[0m18:24:24.184727 [debug] [Thread-1 (]: On model.sumup.avg_transaction_amount: Close
[0m18:24:24.185714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff30848f-c886-4857-adba-5f9dbe6be933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11554a990>]}
[0m18:24:24.186462 [info ] [Thread-1 (]: 7 of 11 OK created sql incremental model dbt_merve.avg_transaction_amount ...... [[32mSELECT 74[0m in 0.10s]
[0m18:24:24.187283 [debug] [Thread-1 (]: Finished running node model.sumup.avg_transaction_amount
[0m18:24:24.187831 [debug] [Thread-1 (]: Began running node model.sumup.fact_store_transaction_first
[0m18:24:24.188812 [info ] [Thread-1 (]: 8 of 11 START sql incremental model dbt_merve.fact_store_transaction_first ..... [RUN]
[0m18:24:24.189876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.avg_transaction_amount, now model.sumup.fact_store_transaction_first)
[0m18:24:24.190449 [debug] [Thread-1 (]: Began compiling node model.sumup.fact_store_transaction_first
[0m18:24:24.196257 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.fact_store_transaction_first"
[0m18:24:24.197452 [debug] [Thread-1 (]: Timing info for model.sumup.fact_store_transaction_first (compile): 18:24:24.190776 => 18:24:24.196999
[0m18:24:24.198209 [debug] [Thread-1 (]: Began executing node model.sumup.fact_store_transaction_first
[0m18:24:24.209104 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.fact_store_transaction_first"
[0m18:24:24.210553 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_store_transaction_first"
[0m18:24:24.211475 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_first: BEGIN
[0m18:24:24.212310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:24.222272 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:24:24.223127 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_store_transaction_first"
[0m18:24:24.223919 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.fact_store_transaction_first"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."fact_store_transaction_first__dbt_tmp"
  
  
    as
  
  (
    


WITH numbered_transactions AS (
    SELECT
        store_id,
        transaction_happened_at,
        ROW_NUMBER() OVER (PARTITION BY store_id ORDER BY transaction_happened_at) AS rownumber
    FROM "merveyasa"."dbt_merve"."fact_store_transaction_view"
)
SELECT
    store_id,
    transaction_happened_at
FROM numbered_transactions
WHERE rownumber <= 5

  );
  
  
[0m18:24:24.236039 [debug] [Thread-1 (]: SQL status: SELECT 423 in 0.0 seconds
[0m18:24:24.239925 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_store_transaction_first"
[0m18:24:24.240423 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.fact_store_transaction_first"} */
alter table "merveyasa"."dbt_merve"."fact_store_transaction_first" rename to "fact_store_transaction_first__dbt_backup"
[0m18:24:24.241323 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:24:24.245375 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_store_transaction_first"
[0m18:24:24.245929 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.fact_store_transaction_first"} */
alter table "merveyasa"."dbt_merve"."fact_store_transaction_first__dbt_tmp" rename to "fact_store_transaction_first"
[0m18:24:24.246919 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:24:24.251325 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_first: COMMIT
[0m18:24:24.252167 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_store_transaction_first"
[0m18:24:24.253055 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_first: COMMIT
[0m18:24:24.255393 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:24:24.261390 [debug] [Thread-1 (]: Using postgres connection "model.sumup.fact_store_transaction_first"
[0m18:24:24.262350 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_first: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.fact_store_transaction_first"} */
drop table if exists "merveyasa"."dbt_merve"."fact_store_transaction_first__dbt_backup" cascade
[0m18:24:24.265861 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:24:24.269017 [debug] [Thread-1 (]: Timing info for model.sumup.fact_store_transaction_first (execute): 18:24:24.198702 => 18:24:24.268604
[0m18:24:24.269857 [debug] [Thread-1 (]: On model.sumup.fact_store_transaction_first: Close
[0m18:24:24.271297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff30848f-c886-4857-adba-5f9dbe6be933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115680110>]}
[0m18:24:24.272243 [info ] [Thread-1 (]: 8 of 11 OK created sql incremental model dbt_merve.fact_store_transaction_first  [[32mSELECT 423[0m in 0.08s]
[0m18:24:24.273120 [debug] [Thread-1 (]: Finished running node model.sumup.fact_store_transaction_first
[0m18:24:24.273848 [debug] [Thread-1 (]: Began running node model.sumup.pct_transaction
[0m18:24:24.275580 [info ] [Thread-1 (]: 9 of 11 START sql incremental model dbt_merve.pct_transaction .................. [RUN]
[0m18:24:24.277180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.fact_store_transaction_first, now model.sumup.pct_transaction)
[0m18:24:24.278230 [debug] [Thread-1 (]: Began compiling node model.sumup.pct_transaction
[0m18:24:24.287056 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.pct_transaction"
[0m18:24:24.288662 [debug] [Thread-1 (]: Timing info for model.sumup.pct_transaction (compile): 18:24:24.279230 => 18:24:24.288208
[0m18:24:24.289493 [debug] [Thread-1 (]: Began executing node model.sumup.pct_transaction
[0m18:24:24.297868 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.pct_transaction"
[0m18:24:24.299525 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m18:24:24.300406 [debug] [Thread-1 (]: On model.sumup.pct_transaction: BEGIN
[0m18:24:24.300939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:24.312890 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:24:24.313939 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m18:24:24.315071 [debug] [Thread-1 (]: On model.sumup.pct_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.pct_transaction"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."pct_transaction__dbt_tmp"
  
  
    as
  
  (
    


WITH pct_transaction AS 
(
    SELECT device_type, COUNT(*) * 100.0 / SUM(COUNT(*)) OVER () AS percentage
    FROM "merveyasa"."dbt_merve"."fact_store_transaction_view"
    GROUP BY device_type
)
SELECT * FROM pct_transaction
ORDER BY device_type

  );
  
  
[0m18:24:24.326788 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.0 seconds
[0m18:24:24.331918 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m18:24:24.332557 [debug] [Thread-1 (]: On model.sumup.pct_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.pct_transaction"} */
alter table "merveyasa"."dbt_merve"."pct_transaction" rename to "pct_transaction__dbt_backup"
[0m18:24:24.333427 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:24:24.337594 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m18:24:24.338123 [debug] [Thread-1 (]: On model.sumup.pct_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.pct_transaction"} */
alter table "merveyasa"."dbt_merve"."pct_transaction__dbt_tmp" rename to "pct_transaction"
[0m18:24:24.339167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:24:24.342063 [debug] [Thread-1 (]: On model.sumup.pct_transaction: COMMIT
[0m18:24:24.342584 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m18:24:24.343031 [debug] [Thread-1 (]: On model.sumup.pct_transaction: COMMIT
[0m18:24:24.344181 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:24:24.351667 [debug] [Thread-1 (]: Using postgres connection "model.sumup.pct_transaction"
[0m18:24:24.352535 [debug] [Thread-1 (]: On model.sumup.pct_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.pct_transaction"} */
drop table if exists "merveyasa"."dbt_merve"."pct_transaction__dbt_backup" cascade
[0m18:24:24.356905 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:24:24.359956 [debug] [Thread-1 (]: Timing info for model.sumup.pct_transaction (execute): 18:24:24.289953 => 18:24:24.359563
[0m18:24:24.360712 [debug] [Thread-1 (]: On model.sumup.pct_transaction: Close
[0m18:24:24.362188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff30848f-c886-4857-adba-5f9dbe6be933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115660850>]}
[0m18:24:24.363385 [info ] [Thread-1 (]: 9 of 11 OK created sql incremental model dbt_merve.pct_transaction ............. [[32mSELECT 5[0m in 0.09s]
[0m18:24:24.364462 [debug] [Thread-1 (]: Finished running node model.sumup.pct_transaction
[0m18:24:24.365223 [debug] [Thread-1 (]: Began running node model.sumup.top_ten_stores
[0m18:24:24.366830 [info ] [Thread-1 (]: 10 of 11 START sql table model dbt_merve.top_ten_stores ........................ [RUN]
[0m18:24:24.368448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.pct_transaction, now model.sumup.top_ten_stores)
[0m18:24:24.369442 [debug] [Thread-1 (]: Began compiling node model.sumup.top_ten_stores
[0m18:24:24.374630 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.top_ten_stores"
[0m18:24:24.376466 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_stores (compile): 18:24:24.370014 => 18:24:24.376005
[0m18:24:24.377279 [debug] [Thread-1 (]: Began executing node model.sumup.top_ten_stores
[0m18:24:24.386740 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.top_ten_stores"
[0m18:24:24.387908 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m18:24:24.388419 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: BEGIN
[0m18:24:24.388939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:24.396691 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:24:24.397286 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m18:24:24.398122 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */

  
    

  create  table "merveyasa"."dbt_merve"."top_ten_stores__dbt_tmp"
  
  
    as
  
  (
    

WITH top_ten_stores AS 
(
    SELECT store_id, SUM(transaction_amount) AS total_transaction_amount
    FROM "merveyasa"."dbt_merve"."fact_store_transaction_view"
    GROUP BY store_id
    ORDER BY total_transaction_amount DESC
    LIMIT 10
)
SELECT * FROM top_ten_stores
  );
  
[0m18:24:24.404658 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m18:24:24.411157 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m18:24:24.411983 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */
alter table "merveyasa"."dbt_merve"."top_ten_stores" rename to "top_ten_stores__dbt_backup"
[0m18:24:24.413603 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:24:24.419856 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m18:24:24.420714 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */
alter table "merveyasa"."dbt_merve"."top_ten_stores__dbt_tmp" rename to "top_ten_stores"
[0m18:24:24.422496 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:24:24.426964 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: COMMIT
[0m18:24:24.427794 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m18:24:24.428554 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: COMMIT
[0m18:24:24.430565 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:24:24.434391 [debug] [Thread-1 (]: Using postgres connection "model.sumup.top_ten_stores"
[0m18:24:24.434901 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.top_ten_stores"} */
drop table if exists "merveyasa"."dbt_merve"."top_ten_stores__dbt_backup" cascade
[0m18:24:24.438224 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:24:24.440065 [debug] [Thread-1 (]: Timing info for model.sumup.top_ten_stores (execute): 18:24:24.377829 => 18:24:24.439813
[0m18:24:24.440541 [debug] [Thread-1 (]: On model.sumup.top_ten_stores: Close
[0m18:24:24.441475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff30848f-c886-4857-adba-5f9dbe6be933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11563cd10>]}
[0m18:24:24.442194 [info ] [Thread-1 (]: 10 of 11 OK created sql table model dbt_merve.top_ten_stores ................... [[32mSELECT 10[0m in 0.07s]
[0m18:24:24.443100 [debug] [Thread-1 (]: Finished running node model.sumup.top_ten_stores
[0m18:24:24.443657 [debug] [Thread-1 (]: Began running node model.sumup.inc_first_five_transaction
[0m18:24:24.444787 [info ] [Thread-1 (]: 11 of 11 START sql incremental model dbt_merve.inc_first_five_transaction ...... [RUN]
[0m18:24:24.446112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sumup.top_ten_stores, now model.sumup.inc_first_five_transaction)
[0m18:24:24.446690 [debug] [Thread-1 (]: Began compiling node model.sumup.inc_first_five_transaction
[0m18:24:24.454064 [debug] [Thread-1 (]: Writing injected SQL for node "model.sumup.inc_first_five_transaction"
[0m18:24:24.455718 [debug] [Thread-1 (]: Timing info for model.sumup.inc_first_five_transaction (compile): 18:24:24.447082 => 18:24:24.455253
[0m18:24:24.456506 [debug] [Thread-1 (]: Began executing node model.sumup.inc_first_five_transaction
[0m18:24:24.469013 [debug] [Thread-1 (]: Writing runtime sql for node "model.sumup.inc_first_five_transaction"
[0m18:24:24.470537 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m18:24:24.471330 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: BEGIN
[0m18:24:24.472088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:24.481555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:24:24.482289 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m18:24:24.482824 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.inc_first_five_transaction"} */

      
  
    

  create  table "merveyasa"."dbt_merve"."inc_first_five_transaction__dbt_tmp"
  
  
    as
  
  (
    


SELECT
    store_id,
    AVG(time_diff) AS avg_time_diff
FROM (
    SELECT
        store_id,
        transaction_happened_at - LAG(transaction_happened_at, 1) OVER (PARTITION BY store_id ORDER BY transaction_happened_at) AS time_diff
    FROM "merveyasa"."dbt_merve"."fact_store_transaction_first"
) aa
GROUP BY store_id

  );
  
  
[0m18:24:24.493055 [debug] [Thread-1 (]: SQL status: SELECT 87 in 0.0 seconds
[0m18:24:24.498207 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m18:24:24.499064 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.inc_first_five_transaction"} */
alter table "merveyasa"."dbt_merve"."inc_first_five_transaction" rename to "inc_first_five_transaction__dbt_backup"
[0m18:24:24.500503 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:24:24.506838 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m18:24:24.507817 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.inc_first_five_transaction"} */
alter table "merveyasa"."dbt_merve"."inc_first_five_transaction__dbt_tmp" rename to "inc_first_five_transaction"
[0m18:24:24.509306 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:24:24.514235 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: COMMIT
[0m18:24:24.515076 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m18:24:24.515882 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: COMMIT
[0m18:24:24.517185 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:24:24.523193 [debug] [Thread-1 (]: Using postgres connection "model.sumup.inc_first_five_transaction"
[0m18:24:24.524082 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "merve", "target_name": "dev", "node_id": "model.sumup.inc_first_five_transaction"} */
drop table if exists "merveyasa"."dbt_merve"."inc_first_five_transaction__dbt_backup" cascade
[0m18:24:24.527641 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:24:24.529587 [debug] [Thread-1 (]: Timing info for model.sumup.inc_first_five_transaction (execute): 18:24:24.457352 => 18:24:24.529320
[0m18:24:24.530113 [debug] [Thread-1 (]: On model.sumup.inc_first_five_transaction: Close
[0m18:24:24.531769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff30848f-c886-4857-adba-5f9dbe6be933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156b3d50>]}
[0m18:24:24.532949 [info ] [Thread-1 (]: 11 of 11 OK created sql incremental model dbt_merve.inc_first_five_transaction . [[32mSELECT 87[0m in 0.09s]
[0m18:24:24.534370 [debug] [Thread-1 (]: Finished running node model.sumup.inc_first_five_transaction
[0m18:24:24.538708 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:24.539286 [debug] [MainThread]: On master: BEGIN
[0m18:24:24.539777 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:24:24.553532 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:24:24.554327 [debug] [MainThread]: On master: COMMIT
[0m18:24:24.555013 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:24.555663 [debug] [MainThread]: On master: COMMIT
[0m18:24:24.556632 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:24:24.557344 [debug] [MainThread]: On master: Close
[0m18:24:24.558893 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:24:24.559653 [debug] [MainThread]: Connection 'model.sumup.inc_first_five_transaction' was properly closed.
[0m18:24:24.560537 [info ] [MainThread]: 
[0m18:24:24.561313 [info ] [MainThread]: Finished running 9 incremental models, 2 table models in 0 hours 0 minutes and 1.55 seconds (1.55s).
[0m18:24:24.566977 [debug] [MainThread]: Command end result
[0m18:24:24.593665 [info ] [MainThread]: 
[0m18:24:24.594764 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:24:24.595495 [info ] [MainThread]: 
[0m18:24:24.596960 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m18:24:24.598592 [debug] [MainThread]: Command `dbt run` succeeded at 18:24:24.598298 after 3.35 seconds
[0m18:24:24.599485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114579350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a85d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a87110>]}
[0m18:24:24.600104 [debug] [MainThread]: Flushing usage events
